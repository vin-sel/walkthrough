"use strict";(self.webpackChunkmp_webgl=self.webpackChunkmp_webgl||[]).push([[266],{4679:(e,t,i)=>{i.d(t,{e:()=>l});var s=i(68909),r=i(90303),a=i(98051),n=i(40397),o=i(40160);class h extends s.Mesh{constructor(e,t,i=o.UP.endpointSelected,s=o.UP.endpointDefault){super(e,t),this.selectedSize=i,this.defaultSize=s,this.currentSize=o.UP.endpointDefault,this.currentSize=this.defaultSize,this.scale.set(o.Mg,o.Mg,o.Mg)}dispose(){this.material.dispose(),this.geometry.dispose()}billboardScale(e,t,i){const s=(0,n.Nv)(t,e,this.position,i,.5),r=Math.max(Math.min(1/s*this.currentSize,o.q6),o.Mg);this.scale.set(r,r,r)}updateSelected(e){this.currentSize=e?this.selectedSize:this.defaultSize}}var d=i(37458),c=i(52943),u=i(30443);class l{constructor(e,t,i,o,l){this.lineMaterial=i,this.options=o,this.endpointMaterial=l,this.startPosition=new s.Vector3,this.endPosition=new s.Vector3,this.endpoints=!1,this.isVisible=!0,this.meshToLinePartMap={},this.opacity=e=>(this.endpointMaterial&&this.endpointMaterial.setOpacity(e),this.lineMesh.material.setOpacity(e),this),this.updatePositions=(e,t)=>(this.startPosition.copy(e),this.endPosition.copy(t),this.options.beforeUpdatePositions&&(e=this.options.beforeUpdatePositions(e),t=this.options.beforeUpdatePositions(t)),this.lineMesh.geometry.setPositions([e.x,e.y,e.z,t.x,t.y,t.z]),this.endpoints&&(this.endMesh.position.copy(t),this.startMesh.position.copy(e),this.lastBillboardOptions&&this.updateBillboard(this.lastBillboardOptions)),this.lineMesh.material.dashed&&this.lineMesh.computeLineDistances(),this),this.updateBillboard=e=>{if(this.endpoints&&(e.rotation&&(this.endMesh.quaternion.copy(e.rotation),this.startMesh.quaternion.copy(e.rotation)),e.position&&e.projection&&!(0,n.Rc)(e.projection))){const t=this.lineMesh.material.resolution.y;this.endMesh.billboardScale(e.position,e.projection,t),this.startMesh.billboardScale(e.position,e.projection,t)}return this.lastBillboardOptions=e,this},this.updateSelected=e=>(this.lineMesh.material.updateSelected(e),this.endpoints&&(this.endMesh.material.updateHovered(e),this.endMesh.updateSelected(e),this.startMesh.updateSelected(e)),this),this.setRenderLayer=e=>{this.children.forEach((t=>t.layers.mask=e.mask))},this.setRenderOrder=e=>{this.children.forEach((t=>t.renderOrder=e))},this.updateResolution=(e,t)=>(this.lineMesh.material.resolution.set(e,t),this),this.hide=()=>{this.options.onHide&&this.options.onHide(),this.isVisible=!1},this.show=()=>{this.options.onShow&&this.options.onShow(),this.isVisible=!0},this.toggle=e=>(e?this.show():this.hide(),this),this.dispose=()=>{this.options.onHide&&this.options.onHide(),this.lineMesh.geometry.dispose(),this.lineMesh.material.dispose(),this.endMesh&&this.endMesh.dispose(),this.startMesh&&this.startMesh.dispose(),this.meshToLinePartMap={}},this.overrideLineMaterial=e=>{this.lineMesh.material=e},this.restoreLineMaterial=()=>{this.lineMesh.material=this.lineMaterial},this.startPosition.copy(e),this.endPosition.copy(t),this.lineMesh=new r.N(new a.v,i),this.lineMesh.matrixAutoUpdate=!1,this.lineMesh.part=c.Y.line,this.lineMesh.renderOrder=d.X.lines,this.meshToLinePartMap[c.Y.line]=this.lineMesh,l&&(this.endpoints=!0,this.endMesh=new h((0,u.Wi)(),l),this.endMesh.part=c.Y.end,this.endMesh.renderOrder=d.X.endpoints,this.meshToLinePartMap[c.Y.end]=this.endMesh,this.startMesh=new h((0,u.Wi)(),l),this.startMesh.part=c.Y.start,this.startMesh.renderOrder=d.X.endpoints,this.meshToLinePartMap[c.Y.start]=this.startMesh),this.updatePositions(this.startPosition,this.endPosition),this.updateSelected(!1)}get currentOpacity(){return this.lineMesh.material.getOpacity()}getMesh(e){return this.meshToLinePartMap[e]}get children(){return Object.keys(this.meshToLinePartMap).map((e=>this.meshToLinePartMap[e]))}get visible(){return this.isVisible}}},52943:(e,t,i)=>{var s;i.d(t,{Y:()=>s}),function(e){e.line="line",e.start="start",e.end="end"}(s||(s={}))},40266:(e,t,i)=>{i.r(t),i.d(t,{default:()=>v,makeEndpointMaterial:()=>M,makeLineMaterial:()=>w});var s=i(75578),r=i(71687),a=i(68909),n=i(4679),o=i(32024);var h;!function(e){e[e.LINE_DEFAULT=0]="LINE_DEFAULT",e[e.LINE_HOVER=1]="LINE_HOVER",e[e.END_DEFAULT=2]="END_DEFAULT",e[e.END_HOVER=3]="END_HOVER"}(h||(h={}));class d{constructor(){const e=(0,o.y)("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAJ1BMVEUAAAD///////////////////////////////////////////////+uPUo5AAAADHRSTlMA4ZNBI+fLwLSGYE5aqgIgAAAAlUlEQVQoz2MAAy91mYNFSxjgwEjmDBAcVIbxPWPOgMHRKRA+c88ZKDhhABbYdgYOssEKchACx0BKPM4ggRagwBxkgZNAHTHIAkcNGJjOoAAFBkdUARGGNagCpxh0UAUOMdSgChxnkEEVOMhwBg1gCGBowTAUw1oMh2E4HcNzGN5HDyCMIMQIZPRowIgozKjEjGyM5AAACSg5ooJJElsAAAAASUVORK5CYII="),t=(0,o.y)("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAPFBMVEUAAAD/AVL/AVL/AVL/AVL/AVL/AVL/AVL/AVL/AVL/AVL/AVL/////+fr/5er/0tv/ytX/iaH/dJL/cpA84uD/AAAAC3RSTlMA45NBI8vAtIZgTrS8MGcAAAC5SURBVDjLhVPtDoQgDBuICPKpvP+7Xs4t6LlL2j9GWtYCG91w0XqTkvE2OtJYrEkTxi4v2gWhpyS4n+1bUtgeRfY1/cG6z/3Ma8Ui/rP+6LWU2sd04RxBfs+WBe2UpXAZSP4jP3DIWb4m9ua1whI5w/XzC+xiHEWWtreg8XoUh5EVhnj469u1oF+EJ45QtaByCGKrogWFGSiAFjAkPCa8KHjV6LHgc6OGgS2Hmha2PR4cPHp4eOH4fwAGdiPh+RS0GAAAAABJRU5ErkJggg=="),i=(0,o.y)("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAIBAMAAABqq+CcAAAAD1BMVEUAAAD///////////////+PQt5oAAAABHRSTlMAy4AzqjrmZgAAABRJREFUCNdjAAMjERcXR2Uwc4AEAIn2CZHn9cAcAAAAAElFTkSuQmCC"),s=(0,o.y)("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAIBAMAAABqq+CcAAAAGFBMVEUAAAD/AVL/AVL/AVL/////AVL/r7//OWiicYg+AAAABHRSTlMAy4AzqjrmZgAAABlJREFUCNdjYGBgVgwtcwGC9FAhAyB3YAQAVg4X6a0jaXAAAAAASUVORK5CYII=");this.textures={[h.LINE_DEFAULT]:i,[h.LINE_HOVER]:s,[h.END_DEFAULT]:e,[h.END_HOVER]:t},i.minFilter=a.LinearFilter,s.minFilter=a.LinearFilter,e.minFilter=a.LinearFilter,t.minFilter=a.LinearFilter}get(e){return this.textures[e]}dispose(){for(const e in this.textures){const t=Number(e);this.get(t).dispose()}}}var c=i(36580);class u extends a.ShaderMaterial{constructor(e,t,i){const s=a.UniformsUtils.clone(c.i.endpoint.uniforms);super({fragmentShader:c.i.endpoint.fragmentShader,vertexShader:c.i.endpoint.vertexShader,uniforms:s,name:"LineEndpointMaterial",transparent:!0,depthWrite:!1,depthTest:!0}),this.color=e,this.defaultTex=t,this.hoverTex=i,this.uniforms.bg.value=t,this.uniforms.color.value.copy(this.color)}clone(){return new u(this.color,this.defaultTex,this.hoverTex).copy(this)}setOpacity(e){this.uniforms&&e!==this.uniforms.opacity.value&&(this.uniforms.opacity.value=e)}getOpacity(){return this.uniforms.opacity.value}updateHovered(e){const t=e?this.hoverTex:this.defaultTex;this.uniforms.bg.value!==t&&(this.uniforms.bg.value=t)}}var l=i(98034),p=i(20599),m=i(35568),A=i(37105),f=i(40160);let g=null;function S(){return g||(g=new d),g}class v extends s.n{constructor(){super(...arguments),this.name="lines"}async init(e,t){const i=await t.getModuleBySymbol(r.M7);this.scene=i.getScene(),this.canvas=await t.market.waitForData(A.p),this.cameraData=await t.market.waitForData(p.M),this.bindings.push(this.canvas.onChanged(this.onCanvasChange.bind(this))),this.cameraPosition=new a.Vector3,this.segments=[]}onUpdate(){this.cameraPosition.copy(this.cameraData.pose.position)}dispose(e){super.dispose(e),this.segments.forEach((e=>e.dispose()))}makeLine(e,t,i,s,r=()=>!1){const a=r()?f.HT.OFFSET_TOWARDS_CAMERA:0,o=r()?e=>this.cameraPosition.clone().sub(e).setLength(a).add(e):e=>e,h=new n.e(e,t,i,{beforeUpdatePositions:o,onShow:()=>h.children.forEach((e=>this.scene.addChild(m.o.Root,e))),onHide:()=>h.children.forEach((e=>this.scene.removeChild(m.o.Root,e)))},s);return h.updateResolution(this.canvas.width,this.canvas.height),h.opacity(1),h.show(),h.updatePositions(e,t),this.segments.push(h),h}makeLineMaterial(e,t,i={},s,r){return w(e,t,i,s,r)}makeEndpointMaterial(e,t,i){return M(e,t,i)}onCanvasChange(e){for(const t of this.segments)t.updateResolution(e.width,e.height)}}function M(e,t,i){const s=i||S().get(h.END_HOVER),r=t||S().get(h.END_DEFAULT);return new u(new a.Color(e),r,s)}function w(e,t,i={},s,r){const n=r||S().get(h.LINE_HOVER),o=s||S().get(h.LINE_DEFAULT),d=new a.Vector2(window.innerWidth,window.innerHeight);return t?new l.G(Object.assign({color:new a.Color(e),resolution:d},i),n,o):new l.G(Object.assign({color:new a.Color(e)},i))}},90303:(e,t,i)=>{i.d(t,{N:()=>a});var s=i(68909),r=i(52943);class a extends s.Mesh{constructor(e,t){super(),this.part=r.Y.line,this.computeLineDistances=(()=>{const e=new s.Vector3,t=new s.Vector3;return()=>{const i=this.geometry,r=i.attributes.instanceStart,a=i.attributes.instanceEnd,n=new Float32Array(2*r.data.count);for(let i=0,s=0,o=r.data.count;i<o;i++,s+=2)e.fromBufferAttribute(r,i),t.fromBufferAttribute(a,i),n[s]=0===s?0:n[s-1],n[s+1]=n[s]+e.distanceTo(t);return this.instanceDistanceBuffer?(this.instanceDistanceBuffer.set(n,0),this.instanceDistanceBuffer.needsUpdate=!0):(this.instanceDistanceBuffer=new s.InstancedInterleavedBuffer(n,2,1),i.setAttribute("instanceDistanceStart",new s.InterleavedBufferAttribute(this.instanceDistanceBuffer,1,0,!1)),i.setAttribute("instanceDistanceEnd",new s.InterleavedBufferAttribute(this.instanceDistanceBuffer,1,1,!1))),this}})(),this.geometry=e,this.material=t,this.type="Line"}copy(e){throw Error("not implemented")}}},98051:(e,t,i)=>{i.d(t,{v:()=>r});var s=i(84325);class r extends s.n{constructor(){super(),this.type="LineGeometry",this.isLineGeometry=!0}setPositions(e){const t=e.length-3,i=new Float32Array(2*t);for(let s=0;s<t;s+=3)i[2*s]=e[s],i[2*s+1]=e[s+1],i[2*s+2]=e[s+2],i[2*s+3]=e[s+3],i[2*s+4]=e[s+4],i[2*s+5]=e[s+5];return s.n.prototype.setPositions.call(this,i),this}setColors(e){const t=e.length-3,i=new Float32Array(2*t);for(let s=0;s<t;s+=3)i[2*s]=e[s],i[2*s+1]=e[s+1],i[2*s+2]=e[s+2],i[2*s+3]=e[s+3],i[2*s+4]=e[s+4],i[2*s+5]=e[s+5];return s.n.prototype.setColors.call(this,i),this}fromLine(e){throw new Error("LineGeometry.fromLine not converted to TS yet")}copy(e){return this}}},98034:(e,t,i)=>{i.d(t,{G:()=>n});var s=i(68909),r=i(36580),a=i(40160);class n extends s.ShaderMaterial{constructor(e,t,i,n=a.UP.lineSelected){super(),this.parameters=e,this.hoverTexture=t,this.defaultTexture=i,this.selectedWidth=n,this.isLineMaterial=!0,this.defaultWidth=a.UP.lineDefault,this.setValues({uniforms:s.UniformsUtils.clone(r.i.line.uniforms),vertexShader:r.i.line.vertexShader,fragmentShader:r.i.line.fragmentShader,transparent:!0,depthWrite:!1,depthTest:!0,opacity:1}),this.setValues(e),i&&(this.mask=i),this.defaultWidth=e&&e.linewidth?e.linewidth:a.UP.lineDefault}updateSelected(e){const t=e?this.hoverTexture:this.defaultTexture;t&&this.mask!==t&&(this.mask=t,e?this.setLinewidth(this.selectedWidth):this.setLinewidth(this.defaultWidth))}setLinewidth(e){this.uniforms.linewidth||(this.uniforms=s.UniformsUtils.clone(r.i.line.uniforms)),this.getLinewidth()!==e&&(this.uniforms.linewidth.value=e)}getLinewidth(){return this.uniforms.linewidth.value}get color(){return this.uniforms.diffuse.value}set color(e){this.uniforms.diffuse.value=e}getOpacity(){return this.uniforms.opacity.value}setOpacity(e){this.uniforms||(this.uniforms=s.UniformsUtils.clone(r.i.line.uniforms)),this.getOpacity()!==e&&(this.uniforms.opacity.value=e)}get dashScale(){return this.uniforms.dashScale.value}set dashScale(e){this.uniforms.dashScale.value=e}set dashed(e){e?this.defines.USE_DASH="":delete this.defines.USE_DASH,this.needsUpdate=!0}get dashed(){return"USE_DASH"in this.defines}get dashSize(){return this.uniforms.dashSize.value}set dashSize(e){this.uniforms.dashSize.value=e}get gapSize(){return this.uniforms.gapSize.value}set gapSize(e){this.uniforms.gapSize.value=e}get resolution(){return this.uniforms.resolution.value}set resolution(e){this.uniforms.resolution.value=e}set mask(e){this.uniforms.mask.value!==e&&(e?this.defines.USE_MASK="":delete this.defines.USE_MASK,this.uniforms.mask.value=e,this.needsUpdate=!0)}get mask(){return this.uniforms.mask.value}copy(e){return s.ShaderMaterial.prototype.copy.call(this,e),this.parameters=e.parameters,this.color.copy(e.color),this.defaultWidth=e.defaultWidth,this.setLinewidth(e.getLinewidth()),this.resolution.copy(e.resolution),this.defaultTexture=e.defaultTexture,this.hoverTexture=e.hoverTexture,this.mask=e.mask,this.setOpacity(e.getOpacity()),this.dashed=e.dashed,this.dashScale=e.dashScale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}},84325:(e,t,i)=>{i.d(t,{n:()=>r});var s=i(68909);class r extends s.InstancedBufferGeometry{constructor(){super(),this.type="LineSegmentsGeometry";this.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),this.setAttribute("position",new s.Float32BufferAttribute([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),this.setAttribute("uv",new s.Float32BufferAttribute([0,1,.5,1,0,.5,.5,.5,0,0,.5,0,0,1,.5,1],2))}applyMatrix(e){const t=this.attributes.instanceStart,i=this.attributes.instanceEnd;return void 0!==t&&void 0!==i&&(t.applyMatrix4(e),i.applyMatrix4(e),this.positionBuffer.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}setPositions(e){let t;return e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e)),t&&(this.positionBuffer?(this.positionBuffer.set(t,0),this.positionBuffer.needsUpdate=!0):(this.positionBuffer=new s.InstancedInterleavedBuffer(t,6,1),this.setAttribute("instanceStart",new s.InterleavedBufferAttribute(this.positionBuffer,3,0,!1)),this.setAttribute("instanceEnd",new s.InterleavedBufferAttribute(this.positionBuffer,3,3,!1))),this.computeBoundingBox(),this.computeBoundingSphere()),this}setColors(e){let t;return e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e)),t&&(this.colorBuffer?(this.colorBuffer.set(t,0),this.colorBuffer.needsUpdate=!0):(this.colorBuffer=new s.InstancedInterleavedBuffer(t,6,1),this.setAttribute("instanceColorStart",new s.InterleavedBufferAttribute(this.colorBuffer,3,0,!1)),this.setAttribute("instanceColorEnd",new s.InterleavedBufferAttribute(this.colorBuffer,3,3,!1)))),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new s.WireframeGeometry(e.geometry)),this}fromLineSegements(e){const t=e.geometry;return t instanceof s.BufferGeometry&&this.setPositions(t.position.array),this}computeBoundingBox(){this.boundingBox||(this.boundingBox=new s.Box3),this.box||(this.box=new s.Box3);const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;void 0!==e&&void 0!==t&&(this.boundingBox.setFromBufferAttribute(e),this.box.setFromBufferAttribute(t),this.boundingBox.union(this.box))}computeBoundingSphere(){this.tempVector||(this.tempVector=new s.Vector3),this.boundingSphere||(this.boundingSphere=new s.Sphere),this.boundingBox||this.computeBoundingBox();const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(void 0!==e&&void 0!==t){const i=this.boundingSphere.center;this.boundingBox.getCenter(i);let s=0;for(let r=0,a=e.count;r<a;r++)this.tempVector.fromBufferAttribute(e,r),s=Math.max(s,i.distanceToSquared(this.tempVector)),this.tempVector.fromBufferAttribute(t,r),s=Math.max(s,i.distanceToSquared(this.tempVector));this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error("computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}}},35568:(e,t,i)=>{i.d(t,{o:()=>o,A:()=>c});var s=i(68909),r=i(12767),a=i(36476);class n extends s.Object3D{constructor(e){super(),this.anchor=this,this.reset=()=>{this.camera.position.set(0,0,0),this.camera.layers.mask=a.H.ALL.mask,this.camera.updateMatrixWorld(!0)},this.update=e=>{this.anchor.position.copy(e.position),this.camera.quaternion.copy(e.rotation),this.camera.projectionMatrix.copy(e.projection.asThreeMatrix4()),this.camera.projectionMatrixInverse.copy(e.projection.asThreeMatrix4()),this.camera.projectionMatrixInverse.invert(),this.updateMatrixWorld(!0)},this.camera=new s.PerspectiveCamera(r.Bv.fov,e,r.Bv.near,r.Bv.far),this.add(this.camera),this.name="CameraRig",this.reset()}dispose(){this.remove(this.camera)}}var o,h=i(68986),d=i(54387);!function(e){e[e.Root=0]="Root",e[e.CameraRig=1]="CameraRig"}(o||(o={}));class c{get lastRenderCallTime(){return this._lastRenderCallTime}constructor(e,t,i,r,a){this.scene=e,this.threeRenderer=t,this.cameraData=i,this.useEffectComposer=r,this.viewportManager=a,this.ids=o,this.frameCount=0,this.rendering=!1,this.composer=null,this.cameraRigStale=!0,this.canvasSizeChanged=!0,this.updateComposer=(()=>{const e=new s.Vector2;return()=>{this.canvasSizeChanged&&this.composer&&(this.composer.setPixelRatio(this.composer.renderer.getPixelRatio()),this.composer.renderer.getSize(e),this.composer.setSize(e.x,e.y),this.canvasSizeChanged=!1)}})(),this.renderViewports=(()=>{const e=new s.Vector2;return t=>{this.threeRenderer.clear();const i=this.cameraRig.camera.layers.mask;for(const i of this.viewportManager.viewports)if(i.rect.getSize(e),this.threeRenderer.setViewport(i.rect.min.x,i.rect.min.y,e.x,e.y),this.composer){const e=this.composer.passes[0];e.scene=i.scene,e.camera=i.camera,this.composer.render(t)}else this.threeRenderer.render(i.scene,i.camera);this.cameraRig.camera.layers.mask=i}})(),this.cameraRig=new n(i.aspect()),a.setDomElement(t.domElement),this.viewportManager.defaultViewport.scene=this.scene,this.viewportManager.defaultViewport.camera=this.cameraRig.camera,t.info.autoReset=!1}add(...e){for(const t of e)this.addChild(o.Root,t)}remove(...e){for(const t of e)this.removeChild(o.Root,t)}addChild(e,t){switch(e){case o.Root:this.scene.add(t);break;case o.CameraRig:this.cameraRig.add(t);break;default:return!1}return!0}removeChild(e,t){switch(e){case o.Root:this.scene.remove(t);break;case o.CameraRig:this.cameraRig.remove(t);break;default:return!1}return!0}getSubTree(e){return(0,d.W9)(this.scene,e)}get camera(){return this.updateCameraRig(),this.cameraRig.camera}get effectComposer(){return this.composer}init(){this.useEffectComposer&&Promise.all([i.e(1662).then(i.bind(i,42562)),i.e(1662).then(i.bind(i,65804))]).then((([e,t])=>{const i=this.threeRenderer.getSize(new s.Vector2),r=new s.WebGLRenderTarget(i.x,i.y,{stencilBuffer:!0});this.composer=new e.EffectComposer(this.threeRenderer,r),this.composer.addPass(new t.RenderPass(this.scene,this.cameraRig.camera)),this.cameraRigStale=!0})),this.cameraRigStale=!0}dispose(){this.cameraRig.dispose()}startRender(e){this.rendering=e}activate(e){this.scene.add(this.cameraRig),this.cameraDataCallback=()=>this.cameraRigStale=!0,this.cameraData.pose.onChanged(this.cameraDataCallback),this.canvasSizeSub=new h.P(this.cameraData.onPropertyChanged("_width",(()=>this.onCanvasSizeChanged())),this.cameraData.onPropertyChanged("_height",(()=>this.onCanvasSizeChanged())))}deactivate(e){var t;this.scene.remove(this.cameraRig),this.cameraData.pose.removeOnChanged(this.cameraDataCallback),null===(t=this.canvasSizeSub)||void 0===t||t.cancel()}beforeRender(){this.updateCameraRig(),this.updateComposer()}setCameraDirty(){this.cameraRigStale=!0,this.cameraRig.camera.updateProjectionMatrix()}onCanvasSizeChanged(){this.viewportManager.updateDefaultViewport(),this.canvasSizeChanged=!0}updateCameraRig(){this.cameraRigStale&&(this.cameraRig.update(this.cameraData.pose),this.cameraRigStale=!1)}render(e){this.rendering&&(this.threeRenderer.info.reset(),this.renderViewports(e),this.frameCount++),this._lastRenderCallTime=Date.now()}}}}]);