"use strict";(self.webpackChunkmp_webgl=self.webpackChunkmp_webgl||[]).push([[8893],{55141:(e,t,s)=>{s.d(t,{u:()=>i});class i{get id(){return this.constructor.id}}},79849:(e,t,s)=>{s.d(t,{w:()=>a});var i=s(24241),n=s(31093),r=s(3066);const o=new i.Vy("command-binder");class a{constructor(e=!1){this.ignoreUnboundCommands=e,this.bindings={},this.queuedCommands={},this.hookedCommands={},this.resetHooks=()=>{this.hookedCommands={}},this.issueCommand=this.issueCommand.bind(this),this.issueCommandWhenBound=this.issueCommandWhenBound.bind(this)}addBinding(e,t){if(this.bindings[e.id])throw Error(`Command ${e.id} already bound to a callback`);if(!e.id)throw Error(`Command ${e.name} does not have an id. Add one as a static member.`);this.bindings[e.id]=t,this.callQueuedCommands(e.id);return{renew:()=>{this.bindings[e.id]!==t&&this.addBinding(e,t)},cancel:()=>this.removeBinding(e,t),active:this.bindings[e.id]===t}}removeBinding(e,t){if(!this.bindings[e.id])return void o.debug("Trying to unbind unbound command");this.bindings[e.id]===t?delete this.bindings[e.id]:o.debug("Trying to unbind unbound callback")}issueCommand(e,t=!0){const s=this.bindings[e.id];return s?this.issueCommandHelper(e,s,t):this.ignoreUnboundCommands?Promise.resolve({}):Promise.reject("Command not bound: "+e.id)}issueCommandHelper(e,t,s=!0){return this.hookedCommands[e.id]&&!this.hookedCommands[e.id].resolving?this.issueHookCommand(e):t(e.payload)}issueCommandWhenBound(e){const t=new n.i;return this.issueCommand(e).then((e=>t.resolve(e))).catch((s=>{this.queuedCommands[e.id]||(this.queuedCommands[e.id]=[]),this.queuedCommands[e.id].push({command:e,deferred:t})})),t.nativePromise()}callQueuedCommands(e){const t=[];this.queuedCommands[e]&&(this.queuedCommands[e].forEach((e=>{t.push(this.issueCommand(e.command).then((t=>e.deferred.resolve(t))))})),Promise.all(t).then((()=>{delete this.queuedCommands[e]})))}hookCommand(e,t,s){let i=this.hookedCommands[e.id];if(i){if(t&&null!==i.preCommandCallback)throw Error(`Command ${e.name} has already been pre hooked`);if(!t&&null!==i.postCommandCallback)throw Error(`Command ${e.name} has already been post hooked`)}else i=this.hookedCommands[e.id]={preCommandCallback:null,postCommandCallback:null,resolving:!1};return(0,r.Sh)((()=>{t?i.preCommandCallback=s:i.postCommandCallback=s}),(()=>{t?i.preCommandCallback=null:i.postCommandCallback=null}),!0)}async issueHookCommand(e){const t=this.hookedCommands[e.id],s=this.bindings[e.id],i=e.payload,n=t.preCommandCallback,r=t.postCommandCallback;try{n&&await n(i),t.resolving=!0;const o=await this.issueCommandHelper(e,s,!0);return t.resolving=!1,r&&await r(i),o}catch(e){throw Error(`Could not completely issueHookCommand - ${e}`)}}}},43787:(e,t,s)=>{s.d(t,{Ks:()=>h,g$:()=>d,oV:()=>a});var i=s(24241),n=s(65945),r=s(924);const o=new i.Vy("di-container"),a=new n.mc;a.bindConstant(r.Od,!0);const c={};function h(e){return o.warn("Prefer getting container directly from engine for better encapsulation."),c[e]}function d(e,t=a){const s=new n.mc(t);return c[e]=s,s.bindConstant(r.Od,!1),s.bindConstant(r.x6,e),s}},924:(e,t,s)=>{s.d(t,{Od:()=>i,W8:()=>o,oj:()=>r,x6:()=>n});const i="__isRoot__",n="__engineId__",r="__workshopLoadedOnce__",o="__showcaseLoadedOnce__"},84710:(e,t,s)=>{s.d(t,{B:()=>n});var i=s(85616);class n extends i.v{}},96068:(e,t,s)=>{s.d(t,{A:()=>E});var i=s(87656);function n(e,t){for(const s in t)if(e===t[s].module)return s.replace("Symbol(","Module(");return"[Unknown module]"}class r{constructor(e,t,s){this.engine=e,this.moduleLookup=t,this.fetchedModules=[],this.messageBus=e.msgBus,this.market=new o(e.market,s),this.commandBinder=e.commandBinder,this.generatorSpreader=e.generatorSpreader,this.uniqueId=e.uniqueId,this.diContainer=e.diContainer,this.getModuleBySymbolSync=e.getModuleBySymbolSync.bind(e),this.tryGetModuleBySymbolSync=e.tryGetModuleBySymbolSync.bind(e),this.addComponent=e.addComponent.bind(e),this.getComponentByType=e.getComponentByType.bind(e),this.getComponents=e.getComponents.bind(e),this.removeComponent=e.removeComponent.bind(e),this.subscribe=e.subscribe.bind(e),this.unsubscribe=e.unsubscribe.bind(e),this.broadcast=e.broadcast.bind(e),this.claimRenderLayer=e.claimRenderLayer.bind(e),this.getRenderLayer=e.getRenderLayer.bind(e),this.disposeRenderLayer=e.disposeRenderLayer.bind(e),this.startGenerator=e.startGenerator.bind(e),this.stopGenerator=e.stopGenerator.bind(e),this.after=e.after.bind(e),this.tick=e.tick.bind(e),this.toggleRendering=e.toggleRendering.bind(e)}getModuleBySymbol(e){const t=Date.now();return this.engine.getModuleBySymbol(e).then((e=>{const s=Date.now();return this.fetchedModules.push({moduleName:n(e,this.moduleLookup),isModule:!0,startAwait:t,finishAwait:s}),e}))}getLoadedDependencies(){return[...this.fetchedModules,...this.market.getLoadedDependencies()]}get msgBus(){return this.messageBus}}class o{constructor(e,t){this.market=e,this.onRegisterData=t,this.fetchedData=[],this._register=e.register.bind(e),this._unregister=e.unregister.bind(e),this.tryGetData=e.tryGetData.bind(e)}register(e,t){this._register(e,t),this.onRegisterData(t.name,Date.now())}unregister(e){this._unregister(e)}waitForData(e){const t=Date.now();return this.market.waitForData(e).then((e=>{const s=Date.now();return this.fetchedData.push({moduleName:e.name,isModule:!1,startAwait:t,finishAwait:s}),e}))}getLoadedDependencies(){return this.fetchedData}}var a=s(24241),c=s(87984);const h="Data not present.";var d=s(31093);class l{constructor(){this.log=new a.Vy("market"),this.typeLookup=new c.b0,this.store={},this.firstUpdatePromises={}}register(e,t){const s=this.typeLookup.getKeyByType(e,!0);if(this.store[s])throw Error("Data can only be registered to one Module");this.store[s]=t,t.commit(),s in this.firstUpdatePromises&&(this.firstUpdatePromises[s].resolve(this.store[s]),delete this.firstUpdatePromises[s])}unregister(e){const t=this.typeLookup.getKeyByType(e,!0);if(!this.store[t])throw Error("No Data was registered to the Module");delete this.store[t]}getData(e){const t=this.typeLookup.getKeyByType(e);if(t in this.store)return this.store[t];throw Error(h)}waitForData(e){const t=this.typeLookup.getKeyByType(e,!0);return t in this.store?Promise.resolve(this.store[t]):(this.firstUpdatePromises[t]||(this.firstUpdatePromises[t]=new d.i,setTimeout((()=>{a.Vy.level>=3&&!(t in this.store)&&this.log.debug(`still waiting for ${e.name}-data after 5 seconds`)}),5e3)),this.firstUpdatePromises[t].nativePromise())}tryGetData(e){try{return this.getData(e)}catch(e){if(e.message!==h)throw this.log.error("tryGetData",e.message),e}return null}}var u=s(39417),p=s(13777),g=s(79849),f=s(244),m=s(48734),b=s(36476),y=s(10843),v=s(27947);class w{constructor(){this.phaseTimes=[],this.modules={},this.onDataRegister=this.onDataRegister.bind(this),this.addAppPhase(v.Jj.UNINITIALIZED),window.profilingData={phaseTimes:this.phaseTimes,modules:this.modules,rows:[]}}addAppPhase(e){e!==v.Jj.PLAYING&&e!==v.Jj.ERROR||(window.profilingData.rows=[...Object.values(this.modules)].sort(((e,t)=>e[4]-t[4]))),this.phaseTimes[e]=Date.now()}addModuleLoadTime(e,t,s,i){const n=[i.map((e=>`${e.moduleName}`))].join(","),r=i.reduce(((e,t)=>e+t.finishAwait-t.startAwait),0),o=Math.min(100,r/(s-t)*100);null==e&&y.Ay.for(this).warnError("Module name is required"),this.modules[e]=[e,e,null,t,s,null,o,n]}onDataRegister(e,t){null==e&&y.Ay.for(this).warnError("Data.name is required"),this.modules[e]=[e,e,null,t,t,null,0,""]}}var C=s(22585),O=s(43787);const k=new a.Vy("engine");let S=f.R.End,I=0;class E{constructor(){this.moduleLookup={},this.componentLookup={},this.currentApplication=null,this.moduleProfiler=new w,this._id=I++,this._container=(0,O.g$)(this._id),this.generatorSpreader=new p.Ay,this.commandBinder=new g.w,this.market=new l,this.messageBus=new u.Q,this.engineGenerators=new m.Ay,this.layers=new b.H,this.symbolLoader=new i.U(this._container),this.afterPhasePromises=[],this.afterPhaseListenerCount=[],this.resetPromises(),k.debug(`Engine ${this._id} created`),this.subscribe(C.uv,(e=>this.moduleProfiler.addAppPhase(e.phase)))}get uniqueId(){return this._id}get diContainer(){return this._container}async loadApplication(e,t,s){if(e===this.currentApplication)throw Error("Application already loaded");const i=(this.currentApplication?this.currentApplication.getManifest():[]).map((e=>e.type)),n=e.getManifest(),r=n.map((e=>e.type)),o=this.currentApplication;this.currentApplication=null;const a=n.filter((e=>-1===i.indexOf(e.type)));for(const e of a)this.symbolLoader.moduleRegistered(e.type)||this.registerModule(e);if(o)try{await this.unload(o,(e=>!r.includes(e)))}catch(e){k.error(e),t&&t(e)}try{this.currentApplication=e,await e.load(this,{coldStart:null===o,autoPlay:s})}catch(e){k.error(e),t&&t(e)}}async unload(e,t){const s=[...e.getManifest().map((e=>e.type)).filter(t||(()=>!0)).map((e=>this.unloadModuleBySymbol(e))),e.unload(this)];s.length&&await Promise.all(s)}async dispose(){this.currentApplication&&(await this.unload(this.currentApplication),this.currentApplication.stop(),this.currentApplication=null)}registerModule(e){if(this.currentApplication)throw Error("Cannot register modules while application is running");this.symbolLoader.registerModule(e.type,e.promise)}loadModuleBySymbol(e){const t=e,s=t.type;this.moduleLoadInjectionHook&&(t.config=this.moduleLoadInjectionHook(s,t.config||{}));const i=new r(this,this.moduleLookup,this.moduleProfiler.onDataRegister),n=Date.now(),o=this.symbolLoader.loadModule(i,t.type,t.config);return o.ctorPromise.then((e=>this.moduleLookup[s]={symbol:t.type,module:e,initialized:!1,initPromise:o.initPromise.nativePromise()})),o.initPromise.then((()=>{this.moduleProfiler.addModuleLoadTime(s,n,Date.now(),i.getLoadedDependencies()),this.moduleLookup[s].initialized=!0})),o.initPromise.nativePromise()}setLoadInjection(e){if(void 0!==this.moduleLoadInjectionHook)throw Error("Hook already registered");this.moduleLoadInjectionHook=e}async unloadModuleBySymbol(e){if(!this.symbolLoader.moduleLoaded(e))return void k.debug(`${String(e)} module already unloaded`);k.debug(`Unloading ${String(e)} module`);const t=await this.getModuleBySymbol(e),s=this.getModuleIndex(t);this.componentLookup[s]&&(await Promise.all(this.componentLookup[s].map((async e=>{await this.removeComponent(t,e.component),e.component.dispose()}))),this.componentLookup[s]=[]),this.symbolLoader.unloadModule(e),t.dispose(this)}async waitForLoadingModules(e=1e4,t=[]){await Promise.all([this.symbolLoader.whenQueueEmpties(e,t)])}getModuleBySymbol(e){return this.symbolLoader.getModule(e)}getModuleBySymbolSync(e){return this.symbolLoader.getModuleSync(e)}tryGetModuleBySymbolSync(e){try{return this.getModuleBySymbolSync(e)}catch(e){return null}}getComponentByType(e){for(const t in this.moduleLookup){const s=this.moduleLookup[t].module,i=this.getModuleIndex(s),n=this.componentLookup[i]||[];for(const t of n)if(t.component instanceof e)return t.component}return null}async addComponent(e,t){const s=this.getModuleIndex(e);let i=this.componentLookup[s];i||(this.componentLookup[s]=i=[]);let n=-1;for(let e=0;e<i.length;e++)if(i[e].component===t){n=e;break}if(-1===n&&(n=i.push({component:t,active:!1})-1,t.init()),i[n].active)throw Error("Tried to add already active component: "+typeof t);await t.activate(this),i[n].active=!0}async removeComponent(e,t){const s=this.getModuleIndex(e),i=this.componentLookup[s];if(i){let e=null;for(const s of i)if(s.component===t){e=s;break}e&&e.active&&(await t.deactivate(this),e.active=!1)}}tick(){if(S!==f.R.End)throw Error("Engine.tick called outside of waiting. Did the engine get called recursively?!");S=f.R.Begin,this.resolveAfterPhase(f.R.Begin);const e=performance.now(),t=this.lastTick?e-this.lastTick:16;this.lastTick=e,S=f.R.Logic,this.generatorSpreader.onUpdate();try{for(const e in this.moduleLookup){const s=this.moduleLookup[e];s&&s.initialized&&s.module.onUpdate(t)}}catch(e){throw k.error(e),e}this.resolveAfterPhase(f.R.Logic),this.engineGenerators.processGenerators(m.tb.Phase,f.R.Logic);try{this.renderComponents(t)}catch(e){throw k.error(e),e}try{S=f.R.Render,this.resolveAfterPhase(f.R.Render),this.engineGenerators.processGenerators(m.tb.Phase,f.R.Render),S=f.R.End,this.resolveAfterPhase(f.R.End),this.engineGenerators.processGenerators(m.tb.None),this.engineGenerators.processGenerators(m.tb.Promise),this.engineGenerators.processGenerators(m.tb.Duration)}catch(e){throw k.error(e),e}}subscribe(e,t,s=u.x.PERMANENT){return this.messageBus.subscribe(e,t,s)}unsubscribe(e,t){this.messageBus.unsubscribe(e,t)}broadcast(e){this.messageBus.broadcast(e)}claimRenderLayer(e){return this.layers.claimLayer(e)}getRenderLayer(e){return this.layers.getLayer(e)}disposeRenderLayer(e){this.layers.disposeLayer(e)}startGenerator(e){this.engineGenerators.startGenerator(e)}stopGenerator(e){this.engineGenerators.stopGenerator(e)}after(e){return this.afterPhaseListenerCount[e]++,this.afterPhasePromises[e].nativePromise()}getModuleIndex(e){for(const t in this.moduleLookup)if(this.moduleLookup[t]&&this.moduleLookup[t].module===e)return t;return""}*getComponents(){for(const e in this.moduleLookup){const t=this.componentLookup[e];if(t)for(const e of t)yield e}}toggleRendering(e,t){const s=this.getModuleIndex(e),i=this.componentLookup[s];if(i)for(const e of i)e.active=t}renderComponents(e){for(const t in this.moduleLookup){const s=this.componentLookup[t];if(s)for(const t of s)t.active&&t.component.beforeRender&&t.component.beforeRender(e)}for(const t in this.moduleLookup){if(!t)continue;const s=this.componentLookup[t];if(s)for(const t of s)t.active&&t.component.render(e)}}resetPromises(){this.resetAfterPhasePromises()}resetAfterPhasePromises(){this.resetAfterPhasePromise(f.R.Logic),this.resetAfterPhasePromise(f.R.Render),this.resetAfterPhasePromise(f.R.Begin),this.resetAfterPhasePromise(f.R.End)}resetAfterPhasePromise(e){this.afterPhasePromises[e]=new d.i,this.afterPhaseListenerCount[e]=0}resolveAfterPhase(e){this.afterPhaseListenerCount[e]>0&&(this.afterPhasePromises[e].resolve(),this.resetAfterPhasePromise(e))}get msgBus(){return this.messageBus}}},48734:(e,t,s)=>{var i,n;s.d(t,{Ay:()=>l,oN:()=>o,sv:()=>h,tb:()=>i}),function(e){e[e.None=0]="None",e[e.Duration=1]="Duration",e[e.Phase=2]="Phase",e[e.Promise=3]="Promise"}(i||(i={}));class r{constructor(e){this.type=e}}class o extends r{constructor(){super(i.None)}}class a extends r{constructor(e){super(i.Duration),this.duration=e,this.startTime=Date.now()}}class c extends r{constructor(e){super(i.Phase),this.phase=e}}!function(e){e[e.Pending=0]="Pending",e[e.Fulfilled=1]="Fulfilled",e[e.Rejected=2]="Rejected"}(n||(n={}));class h extends r{constructor(e){super(i.Promise),this.promise=e,this.promiseState=n.Pending,e.then((()=>{this.promiseState=n.Fulfilled})).catch((()=>{this.promiseState=n.Rejected}))}}class d{constructor(e,t=!0){this.generator=e,t&&this.start()}start(){this.started||(this.iterator=this.generator()),this.started=!0}iterate(){const e=this.iterator.next();this.currentResult=e.value,e.done&&(this.started=!1)}}class l{constructor(){this.generators=[]}startGenerator(e){let t=this.generators.length;for(let s=0;s<this.generators.length;s++){this.generators[s].generator===e&&(t=s)}this.generators[t]=new d(e)}stopGenerator(e){for(const t of this.generators)t.generator===e&&(t.started=!1)}processGenerators(e,t){for(const s of this.generators)if(s.started)switch(e){case i.None:(!s.currentResult||s.currentResult instanceof o)&&s.iterate();break;case i.Phase:if(s.currentResult instanceof c){const e=s.currentResult;void 0!==t&&e.phase===t&&s.iterate()}break;case i.Promise:if(s.currentResult instanceof h){s.currentResult.promiseState===n.Fulfilled&&s.iterate()}break;case i.Duration:if(s.currentResult instanceof a){const e=s.currentResult;Date.now()-e.startTime>=e.duration&&s.iterate()}}}}},65537:(e,t,s)=>{s.d(t,{c:()=>i});class i{constructor(e,t,s){this.engine=e,this.renderer=t,this.onErrorCallback=s,this.start=()=>{this.renderer.setAnimationLoop(this.tick)},this.stop=()=>{this.renderer.setAnimationLoop(null)},this.tick=e=>{try{this.engine.tick()}catch(e){this.stop(),this.onErrorCallback(e)}}}}},13777:(e,t,s)=>{s.d(t,{Ay:()=>o,Gq:()=>r});var i=s(31093);var n,r;!function(e){e[e.CANCELLED=0]="CANCELLED",e[e.COMPLETED=1]="COMPLETED"}(n||(n={})),function(e){e[e.COMPUTE=0]="COMPUTE",e[e.BACKGROUND=1]="BACKGROUND"}(r||(r={}));class o{constructor(){this.name="generator-spreader",this.computeQueue=[],this.backgroundQueue=[]}enqueue(e,t,s=r.COMPUTE,n=!1){this.cancel(e,s);const o=this.getQueue(s),a=new i.i;return n?o.unshift({id:e,generator:t,promise:a}):o.push({id:e,generator:t,promise:a}),a.nativePromise()}cancel(e,t=r.COMPUTE){const s=this.getQueue(t),i=this.indexOfId(e,t);if(-1!==i){const e=s[i];s.splice(i,1),e.promise.resolve({state:n.CANCELLED,result:null})}}indexOfId(e,t){const s=this.getQueue(t);let i=-1;for(let t=0;t<s.length;t++)if(e===s[t].id){i=t;break}return i}getQueue(e){return e===r.COMPUTE?this.computeQueue:this.backgroundQueue}hasTasks(e=r.COMPUTE){return this.getQueue(e).length>0}hasTask(e,t=r.COMPUTE){return-1!==this.indexOfId(e,t)}onUpdate(){const e=performance.now();for(;performance.now()-e<15&&this.computeQueue.length>0;){const e=this.computeQueue[0],{value:t,done:s}=e.generator.next();s&&(this.computeQueue.splice(0,1),e.promise.resolve({state:n.COMPLETED,result:t}))}const t=performance.now();for(;performance.now()-t<3&&this.backgroundQueue.length>0;){const e=this.backgroundQueue[0],{value:t,done:s}=e.generator.next();s&&(this.backgroundQueue.splice(0,1),e.promise.resolve({state:n.COMPLETED,result:t}))}}}},89103:(e,t,s)=>{s.d(t,{QB:()=>i,ct:()=>n});class i{constructor(){this.msgId=-1}setID(e){if(-1!==this.msgId)throw Error("Message.msgId can only be set once.");this.msgId=e}}class n extends i{constructor(e){super(),this.feature=e}}},39417:(e,t,s)=>{s.d(t,{Q:()=>c,x:()=>a});var i=s(24241),n=s(3066),r=s(87984);const o=new i.Vy("message-bus");var a;!function(e){e[e.PERMANENT=0]="PERMANENT",e[e.ONCE=1]="ONCE"}(a||(a={}));class c{constructor(){this.typeLookup=new r.b0,this.callbacks={},this.messageQueue=[],this.messageCount=0}subscribe(e,t,s=a.PERMANENT){return(0,n.Sh)((()=>this._subscribe(e,t,s)),(()=>this.unsubscribe(e,t)),!0,(0,r.sb)(e))}_subscribe(e,t,s=a.PERMANENT){const i=this.typeLookup.getKeyByType(e,!0);this.callbacks[i]||(this.callbacks[i]=[]),this.callbacks[i].push({type:s,callback:t})}unsubscribe(e,t){const s=this.typeLookup.getKeyByType(e);s?this.unsubscribeByIndex(s,t):o.debug(`Message callback not bound for Type: ${e.name}`)}unsubscribeByIndex(e,t){const s=this.callbacks[e].findIndex((e=>e.callback===t));-1!==s?this.callbacks[e].splice(s,1):o.debug(`Message callback not bound for TypeIndex: ${e}`)}broadcast(e){if(e.setID(this.messageCount++),this.messageQueue.push(e),1===this.messageQueue.length){for(const e of this.messageQueue){const t=this.typeLookup.getKeyByInstance(e);if(!t)continue;const s=this.callbacks[t].slice();for(const i of s)i.callback(e),i.type===a.ONCE&&this.unsubscribeByIndex(t,i.callback)}this.messageQueue=[]}}}},75578:(e,t,s)=>{s.d(t,{n:()=>i});class i{constructor(){this.bindings=[]}init(e,t){return Promise.resolve()}onUpdate(e){}dispose(e){for(const e of this.bindings)null==e||e.cancel();this.bindings=[]}}},31093:(e,t,s)=>{s.d(t,{i:()=>i});class i{constructor(){this.base=new Promise(((e,t)=>{this.resolver=e,this.rejecter=t})),this._promise=new n(this.base,this),this.progressCallbacks=[]}then(e,t){return this.base.then(e,t)}catch(e){return this.base.catch(e)}resolve(e){return this.resolver(e),this}reject(e){return this.rejecter(e),this}notify(e){for(const t of this.progressCallbacks)t(e)}progress(e){return this.progressCallbacks.push(e),this}promise(){return this._promise}nativePromise(){return this.base}static resolve(){const e=new i;return e.resolve(),e.promise()}static reject(e){const t=new i;return t.reject(e),t.promise()}static all(e){const t=[];for(const s of e)s.nativePromise?t.push(s.nativePromise()):t.push(s);const s=new i;return Promise.all(t).then((e=>s.resolve(e)),(e=>s.reject(e))),s.promise()}}class n{constructor(e,t){this.basePromise=e,this.baseDeferred=t}then(e,t){return this.baseDeferred.then(e,t),this}catch(e){return this.baseDeferred.catch(e),this}progress(e){return this.baseDeferred.progress(e),this}nativePromise(){return this.basePromise}}},36476:(e,t,s)=>{s.d(t,{H:()=>n});class i{constructor(e){this._mask=e}get mask(){return this._mask}addLayers(e){this._mask|=e.mask}removeLayers(e){return this._mask&=~e.mask}clone(){return new i(this._mask)}}class n{static get ALL(){return new i(-1)}static get NONE(){return new i(0)}static get DEFAULT(){return new i(1)}constructor(){this.layerRegistry=[],this.unusedLayers=[];for(let e=1;e<32;e++)this.unusedLayers.push(e)}claimLayer(e){const t=this.getLayer(e);if(t.mask)return t;if(0===this.unusedLayers.length)throw Error("All render layers have already been claimed");const s=this.unusedLayers[0];return this.layerRegistry[s]=e,this.unusedLayers.shift(),new i(1<<s)}getLayer(e){const t=this.layerRegistry.indexOf(e);return-1!==t?new i(1<<t):n.NONE}disposeLayer(e){const t=this.layerRegistry.indexOf(e);-1!==t&&this.unusedLayers.push(t)}}},87984:(e,t,s)=>{s.d(t,{Pw:()=>r,Uz:()=>n,b0:()=>a,sb:()=>o});var i=s(96824);const n=e=>e.prototype.constructor.name,r=e=>e.constructor,o=e=>{if("string"==typeof e)return e;if(e&&e.name)return e.name;const t=e.toString();return t.substring(0,t.indexOf("\n")).split(" ")[1]};class a{constructor(){this.typeLookupMap={},this.classUuids=new WeakMap}getKey(e){if("string"==typeof e)return e;{let t=this.classUuids.get(e);return t||(t=e.name+(0,i.e)(),this.classUuids.set(e,t)),t}}addType(e){if(!e)throw Error("Cannot index undefined type");const t=this.getKey(e);if(this.typeLookupMap[t])throw Error(`Type ${t} already registered`);return this.typeLookupMap[t]=e,t}getKeyByType(e,t){if(!e)throw Error("Cannot index undefined type");const s=this.getKey(e);let i=this.typeLookupMap[s];return!i&&t&&(i=e,this.addType(i)),i?s:""}getKeyByInstance(e,t){if(!e)throw Error("Cannot index undefined data");const s=this.getKey(e.constructor);let i=this.typeLookupMap[s];return!i&&t&&(i=e.constructor,this.addType(i)),i?s:""}getTypeByKey(e){const t=this.typeLookupMap[e];if(!t)throw Error("Key not found");if("string"==typeof t)throw Error("non type keyed result not supported");return t}getKnownTypes(){return Object.values(this.typeLookupMap)}}},244:(e,t,s)=>{var i;s.d(t,{R:()=>i}),function(e){e[e.Begin=0]="Begin",e[e.Logic=1]="Logic",e[e.Render=2]="Render",e[e.End=3]="End"}(i||(i={}))},75083:(e,t,s)=>{s.d(t,{x:()=>i});class i{constructor(e,t){this.data=e,this.inputs=t,this._outputCache=null}onRun(e){throw new Error("Method not implemented.")}onInvert(e,t){throw new Error("Method not implemented.")}run(){this._outputCache=this.onRun(this.inputs)}invert(){if(!this._outputCache)throw new Error("Attempted to inverse a data action before running it");this.onInvert(this._outputCache,this.inputs),this._outputCache=null}merge(e){return!1}get output(){if(this._outputCache)return this._outputCache;throw new Error("Tried to read output of an action before it was run")}logInfo(){return Object.assign({name:this.name()},this.inputs)}}},29376:(e,t,s)=>{s.d(t,{Z:()=>c});var i=s(24241),n=s(3350),r=s(95330);class o{constructor(e){this.afterAction=e,this.actions=[]}run(){for(const e of this.actions)e.run(),this.afterAction()}invert(){for(let e=this.actions.length-1;e>=0;e--){this.actions[e].invert(),this.afterAction()}}merge(e){if(0===this.actions.length)this.actions.push(e);else{const t=this.actions[this.actions.length-1];t&&t.merge(e)||this.actions.push(e)}return!0}logInfo(){return this.actions.map((e=>Object.assign({undo:!0},e.logInfo())))}lastAction(){return this.actions.length?this.actions[this.actions.length-1]:null}}const a=new i.Vy("undo-stack");class c{constructor(e){this.afterAction=e,this.undoBuffer=new n.C(50),this.finalized=!1,this.length=new r.L(0)}push(e){(this.undoBuffer.isEmpty()||this.finalized)&&(this.undoBuffer.push(new o(this.afterAction)),this.finalized=!1,this.length.value=this.undoBuffer.count);const t=this.undoBuffer.peek();t&&t.merge(e)}pushUndoStep(e){this.undoBuffer.isEmpty()||this.finalized||(a.warn("Adding an UndoStep when the previous step is not finalized."),this.finalize()),this.undoBuffer.push(e),this.length.value=this.undoBuffer.count}pop(){const e=this.undoBuffer.pop();return this.length.value=this.undoBuffer.count,e}peek(){const e=this.undoBuffer.peek();return this.length.value=this.undoBuffer.count,e}finalize(){this.finalized=!0}clear(){this.undoBuffer.clear(),this.length.value=this.undoBuffer.count}}},94334:(e,t,s)=>{s.d(t,{C:()=>n});var i=s(89103);class n extends i.QB{constructor(e,t){super(),this.x=e,this.y=t}}},73927:(e,t,s)=>{s.d(t,{h:()=>n});var i=s(89103);class n extends i.QB{constructor(e,t){super(),this.width=e,this.height=t}}},27947:(e,t,s)=>{s.d(t,{Jj:()=>i,lg:()=>n,zH:()=>c});var i,n,r=s(84710),o=s(71415),a=s(31093);!function(e){e[e.UNINITIALIZED=0]="UNINITIALIZED",e[e.WAITING=1]="WAITING",e[e.LOADING=2]="LOADING",e[e.STARTING=3]="STARTING",e[e.PLAYING=4]="PLAYING",e[e.ERROR=5]="ERROR"}(i||(i={})),function(e){e.UNKNOWN="unknown",e.WEBVR="webvr",e.SHOWCASE="showcase",e.WORKSHOP="workshop"}(n||(n={}));class c extends r.B{constructor(e,t=n.UNKNOWN){super(),this.name="app-data",this.phases=i,this.editMode=!1,this.playingPromise=new a.i,this.startingPromise=new a.i,this.phase=e,this.application=t,this.phaseTimes=(0,o.c)({[i.UNINITIALIZED]:0,[i.WAITING]:0,[i.LOADING]:0,[i.STARTING]:0,[i.PLAYING]:0,[i.ERROR]:0}),this.error=null,this.onPhase((()=>{this.playingPromise.resolve()}),i.PLAYING),this.onPhase((()=>{this.startingPromise.resolve()}),i.STARTING)}getName(){return this.application.toString()}getVersion(){return"25.8.3_webgl-988-gb72c7ef55c"}onPhase(e,t){return this.onPropertyChanged("phase",(s=>{t&&s!==t||e()}))}get waitForPlaying(){return this.playingPromise.nativePromise()}toString(){return JSON.stringify({application:this.getName(),version:this.getVersion(),error:this.error,phaseTimes:this.phaseTimes})}}},73943:(e,t,s)=>{s.d(t,{a:()=>a});var i=s(96540),n=s(98236),r=s(27947);const o=(0,n.v)(r.zH);function a(){const e=o(),[t,s]=(0,i.useState)(e?e.phase:null);return(0,i.useEffect)((()=>{if(!e)return()=>{};const t=e.onPropertyChanged("phase",s);return s(e.phase),()=>t.cancel()}),[e]),t}},86e3:(e,t,s)=>{s.d(t,{F:()=>r});var i=s(87805),n=s(27947);const r=(0,i.u)(n.zH,"application",n.lg.UNKNOWN)},3801:(e,t,s)=>{s.r(t),s.d(t,{default:()=>h});var i=s(20916),n=s(84217),r=s(75578),o=s(22585),a=s(27947),c=s(10843);class h extends r.n{constructor(){super(...arguments),this.name="app-phase",this.data=new a.zH(a.Jj.UNINITIALIZED)}async init(e,t){var s;this.broadcast=t.broadcast.bind(t),this.tasks=e.tasks,this.data.phase=a.Jj.UNINITIALIZED,this.data.phaseTimes[a.Jj.UNINITIALIZED]=Date.now(),this.data.application=null!==(s=e.initialApp)&&void 0!==s?s:a.lg.SHOWCASE,this.data.editMode=e.initialEditMode||!1,this.data.onChanged((()=>{this.data.error&&this.updateCurrentPhase(a.Jj.ERROR)})),t.market.register(a.zH,this.data),this.watchTasks(this.data.phase),this.watchErrors(),this.updateAppHeaders(),this.bindings.push(this.data.onPropertyChanged("application",(()=>this.updateAppHeaders())))}async watchTasks(e){if(e>=a.Jj.PLAYING)return;const t=e+1;try{await Promise.all(this.tasks[t])}catch(e){this.error(e)}t===a.Jj.PLAYING&&this.broadcast(new o.Fj(this.data.application)),this.data.phase!==a.Jj.ERROR&&e!==a.Jj.ERROR&&(this.updateCurrentPhase(t),this.watchTasks(t))}async watchErrors(){try{await Promise.all(this.tasks[a.Jj.ERROR])}catch(e){this.error(e)}}updateCurrentPhase(e){c.Ay.for(this).devInfo(`Entering "${a.Jj[e]}" for "${this.data.application}"`),this.data.phase=e,this.data.phaseTimes[e]=Date.now(),c.Ay.for(this).debug(this.data.toString()),this.data.commit(),this.broadcast(new o.uv(e,this.data.application))}error(e){this.data.error=e,this.data.commit()}updateActiveApp(e){this.data.application=e,this.data.commit(),this.broadcast(new o.E5(e))}updateAppHeaders(){c.Ay.for(this).debug(`updating application headers ${this.data.application}`),(0,i.x)(this.data.getName()),(0,n._)(this.data.getVersion())}}},22585:(e,t,s)=>{s.d(t,{E5:()=>r,Fj:()=>o,uv:()=>n});var i=s(89103);class n extends i.QB{constructor(e,t){super(),this.phase=e,this.application=t}}class r extends i.QB{constructor(e){super(),this.application=e}}class o extends i.QB{constructor(e){super(),this.application=e}}},90082:(e,t,s)=>{s.d(t,{S1:()=>n,WJ:()=>i,ZF:()=>r});const i="IAppPhaseModule",n="Sdk",r="ISettingsModule"},39018:(e,t,s)=>{var i;s.d(t,{a:()=>i}),function(e){e.POSTMESSAGE="postmessage",e.DIRECT="direct",e.WEBSOCKET="websocket"}(i||(i={}))},25773:(e,t,s)=>{s.d(t,{d:()=>r});var i=s(84710),n=s(12554);class r extends i.B{constructor(){super(...arguments),this.name="sdk",this.applicationKeys=new n.X}}},11889:(e,t,s)=>{s.r(t),s.d(t,{CommunicationMethod:()=>n.a,Sdk:()=>i.p,default:()=>i.B});var i=s(41834),n=s(39018)},78671:(e,t,s)=>{s.d(t,{I:()=>i});const i="spaces.sdk.qa"},41834:(e,t,s)=>{s.d(t,{p:()=>J,B:()=>W});var i,n=s(97084),r=s(5391),o=s(86867),a=s(10833),c=s(48059),h=s(71687),d=s(75578),l=s(56413),u=s(95330),p=s(24241),g=s(25773);!function(e){e.CONNECTION="sdk.connection",e.DISCONNECT="sdk.disconnect",e.MESSAGED="sdk.messaged",e.SUBSCRIBED="sdk.subscribed",e.UNSUBSCRIBED="sdk.unsubscribed",e.OBSERVABLE_SUB="sdk.obs.subscribe",e.OBSERVABLE_UNSUB="sdk.obs.unsubscribe",e.COLLECTION_SUB="sdk.coll.subscribe",e.COLLECTION_UNSUB="sdk.coll.unsubscribe"}(i||(i={}));class f{constructor(e){this.analytics=e,this.trackedEvents=new r.k}track(e,t,s){this.trackedEvents.has(e,t)||(this.trackedEvents.add(e,t),this.analytics.track(e,Object.assign({},s)))}alwaysTrack(e,t,s){this.trackedEvents.add(e,t),this.analytics.track(e,Object.assign({},s))}setOptions(e){this.analytics.setOptions(e)}}class m{constructor(e){this.analytics=e,this.messageType="client call"}onMessage(e,t){const{namespace:s,name:i}=e,n={applicationKey:t.applicationKey,namespace:s,name:i,method:t.communicationMethod,provider:t.context.provider,sdkType:t.context.sdkType};this.analytics.track("sdk_call",s+i,n)}}class b{constructor(){this.usedIds=new Set,this.usedIds.add(0)}generate(){let e;do{e=Math.floor(1e6*Math.random())}while(this.usedIds.has(e));return this.usedIds.add(e),e}isInUse(e){return this.usedIds.has(e)}}var y=s(21713),v=s(69991),w=s(33049),C=s(39018),O=s(75986),k=s(14895),S=s(15690),I=s(52294);class E{constructor(e,t,s,i,n){this.hostWindow=e,this.hostId=t,this.applicationKey=s,this.idGenerator=i,this.connectionReceiver=n,this.inFlightClients=new Set,this.connectionHandler=new y.Z(t,new v.m(window)),this.connectionHandler.addObserver(new O.o({onConnectionReceived:(e,t)=>this.onConnectionReceived(e,t)}))}init(){this.connectionHandler.init()}dispose(){this.connectionHandler.dispose()}onConnectionReceived(e,t){var s,i;if(this.inFlightClients.has(t.id))return;e=e||{},this.inFlightClients.add(t.id);const n=e&&e.bootstrapVersion?this.idGenerator.generate():t.id,r=this.hostId,o=t.source,a=this.hostWindow,c=new w.Y(r,a,n,o).createMessenger();this.connectionReceiver.onConnectionReceived(t.origin,e.options,{applicationKey:e.applicationKey||this.applicationKey,id:n,messenger:c,communicationMethod:C.a.POSTMESSAGE,context:{provider:(null===(s=e.options)||void 0===s?void 0:s.provider)||"",sdkType:(null===(i=e.options)||void 0===i?void 0:i.sdkType)||"",bootstrap:{version:e.bootstrapVersion,providedAppKey:!!e.applicationKey}}},{accept(e,t){c.send(new k.g(e,t,n,r,window.location.origin))},handshake(){c.send(new S.R)},reject(e){c.send(new I.v(e)),c.dispose()}})}}var P,_=s(93527),T=s(80279),R=s(55723),A=s(82655),D=s(30530),L=s(72173);!function(e){e.CONNECT_PLUGIN="connect.plugin"}(P||(P={}));class M{constructor(e,t,s,i){this.type=P.CONNECT_PLUGIN,this.payload={bootstrapVersion:e,applicationKey:s,pluginId:i,options:{auth:t.auth,provider:t.provider,sdkType:t.sdkType}}}}class x{constructor(e){this.receiver=e,this.messageType=P.CONNECT_PLUGIN}notify(e,t){this.receiver.onConnectionReceived(e,t)}}function N(e){return(0,c.G)(e)&&void 0!==e.pluginId}class U{constructor(e,t,s){this.idGenerator=t,this.connectionReceiver=s,this.host={id:e,node:new _.F(window.location.origin)},this.connectionHandler=new y.Z(e,new T.d(this.host.node)),this.connectionHandler.addObserver(new x({onConnectionReceived:(e,t)=>this.onConnectionReceived(e,t)}))}init(){this.connectionHandler.init()}dispose(){this.connectionHandler.dispose()}onConnectionReceived(e,t){j(e,this.host,{info:t,applicationKey:e.applicationKey},this.connectionReceiver,{pluginId:e.pluginId})}connect(e){const t={id:this.idGenerator.generate(),node:new _.F(origin)};return G(this.host,t,(t=>t.send(new M("plugin",{sdkType:J.Type.PLUGIN},e.applicationKey,e.pluginId))))}}class B{constructor(e,t,s,i){this.applicationKey=t,this.idGenerator=s,this.connectionReceiver=i,this.host={id:e,node:new _.F(window.location.origin)},this.connectionHandler=new y.Z(e,new T.d(this.host.node)),this.connectionHandler.addObserver(new O.o({onConnectionReceived:(e,t)=>this.onConnectionReceived(e,t)}))}init(){this.connectionHandler.init()}dispose(){this.connectionHandler.dispose()}onConnectionReceived(e,t){j(e,this.host,{info:t,applicationKey:this.applicationKey},this.connectionReceiver)}connect(e,t={}){const s={id:this.idGenerator.generate(),node:new _.F(e)};return G(this.host,s,(e=>e.send(new A.S("direct",t))))}}function G(e,t,s){const{id:i,node:n}=e,{id:r,node:o}=t,a=new R.Z(r,o,i,n);return new Promise(((e,t)=>{const c=new R.Z(r,o,i,n).createMessenger();c.init();const h=new class{accept(t,s,i,n){e({targetOrigin:origin,sourceId:t,targetId:n,scriptUrl:s,serializedInterface:i,messengerFactory:a}),c.dispose()}reject(e){t(e),c.dispose()}};c.addObserver(new D.F(h)),c.addObserver(new L.a(h)),s(c)}))}function j(e,t,s,i,n){var r,o;const{id:a,node:c}=t,{id:h,source:d,source:{origin:l}}=s.info,u=new R.Z(a,c,h,d).createMessenger();i.onConnectionReceived(l,e.options,{id:h,applicationKey:s.applicationKey,messenger:u,communicationMethod:C.a.DIRECT,context:{provider:(null===(r=e.options)||void 0===r?void 0:r.provider)||"",sdkType:(null===(o=e.options)||void 0===o?void 0:o.sdkType)||"",pluginId:N(n)?n.pluginId:void 0,bootstrap:{version:N(n)?"plugin":"direct",providedAppKey:!!e.applicationKey}}},{accept(e,t){u.send(new k.g(e,t,h,a,l))},handshake(){u.send(new S.R)},reject(e){u.send(new I.v(e)),u.dispose()}})}var K=s(7691),H=s(77331),F=s(45493),V=s(96470);class ${constructor(){this.dirty=!1}dispose(){}}const z=new p.Vy("FactAnalytics");class q{constructor(e){this.proxy=e}track(e,t,s){const i={};let n=0,r=0,o=0;if(null==s?void 0:s.records)for(const e in s.records){const t=s.records[e];let a="",c=!1;if("number"==typeof t){const e=t.toString();Number.isInteger(t)&&!e.includes(".")?n<3&&(a="integer"+n++,c=!0):r<3&&(a="float"+r++,c=!0)}else"string"==typeof t&&o<3&&(a="string"+o++,c=!0);c?i[a]={name:e,value:t}:z.info(`Omitting key: ${a} value: ${t} from fact`)}const a={applicationKey:e.client.applicationKey,pluginId:e.client.pluginId,fact:Object.assign({name:t,version:(null==s?void 0:s.version)||1},i)};(null==s?void 0:s.alwaysTrack)?this.proxy.alwaysTrack("sdk_fact",t,a):this.proxy.track("sdk_fact",t,a)}}const Q=new p.Vy("sdk");class W extends d.n{constructor(){super(...arguments),this.name="sdk",this.hostId=Math.floor(1e6*Math.random()),this.connectionHandlers=[],this.clientInterface={functions:{},commands:{},enums:{},observables:{},collections:{}},this.perOriginInterfaces=new Map,this.perSdkTypeInterfaces=new Map,this.pendingClients=new l.E,this.clientConnections=new Map,this.eventToClientSubMap=new r.k,this.clientToEventSubMap=new r.k,this.observableToClientSubMap=new r.k,this.clientToObservableSubMap=new Map,this.collectionToClientSubMap=new r.k,this.clientToCollectionSubMap=new Map,this.privateMessageHandlers=new r.k,this.valueToClientInterface={},this.commandCreators={},this.commands={},this.asyncCommands={},this.observables={},this.collections={},this.commandExecutionOrder=0,this.firstTimeCollectionSubs=new r.k,this.sdkTypeByBuild=J.Type.EMBED}async init(e,t){this.config=e,this.validationUrl=e.validationUrl,this.facade=new W.MessengerHostFacade(this),this.clientIdGenerator=new b,this.postmessageConnectHandler=new E(window,this.hostId,e.applicationKey,this.clientIdGenerator,this.facade),this.directConnectHandler=new B(this.hostId,e.applicationKey,this.clientIdGenerator,this.facade),this.pluginConnectHandler=new U(this.hostId,this.clientIdGenerator,this.facade),this.connectionHandlers.push(this.postmessageConnectHandler,this.directConnectHandler,this.pluginConnectHandler),this.sdkTypeByBuild=J.Type.EMBED,this.analytics=new f(await t.getModuleBySymbol(h.aF)),this.factAnalytics=new q(this.analytics),this.clientFilter=e.clientFilter||(()=>!0),this.issueCommand=t.commandBinder.issueCommand.bind(t.commandBinder),this.getSdkConfig=e.getSdkConfig,this.requestQueue=e.queue,this.data=new g.d,t.market.register(g.d,this.data),this.addPrivateMessageHandler(new m(this.analytics)),this.enableHandshaking()}dispose(){for(const e of this.connectionHandlers)e.dispose();this.clearInterface()}connect(e,t){try{new URL(e)}catch(e){return Promise.reject(e)}return this.directConnectHandler.connect(e,t)}connectPlugin(e,t){return this.pluginConnectHandler.connect({applicationKey:e,pluginId:t})}getClientAuth(e){const t=this.pendingClients.get(e);return t?Promise.resolve(t):new Promise((t=>{const s=this.pendingClients.onElementChanged({onAdded(i,n){n===e&&(t(i),s.cancel())}})}))}enableHandshaking(){for(const e of this.connectionHandlers)e.init()}async setupInterface(){return this.interfaceLoading||(this.interfaceLoading=this.config.setupExternalSdk(this)),this.interfaceLoading}clearInterface(){this.clientInterface.functions={},this.clientInterface.commands={},this.clientInterface.enums={},this.clientInterface.observables={},this.clientInterface.collections={},this.commandCreators={}}onUpdate(){for(const[e,t]of this.clientToObservableSubMap)for(const[s,[i,n]]of t)if(i.dirty){try{this.notifyObservableUpdate(s,n.getData(),e)}catch(t){Q.error(`Error notifying client ${e} of observable ${s} update:`,t)}i.dirty=!1}for(const[e,t]of this.clientToCollectionSubMap)for(const[s,[,i]]of t)if(i.dirty)try{this.notifyCollectionUpdates(s,i.readDiff(),e)}catch(t){Q.error(`Error notifying client ${e} of collection ${s} update:`,t)}}addCommandCreator(e,t){const s=this.getInterfaceIndex(e);if(this.clientInterface.functions.hasOwnProperty(s)&&Q.debugInfo(`Overwriting ${s} function in sdk interface`),e.sdkTypes)for(const t of e.sdkTypes){const i=this.perSdkTypeInterfaces.get(t)||{functions:{},commands:{},enums:{},observables:{},collections:{}};i.functions[s]=Object.assign({},e),this.perSdkTypeInterfaces.set(t,i)}if(e.origins)for(const t of e.origins){const i=this.perOriginInterfaces.get(t)||{functions:{},commands:{},enums:{},observables:{},collections:{}};i.functions[s]=Object.assign({},e),this.perOriginInterfaces.set(t,i)}this.clientInterface.functions[s]=e,this.commandCreators[s]=t}addEnumToInterface(e){const t=this.getInterfaceIndex(e);if(this.clientInterface.enums.hasOwnProperty(t)&&Q.debugInfo(`Overwriting ${t} enum in sdk interface`),e.sdkTypes)for(const s of e.sdkTypes){const i=this.perSdkTypeInterfaces.get(s)||{functions:{},commands:{},enums:{},observables:{},collections:{}};i.enums[t]=Object.assign({},e),this.perSdkTypeInterfaces.set(s,i)}if(e.origins)for(const s of e.origins){const i=this.perOriginInterfaces.get(s)||{functions:{},commands:{},enums:{},observables:{},collections:{}};i.enums[t]=Object.assign({},e),this.perOriginInterfaces.set(s,i)}if(this.clientInterface.enums[t]=Object.assign(Object.assign({},e),{values:Object.assign({},e.values)}),"Event"===e.name){const t=Object.keys(e.values);for(const s in t){this.valueToClientInterface;const i=e.values[t[s]];this.valueToClientInterface.hasOwnProperty(i)?Q.warn(`Duplicate event detected for ${JSON.stringify(e)}`):this.valueToClientInterface[i]=e}}}async addCommandToInterface(e,t){const s=this.getInterfaceIndex(e);if(this.addCommand(s,t),e.sdkTypes)for(const t of e.sdkTypes){const i=this.perSdkTypeInterfaces.get(t)||{functions:{},commands:{},enums:{},observables:{},collections:{}};i.commands[s]=Object.assign({},e),this.perSdkTypeInterfaces.set(t,i)}if(e.origins)for(const t of e.origins){const i=this.perOriginInterfaces.get(t)||{functions:{},commands:{},enums:{},observables:{},collections:{}};i.commands[s]=Object.assign({},e),this.perOriginInterfaces.set(t,i)}this.clientInterface.commands[s]=e}async addAsyncCommandToInterface(e,t){const s=this.getInterfaceIndex(e);if(this.addCommand(s,t,!0),e.sdkTypes)for(const t of e.sdkTypes){const i=this.perSdkTypeInterfaces.get(t)||{functions:{},commands:{},enums:{},observables:{},collections:{}};i.commands[s]=Object.assign({},e),this.perSdkTypeInterfaces.set(t,i)}if(e.origins)for(const t of e.origins){const i=this.perOriginInterfaces.get(t)||{functions:{},commands:{},enums:{},observables:{},collections:{}};i.commands[s]=Object.assign({},e),this.perOriginInterfaces.set(t,i)}this.clientInterface.commands[s]=Object.assign({},e)}async addCommand(e,t,s=!1){this.clientInterface.commands.hasOwnProperty(e)&&Q.debugInfo(`Overwriting ${e} command in sdk interface`);const i=this;return s?(this.asyncCommands[e]=t,{dispose(){delete i.asyncCommands[e]}}):(this.commands[e]=await t,{dispose(){delete i.commands[e]}})}addObservableToInterface(e,t){const s=this.getInterfaceIndex(e);if(this.addObservable(s,t),e.sdkTypes)for(const t of e.sdkTypes){const i=this.perSdkTypeInterfaces.get(t)||{functions:{},commands:{},enums:{},observables:{},collections:{}};i.observables[s]=Object.assign({},e),this.perSdkTypeInterfaces.set(t,i)}if(e.origins)for(const t of e.origins){const i=this.perOriginInterfaces.get(t)||{functions:{},commands:{},enums:{},observables:{},collections:{}};i.observables[s]=Object.assign({},e),this.perOriginInterfaces.set(t,i)}this.clientInterface.observables[s]=Object.assign({},e)}addObservable(e,t){this.clientInterface.observables.hasOwnProperty(e)&&Q.debugInfo(`Overwriting ${e} observable in sdk interface`),this.observables[e]=t;const s=this;return{dispose(){s.removeObservable(e)}}}removeObservable(e){var t;delete this.observables[e];for(const s of this.observableToClientSubMap.getValuesAtKey(e))null===(t=this.clientToObservableSubMap.get(s.id))||void 0===t||t.delete(e);this.observableToClientSubMap.removeKey(e)}addCollectionToInterface(e,t){const s=this.getInterfaceIndex(e);if(this.addCollection(s,t),e.sdkTypes)for(const t of e.sdkTypes){const i=this.perSdkTypeInterfaces.get(t)||{functions:{},commands:{},enums:{},observables:{},collections:{}};i.collections[s]=Object.assign({},e),this.perSdkTypeInterfaces.set(t,i)}if(e.origins)for(const t of e.origins){const i=this.perOriginInterfaces.get(t)||{functions:{},commands:{},enums:{},observables:{},collections:{}};i.collections[s]=Object.assign({},e),this.perOriginInterfaces.set(t,i)}this.clientInterface.collections[s]=Object.assign({},e)}addCollection(e,t){this.clientInterface.collections.hasOwnProperty(e)&&Q.debugInfo(`Overwriting ${e} collection in sdk interface`),this.collections[e]=t;const s=this;return{dispose(){s.removeCollection(e)}}}removeCollection(e){var t;delete this.collections[e];for(const s of this.collectionToClientSubMap.getValuesAtKey(e))null===(t=this.clientToCollectionSubMap.get(s.id))||void 0===t||t.delete(e);this.collectionToClientSubMap.removeKey(e)}addPrivateMessageHandler(e){const{privateMessageHandlers:t}=this;return t.add(e.messageType,e),{dispose(){t.remove(e.messageType,e)}}}getInterfaceIndex(e){let t=`${e.name}`;return e.namespace&&(t=`${e.namespace}.${t}`),t}sendPrivateMessage(e,t,s){for(const[,i]of this.clientConnections)void 0!==s&&i.executing.id!==s||i.messaging.messenger.send(new V.x$(e,t))}broadcast(e,t,s){for(const[,i]of this.clientConnections)if(t){const n=t(s);i.messaging.messenger.send(new V.WN(e,n||[]))}else i.messaging.messenger.send(new V.WN(e,[]))}notifyObservableUpdate(e,t,s){for(const i of this.observableToClientSubMap.getValuesAtKey(e))i.id===s&&i.messenger.send(new V.mS(e,t))}notifyCollectionUpdates(e,t,s){const{added:i,removed:n,updated:r}=t,o=i.size>0,a=n.size>0,c=r.size>0,h=this.clientConnections.get(s);if(h){const t=h.messaging,s=t.id;if(o)for(const[s,n]of i)t.messenger.send(new V.L0(V.CF.ITEM_ADDED,e,s,n));if(a)for(const[s]of n)t.messenger.send(new V.Vm(V.CF.ITEM_REMOVED,e,s));if(c)for(const[s,i]of r)t.messenger.send(new V.ET(V.CF.ITEM_UPDATED,e,s,i));(o||a||c||this.firstTimeCollectionSubs.has(s,e))&&(t.messenger.send(new V.Bb(V.CF.COLL_UPDATED,e)),this.firstTimeCollectionSubs.remove(s,e))}}verifyConnection(e,t){const s={cache:!1,headers:{"X-Matterport-Application-Key":t,"X-Matterport-Referrer":e},priority:n.QK.HIGH};return this.requestQueue.get(this.validationUrl,s)}async onConnectionReceived(e,t={},s,i){if(!this.clientFilter(e))return i.reject(new K.L);t&&(0,o.U)(J.Type,t.sdkType)?s.context.sdkType=t.sdkType:s.context.sdkType=this.sdkTypeByBuild;const n=new Z(t.auth,t.provider);if(!N(s.context))try{await this.verifyConnection(e,s.applicationKey),this.pendingClients.set(s.applicationKey,n)}catch(t){return n.reject(),i.reject(new H.d(`${s.applicationKey}@${e} - Key/referrer mismatch`))}const r=()=>{const t=new URL(e).hostname,i=this.perOriginInterfaces.get(t.toLowerCase()),n=this.perSdkTypeInterfaces.get(s.communicationMethod),r={enums:{},functions:{},observables:{},collections:{}},o=function(e,t,s,i){const n=e[t].sdkTypes,r=e[t].origins;if(!n&&!r)return!0;const o=n&&r&&(null==s?void 0:s[t])&&(null==i?void 0:i[t]),a=n&&!r&&(null==s?void 0:s[t]),c=!n&&r&&(null==i?void 0:i[t]);return o||a||c};for(const e in this.clientInterface.enums)o(this.clientInterface.enums,e,null==n?void 0:n.enums,null==i?void 0:i.enums)&&(r.enums[e]=this.clientInterface.enums[e]);for(const e in this.clientInterface.observables)o(this.clientInterface.observables,e,null==n?void 0:n.observables,null==i?void 0:i.observables)&&(r.observables[e]=this.clientInterface.observables[e]);for(const e in this.clientInterface.collections)o(this.clientInterface.collections,e,null==n?void 0:n.collections,null==i?void 0:i.collections)&&(r.collections[e]=this.clientInterface.collections[e]);for(const e in this.clientInterface.functions)o(this.clientInterface.functions,e,null==n?void 0:n.functions,null==i?void 0:i.functions)&&(r.functions[e]=this.clientInterface.functions[e]);for(const e in this.clientInterface.commands)o(this.clientInterface.commands,e,null==n?void 0:n.commands,null==i?void 0:i.commands)&&(r.functions[e]=this.clientInterface.commands[e]);return r};i.handshake();try{if(!N(s.context)){if(!await this.config.validateProvider(t.provider))throw n.reject(),new F.d}n.accept(),await this.setupInterface();const o=r();this.onConnectionAccepted(e,s,t);const a=new URL((await this.getSdkConfig).client);a.searchParams.append("applicationKey",s.applicationKey),i.accept(a.href,o),this.data.atomic((()=>{this.data.applicationKeys.push({key:s.applicationKey,provider:s.context.provider,sdkType:s.context.sdkType}),this.data.commit()}))}catch(e){i.reject(e)}}onConnectionAccepted(e,t,s){const i=t.id,n=t.messenger,r={messaging:Object.assign(Object.assign({},t),{origin:e}),executing:{get id(){return t.context.pluginId||String(i)},applicationKey:t.applicationKey,pluginId:t.context.pluginId}};this.clientConnections.set(i,r);const o=this.facade;n.addObserver(new V.CP(o,r.messaging)),n.addObserver(new V.co(o,r.messaging)),n.addObserver(new V.V_(o,r.messaging)),n.addObserver(new V.dP(o,r.messaging)),n.addObserver(new V.O0(o,r.messaging)),n.addObserver(new V.Gj(o,r.messaging)),n.addObserver(new V.r9(o,r.messaging)),n.addObserver(new V.Pv(o,r.messaging)),n.init(),this.trackSdkConnect(r.messaging,s)}onDisconnectReceived(e,t){const s=t.messaging,i=this.clientToEventSubMap.getValuesAtKey(s.id),n=this.clientToObservableSubMap.get(s.id)||[],r=this.clientToCollectionSubMap.get(s.id)||[];for(const e of i)this.eventToClientSubMap.remove(e,s);for(const[e]of n)this.observableToClientSubMap.remove(e,s);for(const[e]of r)this.collectionToClientSubMap.remove(e,s);this.clientToEventSubMap.removeKey(s.id),this.clientToObservableSubMap.delete(s.id),this.clientToCollectionSubMap.delete(s.id);const o=this.data.applicationKeys.indexOf({key:s.applicationKey,provider:s.context.provider,sdkType:s.context.sdkType});o>-1&&this.data.applicationKeys.splice(o,1)}onActionReceived(e,t){if(this.tryActionThroughCommand(e,t))return;const s=this.commandCreators[e.targetFunction];if(s){this.trackSdkCall(e,t.messaging.id);try{this.issueCommand(s(e.params,t.executing)).then((s=>t.messaging.messenger.send(new V.d_(e.uid,s,!0,"")))).catch((s=>t.messaging.messenger.send(new V.d_(e.uid,{},!1,s.message||s))))}catch(s){Q.debug(s),t.messaging.messenger.send(new V.d_(e.uid,{},!1,s.message))}}else t.messaging.messenger.send(new V.d_(e.uid,{},!1,`${e.targetFunction} is not a valid command`))}tryActionThroughCommand(e,t){if(this.tryActionThroughAsyncCommand(e,t))return!0;const s=this.commands[e.targetFunction];if(!s)return!!this.clientInterface.commands.hasOwnProperty(e.targetFunction)&&(t.messaging.messenger.send(new V.d_(e.uid,{},!1,`${e.targetFunction} is not ready to be called`)),!0);this.trackSdkCall(e,t.messaging.id);try{s.exec(e.params,Object.assign(Object.assign({},e.context),{client:t.executing,key:e.targetFunction,executionId:this.commandExecutionOrder++})).then((s=>{t.messaging.messenger.send(new V.d_(e.uid,s,!0,""))})).catch((s=>{t.messaging.messenger.send(new V.d_(e.uid,{},!1,s.message||s))}))}catch(s){Q.debug(s),t.messaging.messenger.send(new V.d_(e.uid,{},!1,s.message))}return!0}tryActionThroughAsyncCommand(e,t){const s=this.asyncCommands[e.targetFunction];return!!s&&(s.then((s=>{this.trackSdkCall(e,t.messaging.id);try{s.exec(e.params,Object.assign(Object.assign({},e.context),{client:t.executing,key:e.targetFunction,executionId:this.commandExecutionOrder++})).then((s=>{t.messaging.messenger.send(new V.d_(e.uid,s,!0,""))})).catch((s=>{t.messaging.messenger.send(new V.d_(e.uid,{},!1,s.message||s))}))}catch(s){Q.debug(s),t.messaging.messenger.send(new V.d_(e.uid,{},!1,s.message))}})),!0)}onEventSubReceived(e,t){const s=t.messaging;this.eventToClientSubMap.add(e.subscription,s),this.trackSdkEvent(i.SUBSCRIBED,e,s)}onEventUnsubReceived(e,t){const s=t.messaging;this.eventToClientSubMap.remove(e.subscription,s),this.trackSdkEvent(i.UNSUBSCRIBED,e,s)}async onObservableSubReceived(e,t){const s=t.messaging,n=e.observableKey,r=this.observables[n];if(r){const t=await r;if(!this.observables[n])return;if(!this.observableToClientSubMap.has(n,s)){const r=new $,o=t.subscribe(r);this.observableToClientSubMap.add(n,s);const a=this.clientToObservableSubMap.get(s.id)||new Map;a.set(n,[r,t,o]),this.clientToObservableSubMap.set(s.id,a),this.trackClientObservableSub(i.OBSERVABLE_SUB,e,s)}}else Q.error(n,"is not a valid, registered observable")}onObservableUnsubReceived(e,t){const s=t.messaging,n=e.observableKey;this.observableToClientSubMap.remove(n,s);const r=this.clientToObservableSubMap.get(s.id);if(r){const t=r.get(n);if(t){const[,,o]=t;o.cancel(),r.delete(n),this.trackClientObservableSub(i.OBSERVABLE_UNSUB,e,s)}}}async onCollectionSubReceived(e,t){const s=t.messaging,n=e.collectionKey,r=this.collections[n];if(r){const t=await r;if(!this.collections[n])return;if(!this.collectionToClientSubMap.has(n,s)){const r=t.subscribe(s),o=[t,r];this.collectionToClientSubMap.add(n,s);const a=this.clientToCollectionSubMap.get(s.id)||new Map;a.set(n,o),this.clientToCollectionSubMap.set(s.id,a),this.firstTimeCollectionSubs.add(s.id,n),this.trackClientCollectionSub(i.COLLECTION_SUB,e,s)}}else Q.error(n,"is not a valid, registered collection")}onCollectionUnsubReceived(e,t){const s=t.messaging,n=e.collectionKey;this.collectionToClientSubMap.remove(n,s);const r=this.clientToCollectionSubMap.get(s.id);if(r){const t=r.get(n);if(t){const[,o]=t;o.cancel(),r.delete(n),this.trackClientCollectionSub(i.COLLECTION_UNSUB,e,s)}}}onPrivateMessageReceived(e,t){const{messageType:s,messagePayload:i}=e;for(const e of this.privateMessageHandlers.getValuesAtKey(s))(e.clientId||e.clientId===t.executing.id)&&e.onMessage(i,t.messaging)}trackSdkConnect(e,t){if(!this.analytics)return;const s="string"==typeof(null==t?void 0:t.auth),i={origin:e.origin,applicationKey:e.applicationKey,provider:e.context.provider,method:e.communicationMethod,sdkType:e.context.sdkType,pluginId:e.context.pluginId,authTokenProvided:s,bootstrapVersion:e.context.bootstrap.version,bootstrapProvidedAppKey:e.context.bootstrap.providedAppKey};this.analytics.setOptions({authTokenProvided:s}),this.analytics.alwaysTrack("sdk_connect","connect",i)}trackSdkEvent(e,t,s){if(!this.analytics)return;const n=e===i.SUBSCRIBED?"on":"off",r=this.valueToClientInterface[t.subscription];if(!r)return;const o=Object.keys(r.values),a=o.find(((e,s)=>{const i=o[s];return r.values[i]===t.subscription}));if(!a)return;const c={origin:s.origin,applicationKey:s.applicationKey,provider:s.context.provider,sdkType:s.context.sdkType,name:n,namespace:r.namespace,eventType:a,count:this.eventToClientSubMap.valuesPerKey(t.subscription),method:s.communicationMethod,pluginId:s.context.pluginId};this.analytics.track("sdk_event",t.subscription,c)}trackSdkCall(e,t){const s=this.clientConnections.get(t);if(!s)return;const i=this.clientInterface.functions[e.targetFunction]||this.clientInterface.commands[e.targetFunction],n=s.messaging,r=Object.assign(Object.assign({origin:n.origin,applicationKey:n.applicationKey,provider:n.context.provider,sdkType:n.context.sdkType},i),{method:n.communicationMethod,pluginId:n.context.pluginId});if(this.analytics.track("sdk_call",e.targetFunction,r),i&&"Settings"===i.namespace&&"update"===i.name){const{key:t,value:s}=e.params;(0,a.K)(t)&&this.analytics.track("sdk_settings",t,{origin:n.origin,applicationKey:n.applicationKey,provider:n.context.provider,sdkType:n.context.sdkType,pluginId:n.context.pluginId,settingKey:t,settingValue:(0,c.G)(s)?{}.toString():(0,a.K)(s)?s:JSON.stringify(s)})}}trackClientObservableSub(e,t,s){const n=e===i.OBSERVABLE_SUB,r=this.clientInterface.observables[t.observableKey],o=Object.assign(Object.assign({origin:s.origin,applicationKey:s.applicationKey,provider:s.context.provider,sdkType:s.context.sdkType},r),{is_collection:!1,action:n?"subscribe":"cancel",method:s.communicationMethod,pluginId:s.context.pluginId});this.analytics.track("sdk_subscribe",t.observableKey,o)}trackClientCollectionSub(e,t,s){const n=e===i.COLLECTION_SUB,r=this.clientInterface.collections[t.collectionKey],o=Object.assign(Object.assign({origin:s.origin,applicationKey:s.applicationKey,provider:s.context.provider,sdkType:s.context.sdkType},r),{is_collection:!0,action:n?"subscribe":"cancel",method:s.communicationMethod,pluginId:s.context.pluginId});this.analytics.track("sdk_subscribe",t.collectionKey,o)}track(e,t,s){e.client.pluginId&&this.factAnalytics.track(e,t,s)}}var J;W.MessengerHostFacade=class{constructor(e){this.messageHandler=e}onConnectionReceived(e,t,s,i){this.messageHandler.onConnectionReceived(e,t,s,i)}onDisconnectReceived(e,t){const s=this.messageHandler.clientConnections.get(t.id);s&&this.messageHandler.onDisconnectReceived(e,s)}onActionReceived(e,t){const s=this.messageHandler.clientConnections.get(t.id);s&&this.messageHandler.onActionReceived(e,s)}onEventSubReceived(e,t){const s=this.messageHandler.clientConnections.get(t.id);s&&this.messageHandler.onEventSubReceived(e,s)}onEventUnsubReceived(e,t){const s=this.messageHandler.clientConnections.get(t.id);s&&this.messageHandler.onEventUnsubReceived(e,s)}onObservableSubReceived(e,t){const s=this.messageHandler.clientConnections.get(t.id);s&&this.messageHandler.onObservableSubReceived(e,s)}onObservableUnsubReceived(e,t){const s=this.messageHandler.clientConnections.get(t.id);s&&this.messageHandler.onObservableUnsubReceived(e,s)}onCollectionSubReceived(e,t){const s=this.messageHandler.clientConnections.get(t.id);s&&this.messageHandler.onCollectionSubReceived(e,s)}onCollectionUnsubReceived(e,t){const s=this.messageHandler.clientConnections.get(t.id);s&&this.messageHandler.onCollectionUnsubReceived(e,s)}onPrivateMessageReceived(e,t){const s=this.messageHandler.clientConnections.get(t.id);s&&this.messageHandler.onPrivateMessageReceived(e,s)}},function(e){let t;e.name="sdk",function(e){e.EMBED="sdk.embed",e.BUNDLE="sdk.bundle",e.PLUGIN="sdk.plugin",e.NPM_SDK="npm.embed",e.NPM_WEB_COMPONENT="npm.webcomponent",e.NPM_R3F="npm.r3f"}(t=e.Type||(e.Type={}))}(J||(J={}));class Z{constructor(e,t){this.token=e,this.provider=t,this.isAccepted=new u.L(null)}get accepted(){if(null!==this.isAccepted.value){if(this.isAccepted.value)return Promise.resolve();if(!this.isAccepted.value)return Promise.reject()}return new Promise(((e,t)=>{if(null===this.isAccepted.value){const s=this.isAccepted.onChanged((i=>{i?e():t(),s.cancel()}))}}))}accept(){this.isAccepted.value=!0}reject(){this.isAccepted.value=!1}}},87965:(e,t,s)=>{var i;s.d(t,{Y:()=>i}),function(e){e.BlursAddNudgeSeen="user_preference/blurs_add_nudge",e.DefurnishNudgeSeen="user_preference/defurnish_nudge",e.DefurnishRated="user_preference/defurnish_rated",e.DollhouseUserNudgeSeen="user_preference/dollhouse_nudge",e.FloorplanRoomsUserNudgeSeen="user_preference/floorplan_rooms_nudge",e.HighlightReelSettingsTab="user_preference/highlight_reel_settings_tab",e.LastRatingPromptTime="user_preference/model_rating_last_prompt_time",e.MeasurementContinuousLines="user_preference/measurement_continuous",e.MeasurementSnapping="user_preference/measurement_snapping",e.MeasurementUserNudgeSeen="user_preference/measurement_nudge",e.NotesAddNudgeSeen="user_preference/notes_add_nudge",e.NotesModeNudgeSeen="user_preference/notes_mode_nudge",e.SubscriberPromptDismissed="user_preference/subscriber_prompt_dismissed",e.TagsAddNudgeSeen="user_preference/tags_add_nudge",e.TourMobileNavigationPromptSeen="user_preference/tour_mobile_nav_prompt_seen",e.TourTextNudgeDismissed="user_preference/tour_text_nudge_dismissed",e.UnitType="user_preference/unit_type",e.AutoToursRated="user_preference/auto_tours_rated"}(i||(i={}))},49523:(e,t,s)=>{s.d(t,{y:()=>n});var i=s(55141);class n extends i.u{constructor(e){super(),this.payload={key:e}}}n.id="SETTING_GET"},5146:(e,t,s)=>{s.d(t,{h:()=>n});var i=s(55141);class n extends i.u{constructor(e,t){super(),this.payload={key:e,value:t}}}n.id="SETTING_UPDATE"},81459:(e,t,s)=>{s.d(t,{U:()=>i});class i{constructor(e,t){this.settingsData=e,this.settings=t,this.cache={},this.toggle=e=>{e?this.apply():this.reset()}}apply(){this.cache={};for(const e of Object.keys(this.settings)){const t=this.settingsData.tryGetProperty(e,void 0);t!==this.settings[e]&&(this.cache[e]=t,this.settingsData.setProperty(e,this.settings[e]))}}reset(){for(const e of Object.keys(this.cache)){const t=this.cache[e];this.settingsData.setProperty(e,void 0!==t&&t)}this.cache={}}}},25316:(e,t,s)=>{s.d(t,{o:()=>a});var i=s(75778),n=s(84757),r=s(84710),o=s(56413);class a extends r.B{constructor(e={}){super(),this.overrideParams=e,this.name="settings",this.properties=(0,o.y)()}setProperty(e,t){const s=this.properties.get(e);null!=t&&s===t||(this.properties.set(e,t),this.commit([e]))}notifyPropertyObserver(e,t){e(this.properties.get(t))}setLocalStorageProperty(e,t){(0,n.lk)(e,t),this.setProperty(e,t)}hasProperty(e){return this.properties.has(e)}tryGetProperty(e,t){return this.hasProperty(e)?this.properties.get(e):t}getProperty(e){if(this.hasProperty(e))return this.properties.get(e);throw new Error("SettingsData: "+e+" not found")}getOverrideParam(e,t=null,s=typeof t){var n;return(0,i.R5)(null!==(n=this.overrideParams[e])&&void 0!==n?n:null,t,s)}iterate(e){for(const t of this.properties.keys)e(t,this.getProperty(t))}}},50747:(e,t,s)=>{s.d(t,{F:()=>r});var i=s(77570),n=s(96540);const r=()=>(0,n.useContext)(i.B).settings},98239:(e,t,s)=>{s.r(t),s.d(t,{SettingPersistence:()=>p.u,default:()=>g});var i,n=s(84757),r=s(75778),o=s(75578),a=s(31093);!function(e){e[e.Init=0]="Init",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded"}(i||(i={}));class c{constructor(e,t){this.queryScope=e,this.onChange=t,this.settings={},this.helperObject={colors:{},vectors:{},quaternions:{}},this.initPromise=new a.i,this.loadState=i.Init,this.uninitError="ControlKit not yet initialized",this.lastKeys=[],this.lastKeysBufferLength=0,this.controlKit=void 0,this.updateRequired=!1,this.panels=[],this.onToggleCallbacks={},this.onKeyDown=e=>{this.lastKeys.unshift(e.keyCode),this.lastKeys.length>this.lastKeysBufferLength&&this.lastKeys.pop();for(let e=0;e<this.panels.length;e++){const t=this.panels[e].activationSequence;d(this.lastKeys,t)&&this.toggle(e)}},this.getPanelId=e=>{for(const t of this.panels)if(e===t.header)return t.index;return-1},this.getSubGroup=(e,t)=>{const s=this.panels[e];s.guiPanel||(s.guiPanel=s.makeGuiPanel()),s.allowSubGroups||(t="");let i=s.subGroups.get(t||"");if(!i){s.guiPanel.addSubGroup({label:t,enable:!s.allowSubGroups});const e=s.guiPanel._groups[s.guiPanel._groups.length-1],n=e._subGroups[e._subGroups.length-1];i=new h(s.guiPanel,e,n),s.subGroups.set(t||"",i)}return i},this.addColor=(e,t,s,i)=>{const n=this.key(t,s);this.updateHelperObject(n,i),e.addColor(this.helperObject.colors,n,{label:s,colorMode:"hex",onChange:e=>{this.settings[n].setHex(parseInt(e.substring(1),16));const t={};t[s]=this.settings[n],this.onChange(t)}})},this.addVector3=(e,t,s,i)=>{const n=this.key(e,s);this.updateHelperObject(n,i);const r=this.getSubGroup(e,`${t}: ${s}`),o=["x","y","z"];for(const e in o)r.addNumberInput(this.helperObject.vectors[n],o[e],{label:o[e],onChange:()=>{this.settings[n].set(this.helperObject.vectors[s].x,this.helperObject.vectors[s].y,this.helperObject.vectors[s].z);const e={};e[s]=this.settings[n],this.onChange(e)}})},this.addQuaternion=(e,t,s,i)=>{const n=this.key(e,s);this.updateHelperObject(n,i);const r=this.getSubGroup(e,`${t}: ${s}`),o=["x","y","z","w"];for(const e in o)r.addNumberInput(this.helperObject.quaternions[n],o[e],{label:o[e],onChange:()=>{this.settings[n].set(this.helperObject.quaternions[n].x,this.helperObject.quaternions[n].y,this.helperObject.quaternions[n].z,this.helperObject.quaternions[n].w);const e={};e[s]=this.settings[n],this.onChange(e)}})}}init(){}async loadGuiPackage(){return this.loadState===i.Init&&(s.e(9553).then(s.t.bind(s,73430,23)).then((async e=>{const t=this.queryScope.getElementById("control-kit-wrapper")||document.body,{default:n}=await s.e(9553).then(s.t.bind(s,2770,23));n.getNodeById=e=>(new n).setElement(this.queryScope.getElementById(e));const{default:r}=await s.e(9553).then(s.t.bind(s,21,23)),o=document.createElement("style");o.innerText=r.string,t.appendChild(o);const a=document.createElement("div");a.id="controlKitElement",t.appendChild(a);const c=e=>e.stopPropagation();a.addEventListener("keydown",c),a.addEventListener("keyup",c),a.addEventListener("keypress",c),a.addEventListener("mouseover",(e=>{for(let t=e.target;t;t=t.parentNode)if(t instanceof HTMLElement&&t.classList.contains("label")&&t.scrollWidth>t.clientWidth)return void(t.title=t.textContent||"")})),this.controlKit=new e.default({opacity:.9,enable:!1,parentDomElementId:"controlKitElement",useExternalStyle:!0}),this.controlKit.setShortcutEnable(""),this.controlKit.enable(),this.initPromise.resolve(),this.loadState=i.Loaded})),this.loadState=i.Loading),this.loadPromise}get loadPromise(){return this.initPromise.nativePromise()}get isLoaded(){return void 0!==this.controlKit}addPanel(e,t,s={}){for(void 0===s.width&&(s.width=250),void 0===s.allowSubGroups&&(s.allowSubGroups=!0),void 0===s.ratio&&(s.ratio=60),this.lastKeysBufferLength=Math.max(this.lastKeysBufferLength,t.length);this.lastKeysBufferLength>this.lastKeys.length;)this.lastKeys.unshift(-1);return this.panels.push({index:this.panels.length,header:e,guiPanel:null,makeGuiPanel:()=>this.controlKit.addPanel({label:e,align:"right",ratio:s.ratio,width:s.width}),subGroups:new Map,allowSubGroups:s.allowSubGroups,activationSequence:t.reverse()}),this.panels.length-1}isVisible(e){if(!this.controlKit)throw new Error(this.uninitError);return this.panels[e].guiPanel._enabled}toggle(e){this.controlKit?this.toggleVisibility(e):this.loadGuiPackage().then((()=>{this.toggleVisibility(e)}))}onToggle(e,t){this.onToggleCallbacks[e]||(this.onToggleCallbacks[e]=[]),this.onToggleCallbacks[e].push(t)}toggleVisibility(e){if(!this.controlKit)throw new Error(this.uninitError);const t=this.panels[e].guiPanel._enabled;if(t?this.panels[e].guiPanel.disable():this.panels[e].guiPanel.enable(),this.onToggleCallbacks[e])for(const s of this.onToggleCallbacks[e])s(!t)}dispose(){const e=this.queryScope.getElementById("controlKit");e&&e.remove(),this.controlKit=void 0}activate(e){this.queryScope.addEventListener("keydown",this.onKeyDown)}deactivate(e){this.controlKit&&this.controlKit.disable(),this.queryScope.removeEventListener("keydown",this.onKeyDown)}render(){this.controlKit&&this.updateRequired&&(this.updateRequired=!1,this.controlKit.update())}updateSetting(e,t,s){if(!this.controlKit)throw new Error(this.uninitError);const i=e+t,n=this.settings[i];s&&"function"==typeof s.equals&&"function"==typeof s.copy&&n&&"function"==typeof n.equals&&"function"==typeof n.copy?s.equals(this.settings[i])||(this.settings[i].copy(s),this.updateHelperObject(i,s),this.updateRequired=!0):s!==this.settings[i]&&(this.settings[i]=s,this.updateRequired=!0)}key(e,t){return`${e}${t}`}getSetting(e,t){const s=this.key(e,t);return this.settings[s]}isRegistered(e,t){return void 0!==this.getSetting(e,t)}addControl(e,t,s,i,n,r=2,o){if(!this.controlKit)throw new Error(this.uninitError);const a=this.key(e,s);this.settings[a]=i;let c=typeof i;("string"===c&&"true"===i||"false"===i)&&(c="boolean");const h="object"===c;if(h&&(null==i?void 0:i.isColor))this.addColor(this.getSubGroup(e,t),e,s,i);else if(h&&(null==i?void 0:i.isVector3))this.addVector3(e,t,s,i);else if(h&&(null==i?void 0:i.isQuaternion))this.addQuaternion(e,t,s,i);else{const h=this.getSubGroup(e,t);switch(c){case"string":Array.isArray(o)?(this.settings[a]={options:o,selected:i},h.addSelect(this.settings[a],"options",{target:"selected",label:s,onChange:e=>{const t={[s]:o[e]};this.onChange(t)}})):h.addStringInput(this.settings,a,{label:s,onChange:e=>{const t={};this.settings[a]=e,t[s]=this.settings[a],this.onChange(t)}});break;case"number":this.settings[`${a}_range`]=n||[0,10],h.addSlider(this.settings,a,`${a}_range`,{label:s,onChange:()=>{const e={};e[s]=this.settings[a],this.onChange(e)},dp:r});break;case"boolean":h.addCheckbox(this.settings,a,{label:s,ratio:10,onChange:()=>{const e={};e[s]=this.settings[a],this.onChange(e)}});break;default:h.addStringOutput(this.settings,a,{label:s})}}}addButton(e,t,s,i){if(!this.controlKit)throw new Error(this.uninitError);this.getSubGroup(e,t).addButton(s,i,{label:"none",ratio:100})}addSlider(e,t,s,i,n,r,o){if(!this.controlKit)throw new Error(this.uninitError);const a=this.getSubGroup(e,t),c=this.key(e,s);this.settings[c]=i,this.settings[c+"_range"]=[n,r],a.addSlider(this.settings,c,c+"_range",{label:s,dp:o,onChange:()=>{const e={};e[s]=this.settings[c],this.onChange(e)}})}updateHelperObject(e,t){const s="object"==typeof t;s&&(null==t?void 0:t.isColor)?this.helperObject.colors[e]="#"+t.getHexString():s&&(null==t?void 0:t.isVector3)?(this.helperObject.vectors[e]={},this.helperObject.vectors[e].x=t.x,this.helperObject.vectors[e].y=t.y,this.helperObject.vectors[e].z=t.z):s&&(null==t?void 0:t.isQuaternion)&&(this.helperObject.quaternions[e]={},this.helperObject.quaternions[e].x=t.x,this.helperObject.quaternions[e].y=t.y,this.helperObject.quaternions[e].z=t.z,this.helperObject.quaternions[e].w=t.w)}}class h{constructor(e,t,s){this.panel=e,this.group=t,this.subGroup=s}addButton(...e){this.invoke("addButton",e)}addSlider(...e){this.invoke("addSlider",e)}addSelect(...e){this.invoke("addSelect",e)}addCheckbox(...e){this.invoke("addCheckbox",e)}addColor(...e){this.invoke("addColor",e)}addStringInput(...e){this.invoke("addStringInput",e)}addStringOutput(...e){this.invoke("addStringOutput",e)}addNumberInput(...e){this.invoke("addNumberInput",e)}invoke(e,t){const s=this.panel._groups,i=this.group._subGroups,n=s.indexOf(this.group),r=i.indexOf(this.subGroup);s.splice(n,1),s.push(this.group),i.splice(r,1),i.push(this.subGroup);try{this.panel[e](...t)}finally{s.splice(n,0,s.pop()),i.splice(r,0,i.pop())}}}const d=function(e,t){const s=Math.min(e.length,t.length);for(let i=0;i<s;i++)if(e[i]!==t[i])return!1;return!0};var l=s(25316),u=s(10843),p=s(26072);class g extends o.n{constructor(){super(...arguments),this.name="settings",this.queuedControls=[],this.queuedButtons=[],this.secretWord=[38,38,40,40,37,39,37,39,66,65,72],this.panelID=-1,this.addPanel=(e,t,s)=>{const i=this.getPanelId(e);return-1===i?this.settingsGUI.addPanel(e,t,s):i},this.getPanelId=e=>this.settingsGUI.getPanelId(e)}async init(e,t){var s;this.engine=t,this.settings=new l.o(e.overrideParams),this.engine.market.register(l.o,this.settings),e.useGUI&&(this.settingsGUI=new c(null!==(s=e.queryScope)&&void 0!==s?s:document,(e=>{this.updateSettings(e)})),t.addComponent(this,this.settingsGUI),this.panelID=this.settingsGUI.addPanel("25.8.3_webgl-988-gb72c7ef55c",this.secretWord)),e.initialSettings&&this.updateSettings(e.initialSettings),e.useGUI&&this.settingsGUI.loadPromise.then((()=>{for(const e of this.queuedControls)this.settingsGUI.addControl(e.panelId,e.group,e.settingName,e.value,e.range,e.rangePrecision,e.options);for(const e of this.queuedButtons)this.settingsGUI.addButton(e.panelId,e.group,e.buttonName,e.callback);this.settingsGUI.toggle(this.panelID)}))}get settingsData(){return this.settings}get loadPromise(){return this.settingsGUI.loadPromise}getSettingsGui(){return this.settingsGUI}getMainPanelId(){return this.panelID}updateSetting(e,t,s=this.panelID){t&&t.clone&&"function"==typeof t.clone?this.settings.setProperty(e,t.clone()):this.settings.setProperty(e,t),this.settingsGUI&&this.settingsGUI.isLoaded&&this.settingsGUI.updateSetting(s,e,t)}updateSettings(e){for(const t in e)this.updateSetting(t,e[t])}registerSetting(e,t,s,i=!0,r=p.u.NONE,o,a=this.panelID,c=2,h){if(this.settingsGUI&&this.settingsGUI.isRegistered(a,t))return void u.Ay.for(this).warn(`Duplicate setting ${t} registered. Is a module being used twice?`);let d;d=s&&s.clone&&"function"==typeof s.clone?s.clone():s,this.settingsGUI&&i&&(this.settingsGUI.isLoaded?this.settingsGUI.addControl(a,e,t,d,o,c,h):this.queuedControls.push({panelId:a,group:e,settingName:t,value:s,range:o,rangePrecision:c,options:h}));const l=r===p.u.LOCAL_STORAGE?(0,n.zM)(t,s):s;this.updateSetting(t,l)}registerMenuEntry(e){const{header:t,setting:s,initialValue:i,persist:n,displayInUi:o,range:a,panel:c,onChange:h,rangePrecision:d,options:l,urlParam:u}=e;let p=i();const g=encodeURIComponent(s);if(u){const e=(0,r.P3)(g,null);null!==e&&(p="true"===e||"false"!==e&&function(e){if(""===e)return e;const t=+e;return isNaN(t)?e:t}(e))}if(this.registerSetting(t,s,p,o,n,a,c,d,l),!h&&!u)return null;if(h&&h(p),u){const e=i(),t=t=>{const s=(0,r.DE)();s.has(g)&&t===e?s.delete(g):s.set(g,t),(0,r.SS)(s.toString(),!0),h&&h(t)};return this.settings.onPropertyChanged(s,t)}return h?this.settings.onPropertyChanged(s,h):null}registerMenuButton(e){const{header:t,buttonName:s,panel:i,callback:n}=e;this.registerButton(t,s,n,i)}registerButton(e,t,s,i=this.panelID){this.settingsGUI&&(this.settingsGUI.isLoaded?this.settingsGUI.addButton(i,e,t,s):this.queuedButtons.push({panelId:i,group:e,buttonName:t,callback:s}))}hasProperty(e){return this.settings.hasProperty(e)}getProperty(e){return this.settings.getProperty(e)}tryGetProperty(e,t){return this.settings.tryGetProperty(e,t)}toggleMenu(){this.settingsGUI&&this.settingsGUI.toggle(0)}disposeGui(){this.settingsGUI.dispose()}}},26072:(e,t,s)=>{var i;s.d(t,{u:()=>i}),function(e){e[e.NONE=0]="NONE",e[e.LOCAL_STORAGE=1]="LOCAL_STORAGE"}(i||(i={}))},45395:(e,t,s)=>{var i;s.d(t,{D:()=>i}),function(e){e[e.Immediate=0]="Immediate",e[e.NextFrame=1]="NextFrame",e[e.Duration=2]="Duration",e[e.Manual=3]="Manual",e[e.Debounced=4]="Debounced"}(i||(i={}))},76234:(e,t,s)=>{s.d(t,{Xw:()=>i,gj:()=>c,jz:()=>h});var i,n=s(79070),r=s(21440),o=s(244),a=s(45395);!function(e){e.added="added",e.removed="removed",e.updated="updated"}(i||(i={}));class c{constructor(e,t,s){this.index=e,this.action=t,this.diff=s}}class h{constructor(e,t){if(this.changedHandlers=[],this.awaitingInvoke=!1,this.diffRecord=[],this.targetMonitors={},this.triggerChangeHandlers=this.invokeChangeHandlers.bind(this),this.config=e,this.updatePhaseSync=t,this.config.aggregationType===a.D.NextFrame){if(!t)throw Error("UpdatePhaseSync required for NextFrame aggregation")}else{if(this.config.aggregationType===a.D.Duration)throw Error("Aggregation Type not implemented");this.config.aggregationType===a.D.Debounced&&(this.triggerChangeHandlers=(0,n.s)(this.invokeChangeHandlers.bind(this),e.aggregationDuration))}}hasDiffRecord(){return this.diffRecord.length>0}clearDiffRecord(){this.diffRecord=[];for(const e in this.targetMonitors){const t=this.targetMonitors[e];t.hasDiffRecord()&&t.clearDiffRecord()}this.awaitingInvoke=!1}onChanged(e){this.changedHandlers.push(e)}removeOnChanged(e){(0,r.Nz)(this.changedHandlers,e)}invokeCallbacks(e){if(this.changedHandlers.length>0)for(const t of this.changedHandlers)t(e)}invokeChangeHandlers(e){var t;switch(this.config.aggregationType){case a.D.Immediate:case a.D.Debounced:this.invokeCallbacks(e);break;case a.D.NextFrame:this.awaitingInvoke||(this.awaitingInvoke=!0,null===(t=this.updatePhaseSync)||void 0===t||t.after(o.R.End).then((()=>{this.awaitingInvoke&&(this.invokeCallbacks(e),this.awaitingInvoke=!1)})));case a.D.Manual:}}}},35473:(e,t,s)=>{s.d(t,{F:()=>o});var i=s(28913),n=s(76234),r=s(2391);class o extends n.jz{constructor(e,t,s){super(t,s),this.target=e;for(const i of e.keys){const n=e.get(i),o=new r.V(n,t,s);o.onChanged(this.triggerChangeHandlers),this.targetMonitors[i]=o}const o={onAdded:(e,o)=>{const a=new r.V(e,t,s);a.onChanged(this.triggerChangeHandlers),this.targetMonitors[o]=a;const c=this.diffRecord.findIndex((e=>e.index===o));-1!==c&&this.diffRecord.splice(c,1);const h=new n.gj(o,n.Xw.added,(0,i.A4)(e));-1===c&&this.diffRecord.push(h),this.triggerChangeHandlers(h)},onRemoved:(e,t)=>{delete this.targetMonitors[t];const s=this.diffRecord.findIndex((e=>e.index===t));-1!==s&&this.diffRecord.splice(s,1);const r=new n.gj(t,n.Xw.removed,(0,i.A4)(e));-1===s&&this.diffRecord.push(r),this.triggerChangeHandlers(r)}};this.target.onElementChanged(o)}commitChanges(){this.invokeCallbacks(this.getDiffRecord())}getDiffRecord(){const e=[];for(const t in this.targetMonitors){const s=this.targetMonitors[t];if(s.hasDiffRecord()){const r=s.getDiffRecord(),o=this.diffRecord.findIndex((e=>e.index===t));-1!==o?(0,i.h1)(this.diffRecord[o].diff,r):e.push(new n.gj(t,n.Xw.updated,r))}}return this.diffRecord.concat(e)}}},2391:(e,t,s)=>{s.d(t,{V:()=>c});var i=s(79070),n=s(21440),r=s(28913),o=s(244),a=s(45395);class c{constructor(e,t,s){this.updatePhaseSync=s,this.target=e,this.clearDiffRecord(),this.aggregationType=t.aggregationType,this.aggregationType===a.D.Debounced&&(this.handleAggregation=(0,i.s)(this.handleAggregation.bind(this),t.aggregationDuration||30)),this.target.onChanged((()=>{this.diffRecord=(0,r.bB)(this.originalData,(0,r.A4)(this.target),t.shallow),this.handleAggregation()})),this.changedHandlers=[]}hasDiffRecord(){return Object.keys(this.diffRecord).length>0}getDiffRecord(){return this.diffRecord}clearDiffRecord(){this.originalData=(0,r.A4)(this.target),this.diffRecord={}}onChanged(e){this.changedHandlers.push(e)}removeOnChanged(e){(0,n.Nz)(this.changedHandlers,e)}commitChanges(){this.triggerChangeHandlers(this.diffRecord)}handleAggregation(){switch(this.aggregationType){case a.D.Immediate:this.triggerChangeHandlers(this.diffRecord);break;case a.D.NextFrame:if(!this.updatePhaseSync)throw new Error("handleAggregation() -> Next frame aggregation requested, but updatePhaseSync is null");this.nextFramePromise||(this.nextFramePromise=this.updatePhaseSync.after(o.R.Begin).then((()=>{this.triggerChangeHandlers(this.diffRecord)})).finally((()=>{this.nextFramePromise=void 0})));break;case a.D.Debounced:this.triggerChangeHandlers(this.diffRecord);break;case a.D.Duration:throw new Error("AggregationType.Duration: Please implement me :)");case a.D.Manual:}}triggerChangeHandlers(e){if(this.changedHandlers.length>0)for(const t of this.changedHandlers)t(e)}}},31036:(e,t,s)=>{s.d(t,{r:()=>r});var i=s(68986),n=s(587);class r extends n.c{constructor(e,t){super(),this.computation=e,this.updateValue=()=>{const e=this.computation();e!==this._lastValue&&(this._prevValue=this._lastValue,this._lastValue=e,this.setDirty(!0))},this._lastValue=this.computation(),this._prevValue=null,this._subscriptions=new i.P(...t.map((e=>e(this.updateValue))))}get value(){return this._lastValue}get prevValue(){return this._prevValue}renew(){this._subscriptions.renew()}cancel(){this._subscriptions.cancel()}notifyObserver(e){e(this._lastValue)}}},587:(e,t,s)=>{s.d(t,{c:()=>n});var i=s(3066);class n{constructor(){this.isObservable=!0,this._dirtyObservable=!1,this._activeObservable=!0,this._observerNotifying=!1,this._changeObservers=new Set,this._parentObservables=new Set,this._childObservables=new Set,Object.defineProperties(this,{isObservable:{value:this.isObservable,writable:!1,enumerable:!1},_dirtyObservable:{value:this._dirtyObservable,enumerable:!1},_activeObservable:{value:this._activeObservable,enumerable:!1},_observerNotifying:{value:this._observerNotifying,enumerable:!1},_changeObservers:{value:this._changeObservers,writable:!1,enumerable:!1},_childObservables:{value:this._childObservables,writable:!1,enumerable:!1},_parentObservables:{value:this._parentObservables,writable:!1,enumerable:!1}})}onChanged(e){if(this._changeObservers.has(e))throw new Error("This observer function is already observing this Observable, and double subscriptions are not supported.");return(0,i.Sh)((()=>this._changeObservers.add(e)),(()=>this.removeOnChanged(e)),!0)}removeOnChanged(e){this._changeObservers.delete(e)}notifyObservers(){if(this._dirtyObservable&&!this._observerNotifying&&this._activeObservable){this._observerNotifying=!0;for(const e of this._changeObservers)this.notifyObserver(e);this._dirtyObservable=!1,this._observerNotifying=!1}}notifyObserver(e){e(void 0)}notifyDown(){for(const e of this._childObservables)e.notifyDown();this.notifyObservers()}notifyUp(){for(const e of this._parentObservables)e.notifyUp();this.notifyObservers()}setDirty(e=!0){this.setDirtyUp(),e&&this.notifyUp()}setDirtyUp(){if(!this._dirtyObservable){this._dirtyObservable=!0;for(const e of this._parentObservables)e.setDirtyUp()}}addChildObservable(e){n.isObservable(e)&&(this._childObservables.add(e),e._parentObservables.add(this))}removeChildObservables(e){n.isObservable(e)&&(this._childObservables.delete(e),e._parentObservables.delete(this))}atomic(e){if(!this._activeObservable)return e();try{this.setActive(!1),e()}finally{this.setActive(!0)}}setActive(e){const t=this._activeObservable;this._activeObservable=e,!t&&e&&this.notifyObservers();for(const t of this._childObservables)t.setActive(e)}deepCopy(){throw Error("deepCopy is only implemented in subclasses of Observable")}static isObservable(e){return e&&e.isObservable}}},12554:(e,t,s)=>{s.d(t,{X:()=>r,Z:()=>o});var i=s(28913),n=s(587);class r extends n.c{constructor(){super(),this.isObservableArray=!0,this.elements=[]}static from(...e){const t=new r;return t.push(...e),t}push(...e){for(const t of e)this.elements.push(t),this.addChildObservable(t);return this.setDirty(),this.length}concat(e){const t=this.elements.length;this.elements=this.elements.concat(...e);for(let e=t;e<this.elements.length;e++)this.addChildObservable(this.elements[e]);return this.setDirty(),this.length}replace(e){for(const e of this.elements)this.removeChildObservables(e);return this.elements=[],this.concat(e)}remove(e){if(e<0||e>=this.length)throw new Error(`Index ${e} not in range of ObservableArray`);const[t]=this.elements.splice(e,1);this.removeChildObservables(t),this.setDirty()}clear(){for(;this.length;)this.remove(0)}update(e,t){const s=this.elements[e];s!==t&&(this.elements[e]=t,this.removeChildObservables(s),this.addChildObservable(t),this.setDirty())}get length(){return this.elements.length}set length(e){if(e<this.elements.length){for(let t=this.elements.length-1;t>=e;t--){const e=this.elements[t];this.removeChildObservables(e)}this.elements.length=e,this.setDirty()}}entries(){return this.elements.entries()}values(){return[...this.elements]}filter(e){return this.elements.filter(e)}find(e){return this.elements.find(e)}*[Symbol.iterator](){for(const e of this.elements)yield e}map(e,t){return this.elements.map(e,t)}forEach(e,t){this.elements.forEach(e,t)}sort(e){this.elements.sort(e)}get(e){return this.elements[e]}findIndex(e,t){return this.elements.findIndex(e,t)}indexOf(e){return this.elements.indexOf(e)}splice(e,t,...s){let i;if(s.length){i=this.elements.splice(e,t,...s);for(const e of s)this.addChildObservable(e)}else i=this.elements.splice(e,t);for(const e of i)this.removeChildObservables(e);return this.setDirty(),i}insert(e,t){if(e>this.elements.length)throw new Error(`Tried to insert at index ${e} in an array that's only ${this.elements.length} long`);e!==this.elements.length?(this.elements.splice(e,0,t),this.addChildObservable(t),this.setDirty()):this.push(t)}shift(){const e=this.elements.shift();return e&&(this.removeChildObservables(e),this.setDirty()),e}move(e,t){if(t>this.elements.length-1)throw Error("Index to move to is out of bounds");const s=this.elements[e];this.elements.splice(e,1),this.elements.splice(t,0,s),this.setDirty()}includes(e,t){return this.elements.includes(e,t)}some(e,t){return this.elements.some(e,t)}every(e,t){return this.elements.every(e,t)}onElementChanged(e){let t=this.elements.slice();return this.onChanged((()=>{for(const s in t){const i=parseInt(s,10);e.onRemoved&&void 0===this.get(i)&&e.onRemoved(t[i],i)}for(const s in this.elements){const i=parseInt(s,10),r=this.get(i);void 0===t[i]?e.onAdded&&e.onAdded(r,i):(n.c.isObservable(r)&&r._dirtyObservable||r!==t[i])&&(e.onUpdated?e.onUpdated(r,i):e.onRemoved&&null===r&&e.onRemoved(t[i],i))}t=this.elements.slice()}))}deepCopy(){return this.map((e=>(0,i.A4)(e)))}}const o=e=>{const t=new r;return e&&t.concat(e),t}},56413:(e,t,s)=>{s.d(t,{E:()=>o,y:()=>a});var i=s(28913),n=s(587);function r(e){return(0,i.Et)(e)?""+e:e}class o extends n.c{constructor(){super(),this.map={},this._keysSet=new Set,this._keysList=[]}get keys(){return this._keysList.slice()}get values(){return this._keysList.map((e=>this.get(e)))}entries(){const e=[];for(const t in this.map)e.push([t,this.map[t]]);return e}get length(){return this._keysList.length}*[Symbol.iterator](){for(const e of this._keysList)yield this.get(e)}get(e){return this.map[e]}has(e){return void 0!==this.map[e]}set(e,t){e=r(e);this.map[e]!==t&&(this.removeChildObservables(this.map[e]),this.addChildObservable(t),this.map[e]=t,this._keysSet.has(e)||(this._keysList.push(e),this._keysSet.add(e)),this.setDirty())}clear(){if(this.length>0){for(const e in this.map)this.removeChildObservables(this.map[e]);this.map={},this._keysSet.clear(),this._keysList=[],this.setDirty()}}replace(e){this.clear();for(const t in e)this.set(t,e[t])}delete(e){e=r(e),this.removeChildObservables(this.map[e]);const t=this.map.hasOwnProperty(e);return delete this.map[e],t&&(this._keysSet.delete(e),this._keysList.splice(this._keysList.indexOf(e),1),this.setDirty()),t}forEach(e,t){for(const s of this._keysList){const i=this.map[s];e.call(t,i,s,this)}}onElementChanged({onAdded:e,onRemoved:t,onUpdated:s}){return this.onElementsChanged((({added:i,removed:n,updated:r})=>{if(n&&t)for(const[e,s]of n)t(s,e);if(i&&e)for(const[t,s]of i)e(s,t);if(r&&s)for(const[e,t]of r)s(t,e)}))}onElementsChanged(e){let t=Object.assign({},this.map);return this.onChanged((()=>{const s={};for(const e in t)this.has(e)||(s.removed||(s.removed=[])).push([e,t[e]]);for(const e of this._keysList){const i=this.get(e);void 0===t[e]?(s.added||(s.added=[])).push([e,i]):(n.c.isObservable(i)&&i._dirtyObservable||i!==t[e])&&(null!==i?(s.updated||(s.updated=[])).push([e,i]):(s.removed||(s.removed=[])).push([e,t[e]]))}t=Object.assign({},this.map),e(s)}))}deepCopy(){const e={};for(const t of this._keysList)e[t]=(0,i.A4)(this.map[t]);return e}}const a=(e={})=>{const t=new o;return t.replace(e),t}},42743:(e,t,s)=>{s.d(t,{g:()=>i,q:()=>o});var i,n=s(587),r=s(3066);!function(e){e.LOW="low",e.NORMAL="normal"}(i||(i={}));class o extends n.c{constructor(e){super(),this.priority=i.NORMAL,this.filters=new Map,this.view=[],this._keys=new Map,this._dirty=!1,this.sortNeeded=!1,this._diff={},this.map=e,this.applyFilters(),this.map.onElementsChanged((({added:e,removed:t,updated:s})=>{this._diff={added:e,removed:t,updated:s},this._diff.added&&(this._diff.added=this._diff.added.filter((([e,t])=>this.testFilters(t)))),this._diff.updated&&(this._diff.updated=this._diff.updated.filter((([e,t])=>this.testFilters(t)))),this._diff.removed&&(this._diff.removed=this._diff.removed.filter((([e,t])=>this.testFilters(t)))),this.atomic((()=>{if(t)for(const[e,s]of t)this.onRemoved(e,s);if(e)for(const[t,s]of e)this.onAdded(t,s);if(s)for(const[e,t]of s)this.onUpdated(e,t)}))})),this.map.onChanged((()=>{this.sortNeeded&&(this.applySort(),this.setDirty(),this.sortNeeded=!1)}))}onElementsChanged(e){return this.onChanged((()=>{e(this._diff)}))}onElementChanged({onAdded:e,onRemoved:t,onUpdated:s}){return this.onElementsChanged((({added:i,removed:n,updated:r})=>{if(n&&t)for(const[e,s]of n)t(s,e);if(i&&e)for(const[t,s]of i)e(s,t);if(r&&s)for(const[e,t]of r)s(t,e)}))}has(e){return this._keys.has(e)}get(e){return this.has(e)?this.map.get(e):void 0}setFilter(e,t){return(0,r.Sh)((()=>{this.filters.set(e,t),this.applyFilters(void 0,!1,!0)}),(()=>this.clearFilter(e)),!0)}clearFilter(e){return!!this.filters.has(e)&&(this.filters.delete(e),this.applyFilters(void 0,!1,!0),!0)}clearFilters(){this.filters.clear(),this.applyFilters(void 0,!1,!0)}sort(e){this.compareFunc=e,this.applySort(),this.setDirty()}*[Symbol.iterator](){for(const e of this.view)yield e}get length(){return this.view.length}groupBy(e){const t={};for(const s of this.view){const i=String(s[e]);t[i]||(t[i]=[]),t[i].push(s)}return t}get values(){return this.view.slice()}entries(){return[...this._keys.entries()]}forEach(e,t){for(const[s,i]of this._keys)e.call(t,i,s,this)}setDirty(e=!0){this.priority===i.LOW?this._dirty||(this._dirty=!0,requestAnimationFrame((()=>{this._dirty=!1,super.setDirty(e)}))):super.setDirty(e)}add(e){if(this.has(e))return!1;const t=this.map.get(e);return this._keys.set(e,t),this.view.push(t),!0}delete(e){const t=this._keys.get(e);if(!t)return!1;this._keys.delete(e);const s=this.view.indexOf(t);return-1!==s&&this.view.splice(s,1),!0}testFilters(e){return[...this.filters.values()].every((t=>t(e)))}applyFilters(e,t=!1,s=!1){s&&(this._diff={});let i=!1;const n=e?[e]:this.map.keys;for(const e of n){const t=this.map.get(e),n=this.testFilters(t);n&&this.add(e)?(s&&(this._diff.added||(this._diff.added=[]),this._diff.added.push([e,t])),i=!0):!n&&this.delete(e)&&(s&&(this._diff.removed||(this._diff.removed=[]),this._diff.removed.push([e,t])),i=!0)}e&&this.has(e)&&(s&&(this._diff.updated||(this._diff.updated=[]),this._diff.updated.push([e,this.map.get(e)])),i=!0),i&&(t?this.sortNeeded=!0:(this.applySort(),this.setDirty()))}applySort(){this.compareFunc&&this.view.sort(this.compareFunc)}onRemoved(e,t){this.has(e)&&this.testFilters(t)&&this.delete(e)&&this.setDirty()}onAdded(e,t){this.testFilters(t)&&this.applyFilters(e,!0,!1)}onUpdated(e,t){const s=this._keys.get(e),i=this.view.findIndex((e=>e===s));-1!==i&&(this.view[i]=t,this._keys.set(e,t)),this.applyFilters(e,!0,!1)}}},85616:(e,t,s)=>{s.d(t,{v:()=>d});var i=s(28913),n=s(24241),r=s(75778),o=s(3066),a=s(587);const c=new n.Vy("ObservableObject"),h=1===(0,r.P3)("debug",0);class d extends a.c{constructor(){super(),this._propertyObservables={},this._valueCache={},this._dirtyKeys=new Set,Object.defineProperties(this,{_propertyObservables:{value:this._propertyObservables,writable:!1,enumerable:!1},_valueCache:{value:this._valueCache,writable:!1,enumerable:!1},_dirtyKeys:{value:this._dirtyKeys,writable:!1,enumerable:!1}}),h&&setTimeout((()=>{!function(e){const t={};for(const s in e)e.hasOwnProperty(s)&&(t[s]=e[s],e._valueCache[s]=e[s],Object.defineProperty(e,s,{get:()=>t[s],set:i=>{const n=e._valueCache[s];(n!==i||a.c.isObservable(n)&&n._dirtyObservable)&&u(e,s),t[s]=i},enumerable:!0}))}(this)}),1)}onPropertyChanged(e,t){if(this._propertyObservables[e]||(this._propertyObservables[e]=[]),-1!==this._propertyObservables[e].indexOf(t))throw new Error("This observer function is already observing this Observable, and double subscriptions are not supported.");return(0,o.Sh)((()=>this._propertyObservables[e].push(t)),(()=>this.removeOnPropertyChanged(e,t)),!0,e)}removeOnPropertyChanged(e,t){const s=this._propertyObservables[e].indexOf(t);s>=0&&this._propertyObservables[e].splice(s,1)}commit(e=[]){for(const t of e)this._dirtyKeys.add(t);this.setDirtyUp(),this.notifyUp()}setDirtyUp(){for(const e in this){if(!this.hasOwnProperty(e))continue;const t=this._valueCache[e],s=this[e];t!==s?(this.removeChildObservables(t),this.addChildObservable(s),this._valueCache[e]=s,this._dirtyKeys.add(e)):a.c.isObservable(t)&&t._dirtyObservable&&this._dirtyKeys.add(e)}super.setDirtyUp()}notifyObservers(){if(this._dirtyObservable&&!this._observerNotifying&&this._activeObservable){this._observerNotifying=!0;for(const e of this._dirtyKeys){for(const t of this._propertyObservables[e]||[])this.notifyPropertyObserver(t,e);h&&p(this,e)}this._observerNotifying=!1,this._dirtyKeys.clear()}super.notifyObservers()}notifyPropertyObserver(e,t){e(this._valueCache[t])}notifyObserver(e){e(this)}deepCopy(){const e={};for(const t in this)this.hasOwnProperty(t)&&(e[t]=(0,i.A4)(this[t]));return e}}const l=new Map;function u(e,t){l.has(e)||l.set(e,{});l.get(e)[t]=Error()}function p(e,t){if(l.has(e)){const s=l.get(e);s[t]&&delete s[t]}}if(h){const e=setInterval((()=>{(function(){for(const e of l.values())for(const t in e)return c.error(`ObservableObject property "${t}" was still dirty after one tick! Did you forget a .commit()?`),c.error("See stack trace of the property write below:"),c.error(e[t].stack),!0;return!1})()&&void 0!==e&&clearInterval(e)}),16)}},71415:(e,t,s)=>{s.d(t,{c:()=>c});var i=s(28913);function n(e,t){const s=Object.getOwnPropertyNames(t);for(const i of s)void 0===e[i]&&("function"==typeof t[i]?Object.defineProperty(e,i,{value:t[i].bind(e)}):Object.defineProperty(e,i,{value:t[i],writable:!0}));null!==Object.getPrototypeOf(Object.getPrototypeOf(t))&&n(e,Object.getPrototypeOf(t))}var r=s(587),o=s(95330),a=s(85616);const c=e=>{if(!e||0===Object.keys(e).length)throw new Error("createObservableProxy() only works on objects that has predefined keys. Did you mean createObservableMap or createObservableArray?");if(e instanceof a.v)throw new Error("Using ObservableProxy on an ObservableObject is a BUG!");if(e.isObservableProxy)return e;const t={},s=new r.c,c=Object.create(e);Object.defineProperties(c,{isObservableProxy:{value:!0},onPropertyChanged:{value:(e,s)=>t[e].onChanged(s)},removeOnPropertyChanged:{value:(e,s)=>t[e].removeOnChanged(s)},deepCopy:{value:()=>(0,i.A4)(e)}}),n(c,s);for(const s in e)if(e.hasOwnProperty(s)){const i=(0,o.p)(e[s]);t[s]=i,c.addChildObservable(i),Object.defineProperty(c,s,{get:()=>e[s],set:i=>{e[s]=i,t[s].value=i},enumerable:!0})}return Object.seal(c),c}},12027:(e,t,s)=>{s.d(t,{y:()=>r});var i=s(587),n=s(28913);class r extends i.c{constructor(){super(...arguments),this.elements=new Set}add(e){return this.has(e)||(this.elements.add(e),this.addChildObservable(e),this.setDirty()),this}clear(){this.atomic((()=>{const e=[...this.elements];for(const t of e)this.delete(t)}))}delete(e){const t=this.elements.delete(e);return t&&(this.removeChildObservables(e),this.setDirty()),t}has(e){return this.elements.has(e)}forEach(e,t){this.elements.forEach(e,t)}get size(){return this.elements.size}*entries(){yield*this.elements.entries()}*keys(){yield*this.elements.keys()}*values(){yield*this.elements.values()}*[Symbol.iterator](){yield*this.elements}addValues(e){for(const t of e)this.add(t);return this}replace(e){this.clear();for(const t of e)this.add(t)}get[Symbol.toStringTag](){return"ObservableSet"}filter(e,t){const s=[...this.elements].filter(e,t);return new Set(s)}find(e,t){return[...this.elements].find((s=>e.call(t,s,this)))}map(e,t){const s=[...this.elements].map(e,t);return new Set(s)}deepCopy(){const e=new Set;for(const t of this)e.add((0,n.A4)(t));return e}onElementChanged(e){let t=new Set(this);return this.onChanged((()=>{for(const s of t)e.onRemoved&&!this.has(s)&&e.onRemoved(s,s);for(const s of this.elements)t.has(s)?i.c.isObservable(s)&&s._dirtyObservable&&e.onUpdated&&e.onUpdated(s,s):e.onAdded&&e.onAdded(s,s);t=new Set(this)}))}}},95330:(e,t,s)=>{s.d(t,{L:()=>o,p:()=>a});var i=s(28913),n=s(587);function r(e,t){return e instanceof Function?e(t):t===e}class o extends n.c{constructor(e){super(),this.value=e}notifyObserver(e){e(this.value)}get value(){return this._value}set value(e){this._value!==e&&(this.removeChildObservables(this._value),this.addChildObservable(e),this._value=e,this.setDirty())}deepCopy(){return(0,i.A4)(this._value)}waitFor(e){return new Promise((t=>{if(r(e,this._value))t();else{const s=this.onChanged((i=>{r(e,i)&&(s.cancel(),t())}))}}))}}const a=e=>new o(e)},27429:(e,t,s)=>{s.d(t,{y:()=>i});class i{constructor(){this.observers=new Set}observe(e){this.observers.add(e);const t=this;return{renew(){t.observers.add(e)},cancel(){t.removeObserver(e)}}}removeObserver(e){this.observers.delete(e)}notify(){for(const e of this.observers)e.notify()}}},15404:(e,t,s)=>{var i;s.d(t,{p:()=>i}),function(e){e.BLURS="blurs",e.BLUR_SUGGESTIONS="blur-suggestions",e.FLOORS="floors",e.HIGHLIGHTS="highlights",e.LABELS="labels",e.MATTERTAGS="mattertags",e.MEASUREMENTS="measurements",e.NOTES="notes",e.OBJECT_ANNOTATIONS="objectAnnotations",e.ORDERED_LISTS="orderedLists",e.PHOTOS="photos",e.PLUGINS="plugins",e.SETTINGS="settings",e.START_LOCATION="startlocation",e.SWEEPS="sweeps",e.LAYERS="layers",e.ROOM_BOUNDS="room_bounds"}(i||(i={}))},31498:(e,t,s)=>{s.d(t,{T:()=>i});class i{constructor(e){this.config=e}serialize(e){const{serializer:t}=this.config;if(!e||!t)return null;const s={};for(const i in e){const n=t.serialize(e[i]);n&&(s[i]=n)}return s}deserialize(e){const{deserializer:t}=this.config;if(!e||!t)return{};const s={};for(const i in e){const n=t.deserialize(e[i]);n&&(s[i]=n)}return s}}},81698:(e,t,s)=>{s.d(t,{n:()=>i});class i{constructor(e){this.config=e}serialize(e){const{serializer:t}=this.config;if(!e||!Array.isArray(e)||!t)return null;const s=[];for(const i of e){const e=t.serialize(i);e&&s.push(e)}return s}deserialize(e){const{deserializer:t}=this.config;if(!e||!Array.isArray(e)||!t)return null;const s=[];for(const i of e){const e=t.deserialize(i);e&&s.push(e)}return s}}},68986:(e,t,s)=>{s.d(t,{P:()=>i});class i{constructor(...e){this.subs=e}renew(){for(const e of this.subs)e.renew()}cancel(){for(const e of this.subs)e.cancel()}}},3066:(e,t,s)=>{s.d(t,{Sh:()=>a,WC:()=>n,wv:()=>r});const i=new(s(24241).Vy)("Subscription");class n{constructor(e,t,s){this.watchedData=e,this.registerSubscription=t,this.unregisterSubscription=s}createSubscription(e,t){return new o((()=>this.registerSubscription(e)),(()=>this.unregisterSubscription(e)),t)}getData(){return this.watchedData()}}class r{constructor(e,t,s,i){this.collection=e,this.itemProperty=t,this.subscribeFcn=s,this.unsubcribeFcn=i}createSubscription(e,t){const s=[],i=new o((()=>{for(const t of this.collection){const i=()=>e(t,this.itemProperty);s.push(i),this.subscribeFcn(t,i)}}),(()=>{let e=0;for(const t of this.collection)this.unsubcribeFcn(t,s[e]),e++}),t);return this.collection.hasOwnProperty("isObservable")?(this.collection.onElementChanged({onAdded:t=>{s.push((()=>e(t,this.itemProperty))),i.active&&this.subscribeFcn(t,s[s.length-1])},onRemoved:e=>{let t=0;for(const s of this.collection){if(s===e)break;t++}this.unsubcribeFcn(e,s[t]),s.splice(t,1)}}),i):i}getData(){return this.collection}}class o{constructor(e,t,s=!1,i=""){this.startSubscription=e,this.endSubscription=t,this.id=i,this.isSubbed=!1,s&&this.renew()}renew(){this.isSubbed?i.debugWarn(`Duplicate subscription renew ${this.id}`):(this.startSubscription(),this.isSubbed=!0)}cancel(){this.isSubbed&&(this.endSubscription(),this.isSubbed=!1)}get active(){return this.isSubbed}}function a(e,t,s=!0,i=""){return new o(e,t,s,i)}},74597:(e,t,s)=>{s.d(t,{w:()=>i});class i{constructor(e,t,s,i){this.target=e,this.type=t,this.listener=s,this.options=i,this.renew()}renew(){this.target.addEventListener(this.type,this.listener,this.options)}cancel(){this.target.removeEventListener(this.type,this.listener,this.options)}}},47087:(e,t,s)=>{s.d(t,{_:()=>o,a:()=>n});var i,n,r=s(3066);!function(e){e[e.ADDED=0]="ADDED",e[e.REMOVED=1]="REMOVED",e[e.UPDATED=2]="UPDATED",e[e.COUNT=3]="COUNT"}(i||(i={})),function(e){e[e.ADDED=1]="ADDED",e[e.REMOVED=2]="REMOVED",e[e.UPDATED=4]="UPDATED",e[e.ALL=7]="ALL"}(n||(n={}));const o=(e,t)=>{const s=t&n.ADDED,i=t&n.REMOVED,o=t&n.UPDATED,a={};let c;return new r.WC((()=>e),(t=>c=e.onElementChanged((e=>(a.onAdded=s?e:void 0,a.onRemoved=i?e:void 0,a.onUpdated=o?e:void 0,a))(t))),(e=>{c&&c.cancel()}))}},53820:(e,t,s)=>{s.d(t,{$:()=>i});class i{constructor(e){this.map=new Map,e.forEach((e=>this.map.set(e.state,e.subs)))}renew(e){(this.map.get(e)||[]).forEach((e=>e.renew()))}cancel(e){if(e){(this.map.get(e)||[]).forEach((e=>e.cancel()))}else this.map.forEach((e=>e.forEach((e=>e.cancel()))))}update(e,t){this.map.set(e,t)}}},10162:(e,t,s)=>{if(s.d(t,{i_:()=>n}),5602==s.j)var i=s(3066);const n=(e,t)=>new i.wv(e,t,((e,s)=>e.onPropertyChanged(t,s)),((e,s)=>e.removeOnPropertyChanged(t,s)))},85826:(e,t,s)=>{s.d(t,{f:()=>n});var i=s(3066);function n(e,t=16){let s;const n=(0,i.Sh)((()=>s=window.setInterval((()=>e()),t)),(()=>{s&&clearInterval(s)}));return n.cancel(),n}},3350:(e,t,s)=>{s.d(t,{C:()=>i});class i{constructor(e){this.size=e,this.index=0,this.count=0,this.buffer=[],this.sorted=!1,this.buffer=new Array(e)}push(e){this.buffer[this.index]=e,this.index=(this.index+1)%this.size,this.count++,this.sorted=!1}get topIndex(){return 0===this.index?this.size-1:this.index-1}pop(){if(this.count>0){const e=this.peek();return this.count--,0===this.index?this.index=this.size-1:this.index--,e}return null}peek(){return this.isEmpty()?null:this.buffer[this.topIndex]}isEmpty(){return 0===this.count}getList(){return this.count>=this.size?this.buffer:this.buffer.slice(0,this.count)}median(){const e=Math.floor(this.count/2),t=this.getList();return this.sorted||(t.sort(),t===this.buffer&&(this.sorted=!0)),t[e]}*[Symbol.iterator](){yield*this.buffer}clear(){this.count=0,this.index=0}}},21440:(e,t,s)=>{s.d(t,{Nz:()=>i,vq:()=>n});const i=(e,t)=>{if(0===e.length)return!1;let s=!1;for(let i=0;i<e.length;i++){e[i]===t&&(e.splice(i,1),s=!0)}return s};const n=(e=[],t=[])=>e.length===t.length&&(e=e.slice().sort(),t=t.slice().sort(),e.every(((e,s)=>t[s]===e)))},79070:(e,t,s)=>{s.d(t,{s:()=>i});const i=(e,t=250)=>{let s;return(...i)=>{window.clearTimeout(s),s=window.setTimeout((()=>e.apply(null,i)),t)}}},85609:(e,t,s)=>{s.d(t,{U:()=>r});var i=s(96540);if(5602==s.j)var n=s(24241);const r=e=>{const[t]=(0,i.useState)((()=>new n.Ay(e)));return t}},28913:(e,t,s)=>{s.d(t,{A4:()=>n,E7:()=>a,Et:()=>c,bB:()=>o,h1:()=>r});const i=e=>"propertyObservers"===e||"changeObservers"===e||"isObservable"===e||"childChangeFunctions"===e||"isObservableProxy"===e||"diffRoot"===e||"elementChangedHandlers"===e||"knownKeysMap"===e||"knownKeysList"===e||"isVector2"===e||"isVector3"===e||"isQuaternion"===e||"onPropertyChanged"===e||"removeOnPropertyChanged"===e||"onChanged"===e||"target"===e,n=(e,t=[])=>{if(void 0!==e){if(t.includes(e))return Array.isArray(e)||ArrayBuffer.isView(e)?[]:{};if(e instanceof Date)return new Date(e);if(null===e)return null;if(e.deepCopy)return e.deepCopy();if(e.isQuaternion)return{x:e.x,y:e.y,z:e.z,w:e.w};if(ArrayBuffer.isView(e))for(const t of[Float32Array,Float64Array,Int8Array,Int16Array,Int32Array,Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array])if(e instanceof t)return new t(e);if("object"==typeof e){const s=Array.isArray(e)||ArrayBuffer.isView(e)?[]:{};for(const r in e){if(i(r))continue;const o=e[r];o instanceof Date?s[r]=new Date(o):"function"!=typeof o&&(t.push(e),s[r]="object"==typeof o?n(o,t):o,t.pop())}return s}return e}},r=(e,t)=>{for(const s in t){if("function"==typeof t[s])continue;if(i(s)&&!e.hasOwnProperty(s))continue;const o=t[s];if(e.hasOwnProperty(s)){const t=e[s];(null===t?null:typeof t)!==(null===o?null:typeof o)?e[s]=n(o):"object"==typeof t?t instanceof Date?e[s]=new Date(o):r(t,o):e[s]=o}else e[s]=n(o)}},o=(e,t,s=!1)=>{const i={};for(const n in e){const r=e[n],c=t[n];a(r,c)&&(void 0===r||void 0===c||typeof r!=typeof c||"object"!=typeof r?i[n]=c:Array.isArray(c)?a(r,c)&&(i[n]=c):i[n]=s?c:o(r,c))}for(const s in t)s in e||(i[s]=t[s]);return i},a=(e,t)=>{if(null===e||"object"!=typeof e)return e!==t;if(!t)return!0;for(const s in t)if(!(s in e))return!0;for(const s in e)if(a(e[s],t[s]))return!0;return!1};function c(e){return"number"==typeof e}},84757:(e,t,s)=>{s.d(t,{lk:()=>r,zM:()=>n});const i=new(s(24241).Vy)("util-browser"),n=function(e,t){if(!("localStorage"in window))return t;let s;try{s=window.localStorage.getItem(e)}catch(e){return i.debug(e),t}return null===s?t:"boolean"==typeof t?"true"===s:"number"==typeof t?parseFloat(s):s},r=function(e,t){try{window.localStorage.setItem(e,t)}catch(e){i.error(e)}}},24241:(e,t,s)=>{s.d(t,{Ay:()=>a,Vy:()=>o});const i=window.navigationStart||Date.now(),n=new WeakMap;var r;!function(e){e[e.ERROR=0]="ERROR",e[e.WARN=1]="WARN",e[e.INFO=2]="INFO",e[e.DEBUG=3]="DEBUG"}(r||(r={}));class o{static for(e){let t=n.get(e);if(!t){const s=e.name||e.constructor.name;t=new o(s),n.set(e,t)}return t}constructor(e){this.timers={},this.handlers={[r.DEBUG]:console.debug,[r.INFO]:console.info,[r.WARN]:console.warn,[r.ERROR]:console.error};const t=e.split(new RegExp("/|\\\\"));this.prefix="["+t[t.length-1].replace(".js","")+"]"}message(e){if(o.level>=e&&console){return(this.handlers[e]?this.handlers[e]:console.log).bind(console,this.getPrefix())}return()=>{}}get debug(){return this.message(r.DEBUG)}get devInfo(){return()=>{}}get debugInfo(){return this.debug}get warnError(){return this.warn}get debugWarn(){return this.message(o.level>=r.DEBUG?r.WARN:r.DEBUG)}get info(){return this.message(r.INFO)}get warn(){return this.message(r.WARN)}get error(){return this.message(r.ERROR)}get assert(){return(e,...t)=>{if(e)return;const s="Assertion failed";0===t.length?t=[s]:"string"==typeof t[0]?t[0]=s+": "+t[0]:t.unshift(s);this.message(r.ERROR)(...t)}}time(e){o.level>=r.DEBUG&&(this.timers[e]=Date.now())}timeEnd(e){if(o.level>=r.DEBUG){const t=this.timers[e];if(!t)return;const s=(Date.now()-t)/1e3;this.debug(e,s+"s")}}getPrefix(){const e=(Date.now()-i)/1e3+"s";return`${this.prefix} ${e}`}}o.level=r.INFO;const a=o},29819:(e,t,s)=>{s.d(t,{F:()=>a});var i=s(10843),n=s(42120);const r=10,o=3e3,a=(e,t={})=>{const s=new i.Ay("poller"),{maxRetries:a=r,minDelay:c=o}=t,h=performance.now();let d,l,u=0,p=!0,g=!1,f="";const m=async()=>{let t;u+=1;try{t=await e()}catch(e){throw l=e,e}return void 0!==t?t:(c&&await(0,n.c)(c),p&&u<a?(s.debug(`polling for changes (${u}/${a})`),m()):void 0)};return{promise:m().finally((()=>{s.debug(`polling ended in ${u}/${a} attempts`),d=performance.now(),p=!1})),cancel:e=>{p=!1,g=!0,f=e||""},error:()=>l,isPolling:()=>p,isCanceled:()=>g,isCanceledReason:()=>f,retries:()=>u,elapsed:()=>Math.round((d||performance.now())-h)}}},75778:(e,t,s)=>{function i(){const e=new URLSearchParams(window.location.search),t={};return e.forEach(((e,s)=>{t[s]=e})),t}function n(){const e=new URLSearchParams(window.location.search);return new URLSearchParams(e.toString())}function r(e,t=null,s=typeof t){return a(new URLSearchParams(window.location.search).get(e),t,s)}function o(e,t,s){const i=new URL(e),n=new URLSearchParams(i.search);return n.set(t,s),i.search=n.toString(),i.toString()}function a(e,t=null,s=typeof t){return null===e?t:"boolean"===s?"true"===e||"1"===e:"number"===s?+e:e}s.d(t,{DE:()=>n,EN:()=>i,P3:()=>r,R5:()=>a,SS:()=>h,_0:()=>c,ir:()=>o});const c=e=>{if(!e)return;const t=`${window.location.origin}${window.location.pathname}?${e}`;window.location.replace(t)},h=(e,t=!0)=>{if(!e)return;const s=`${window.location.origin}${window.location.pathname}?${e}`;t?window.history.pushState({},"",s):window.history.replaceState({},"",s)}},96824:(e,t,s)=>{s.d(t,{e:()=>n});const i=[];for(let e=0;e<256;e++)i[e]=(e<16?"0":"")+e.toString(16);function n(){let e;const t=window.crypto||window.msCrypto;return e=t?t.getRandomValues(new Uint8Array(16)):new Uint8Array(16).map((()=>255*Math.random())),e[6]=15&e[6]|64,e[8]=63&e[8]|128,i[e[0]]+i[e[1]]+i[e[2]]+i[e[3]]+"-"+i[e[4]]+i[e[5]]+"-"+i[e[6]]+i[e[7]]+"-"+i[e[8]]+i[e[9]]+"-"+i[e[10]]+i[e[11]]+i[e[12]]+i[e[13]]+i[e[14]]+i[e[15]]}}}]);