(self.webpackChunkmp_webgl=self.webpackChunkmp_webgl||[]).push([[235],{93327:(e,i,n)=>{var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetHighlightReel"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"activeHighlightReel"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"HighlightReelDetails"},directives:[]}]}}]}}]}},{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetHighlightReelForView"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"viewType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"view"},arguments:[{kind:"Argument",name:{kind:"Name",value:"type"},value:{kind:"Variable",name:{kind:"Name",value:"viewType"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeHighlightReel"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"HighlightReelDetails"},directives:[]}]}}]}}]}}]}}]}},{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetHighlightReelSweeps"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"views"},arguments:[{kind:"Argument",name:{kind:"Name",value:"types"},value:{kind:"ListValue",values:[{kind:"StringValue",value:"matterport.model.default",block:!1},{kind:"StringValue",value:"matterport.model.layered",block:!1},{kind:"StringValue",value:"matterport.user.view",block:!1},{kind:"StringValue",value:"matterport.model.defurnished",block:!1}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"model"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeHighlightReel"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"reel"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sourceView"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"asset"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Photo"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"snapshotLocation"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"viewMode"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"anchor"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tags"},arguments:[],directives:[]}]}}]}}]}}]}}]}}]}}]}}]}}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"PutActiveReel"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"elements"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ReelElementInput"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mode"}},type:{kind:"NamedType",name:{kind:"Name",value:"HighlightReelMode"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"putActiveReel"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"elements"},value:{kind:"Variable",name:{kind:"Name",value:"elements"}}},{kind:"Argument",name:{kind:"Name",value:"mode"},value:{kind:"Variable",name:{kind:"Name",value:"mode"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"HighlightReelDetails"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"HighlightReel"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"mode"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reel"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sourceView"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"overrides"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"transitionType"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"panDirection"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"panAngle"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"asset"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"PhotoDetails"},directives:[]}]}}]}}]}}],loc:{start:0,end:1554}};t.loc.source={body:'#import "./photo-fragments.gql"\n\nquery GetHighlightReel($modelId: ID!) {\n  model(id: $modelId) {\n    id\n    activeHighlightReel {\n      ...HighlightReelDetails\n    }\n  }\n}\n\nquery GetHighlightReelForView($modelId: ID!, $viewType: ID!) {\n  model(id: $modelId) {\n    id\n    view(type: $viewType) {\n      model {\n        activeHighlightReel {\n          ...HighlightReelDetails\n        }\n      }\n    }\n  }\n}\n\nquery GetHighlightReelSweeps($modelId: ID!) {\n  model(id: $modelId) {\n    views(types: ["matterport.model.default", "matterport.model.layered", "matterport.user.view", "matterport.model.defurnished"]) {\n      id\n      model {\n      \tactiveHighlightReel { \n          reel {\n            sourceView {\n              id\n            }\n            asset {\n              ... on Photo {\n                label\n              \tsnapshotLocation {\n                  viewMode\n                  anchor {\n                    id\n                    tags # only valid if visible\n                  }\n                }\n              }                          \n            }\n          }\n        }\n      }\n    }\n  }\n}\n\nmutation PutActiveReel($modelId: ID!, $elements: [ReelElementInput!], $mode: HighlightReelMode) {\n  putActiveReel(modelId: $modelId, elements: $elements, mode: $mode) {\n    id\n  }\n}\n\nfragment HighlightReelDetails on HighlightReel {\n  id\n  label\n  mode\n  reel {\n    title\n    description\n    sourceView {\n      id\n      type\n    }\n    overrides {\n      transitionType\n      panDirection\n      panAngle\n    }\n    asset {\n      ...PhotoDetails\n    }\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var a={};function l(e,i){if("FragmentSpread"===e.kind)i.add(e.name.value);else if("VariableDefinition"===e.kind){var n=e.type;"NamedType"===n.kind&&i.add(n.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){l(e,i)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){l(e,i)})),e.definitions&&e.definitions.forEach((function(e){l(e,i)}))}t.definitions=t.definitions.concat(n(10600).definitions.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var i=e.name.value;return!a[i]&&(a[i]=!0,!0)})));var d={};function o(e,i){for(var n=0;n<e.definitions.length;n++){var t=e.definitions[n];if(t.name&&t.name.value==i)return t}}function r(e,i){var n={kind:e.kind,definitions:[o(e,i)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var t=d[i]||new Set,a=new Set,l=new Set;for(t.forEach((function(e){l.add(e)}));l.size>0;){var r=l;l=new Set,r.forEach((function(e){a.has(e)||(a.add(e),(d[e]||new Set).forEach((function(e){l.add(e)})))}))}return a.forEach((function(i){var t=o(e,i);t&&n.definitions.push(t)})),n}t.definitions.forEach((function(e){if(e.name){var i=new Set;l(e,i),d[e.name.value]=i}})),e.exports=t,e.exports.GetHighlightReel=r(t,"GetHighlightReel"),e.exports.GetHighlightReelForView=r(t,"GetHighlightReelForView"),e.exports.GetHighlightReelSweeps=r(t,"GetHighlightReelSweeps"),e.exports.PutActiveReel=r(t,"PutActiveReel"),e.exports.HighlightReelDetails=r(t,"HighlightReelDetails")},28404:(e,i,n)=>{"use strict";n.d(i,{F:()=>l});var t=n(85616),a=n(66416);class l extends t.v{constructor(){super(),this.category=a.X.USER}get aspectRatio(){return this.width/this.height}clone(){return(new l).copy(this)}copy(e){return this.sid=e.sid,this.sourceViewId=e.sourceViewId,this.thumbnailUrl=e.thumbnailUrl,this.imageUrl=e.imageUrl,this.downloadUrl=e.downloadUrl,this.name=e.name,this.label=e.label,this.is360=e.is360,this.category=e.category,this.height=e.height,this.width=e.width,this.created=e.created,this.modified=e.modified,this.visionLabel=e.visionLabel,this.visionName=e.visionName,this.imageBlob=e.imageBlob,this.metadata={cameraMode:e.metadata.cameraMode,cameraPosition:e.metadata.cameraPosition.clone(),cameraQuaternion:e.metadata.cameraQuaternion.clone(),scanId:e.metadata.scanId,orthoZoom:e.metadata.orthoZoom,ssZoom:e.metadata.ssZoom,floorId:e.metadata.floorId,floorVisibility:e.metadata.floorVisibility,scanTags:e.metadata.scanTags},this.commit(),this}refresh(e){this.thumbnailUrl.refreshFrom(e.thumbnailUrl),this.imageUrl.refreshFrom(e.imageUrl),this.downloadUrl.refreshFrom(e.downloadUrl)}}},72853:(e,i,n)=>{"use strict";n.d(i,{S:()=>v});var t=n(68909),a=n(2993),l=n(10843),d=n(86866),o=n(81587),r=n(28404),s=n(66416),m=n(2803),c=n(74381);const u=new l.Ay("mds-snapshot-deserializer");class v{constructor(){}deserialize(e){var i,n,l,v,k,h;if(!e||!this.validate(e))return u.debug("Deserialized invalid Snapshot data from MDS",e),null;const g=new r.F;g.sid=e.id,g.thumbnailUrl=new m.f(e.thumbnailUrl||"",(0,o.X)(e.validUntil,null)),g.imageUrl=new m.f(e.presentationUrl||"",(0,o.X)(e.validUntil,null)),g.downloadUrl=new m.f(e.downloadUrl||"",(0,o.X)(e.validUntil,null)),g.category=this.getCwfSnapshotCategory(e)||s.X.USER,g.width=e.width||0,g.height=e.height||0,g.created=(0,o.X)(e.created),g.modified=(0,o.X)(e.modified),g.visionLabel=e.classification||"",g.sourceViewId=null===(i=e.model)||void 0===i?void 0:i.id,g.label=e.label||"",g.name=g.label,g.name=g.name.replace("_defurnished",""),g.name=g.name.replace(/([0-9.]+_[0-9.]+_?)(.*)?$/,"$2");const p=null===(v=null===(l=null===(n=e.snapshotLocation)||void 0===n?void 0:n.anchor)||void 0===l?void 0:l.pano)||void 0===v?void 0:v.placement;g.is360=!(!p||p===c.$h.AUTO);const{snapshotLocation:N}=e;if(N){const e=N.position?d.U$.fromVisionVector(N.position):new t.Vector3,i=N.rotation?d.U$.fromVisionCameraQuaternion(N.rotation):new t.Quaternion,n=this.getCwfViewmode(N.viewMode)||a.N3.Panorama,l=[];for(const e of N.floorVisibility||[]){for(let i=0;i<e.sequence;i++)l[i]=l[i]||0;l[e.sequence]=1}g.metadata={cameraMode:n,cameraPosition:e,cameraQuaternion:i,scanId:N.anchor&&N.anchor.id||"",orthoZoom:n===a.N3.Floorplan&&null!==(k=N.zoom)&&void 0!==k?k:-1,ssZoom:N.zoom||1,floorId:N.floorVisibility&&N.floorVisibility.length>0?N.floorVisibility[0].id:null,floorVisibility:l,scanTags:(null===(h=N.anchor)||void 0===h?void 0:h.tags)||null}}return g}validate(e){var i;if(!(null===(i=e.snapshotLocation)||void 0===i?void 0:i.position))return!1;const n=["id","snapshotLocation","thumbnailUrl","presentationUrl"].every((i=>i in e)),t=null!==this.getCwfSnapshotCategory(e);return n&&t}getCwfViewmode(e){const i={[c.nE.DOLLHOUSE]:a.N3.Dollhouse,[c.nE.PANORAMA]:a.N3.Panorama,[c.nE.FLOORPLAN]:a.N3.Floorplan,[c.nE.MESH]:a.N3.Panorama};return e&&e in i?i[e]:null}getCwfSnapshotCategory(e){var i,n,t;if(e.category===c.hL.TOUR)return s.X.TOUR;if(e.origin===c.pu.VISION)return s.X.AUTO;if(e.type===c.xx.EQUIRECTANGULAR)return s.X.PANORAMA;const a=null===(t=null===(n=null===(i=e.snapshotLocation)||void 0===i?void 0:i.anchor)||void 0===n?void 0:n.pano)||void 0===t?void 0:t.placement;return e.type===c.xx.PHOTO2D?a===c.$h.MANUAL?s.X.UNALIGNED:s.X.USER:null}}}}]);