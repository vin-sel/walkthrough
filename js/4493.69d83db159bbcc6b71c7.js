/*! For license information please see 4493.69d83db159bbcc6b71c7.js.LICENSE.txt */
(self.webpackChunkmp_webgl=self.webpackChunkmp_webgl||[]).push([[4493],{44704:(e,t,n)=>{"use strict";n(48755)},48755:(e,t,n)=>{"use strict";n.r(t)},44476:()=>{},46313:()=>{},10202:()=>{},99370:()=>{},93607:(e,t,n)=>{var s;!function(i,o){var r={};function a(e){return function(){var t={method:e},n=Array.prototype.slice.call(arguments);/^get/.test(e)?(r.assert(n.length>0,"Get methods require a callback."),n.unshift(t)):(/^set/.test(e)&&(r.assert(0!==n.length,"Set methods require a value."),t.value=n[0]),n=[t]),this.send.apply(this,n)}}r.DEBUG=!1,r.VERSION="0.0.11",r.CONTEXT="player.js",r.POST_MESSAGE=!!i.postMessage,r.origin=function(e){return"//"===e.substr(0,2)&&(e=i.location.protocol+e),e.split("/").slice(0,3).join("/")},r.addEvent=function(e,t,n){e&&(e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n)},r.log=function(){r.log.history=r.log.history||[],r.log.history.push(arguments),i.console&&r.DEBUG&&i.console.log(Array.prototype.slice.call(arguments))},r.isString=function(e){return"[object String]"===Object.prototype.toString.call(e)},r.isObject=function(e){return"[object Object]"===Object.prototype.toString.call(e)},r.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},r.isNone=function(e){return null==e},r.has=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.indexOf=function(e,t){if(null==e)return-1;var n=0,s=e.length;if(Array.prototype.IndexOf&&e.indexOf===Array.prototype.IndexOf)return e.indexOf(t);for(;n<s;n++)if(e[n]===t)return n;return-1},r.assert=function(e,t){if(!e)throw t||"Player.js Assert Failed"},r.Keeper=function(){this.init()},r.Keeper.prototype.init=function(){this.data={}},r.Keeper.prototype.getUUID=function(){return"listener-xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},r.Keeper.prototype.has=function(e,t){if(!this.data.hasOwnProperty(e))return!1;if(r.isNone(t))return!0;for(var n=this.data[e],s=0;s<n.length;s++)if(n[s].id===t)return!0;return!1},r.Keeper.prototype.add=function(e,t,n,s,i){var o={id:e,event:t,cb:n,ctx:s,one:i};this.has(t)?this.data[t].push(o):this.data[t]=[o]},r.Keeper.prototype.execute=function(e,t,n,s){if(!this.has(e,t))return!1;for(var i=[],o=[],a=0;a<this.data[e].length;a++){var c=this.data[e][a];r.isNone(t)||!r.isNone(t)&&c.id===t?(o.push({cb:c.cb,ctx:c.ctx?c.ctx:s,data:n}),!1===c.one&&i.push(c)):i.push(c)}0===i.length?delete this.data[e]:this.data[e]=i;for(var l=0;l<o.length;l++){var d=o[l];d.cb.call(d.ctx,d.data)}},r.Keeper.prototype.on=function(e,t,n,s){this.add(e,t,n,s,!1)},r.Keeper.prototype.one=function(e,t,n,s){this.add(e,t,n,s,!0)},r.Keeper.prototype.off=function(e,t){var n=[];if(!this.data.hasOwnProperty(e))return n;for(var s=[],i=0;i<this.data[e].length;i++){var o=this.data[e][i];r.isNone(t)||o.cb===t?r.isNone(o.id)||n.push(o.id):s.push(o)}return 0===s.length?delete this.data[e]:this.data[e]=s,n},r.Player=function(e,t){if(!(this instanceof r.Player))return new r.Player(e,t);this.init(e,t)},r.EVENTS={READY:"ready",PLAY:"play",PAUSE:"pause",ENDED:"ended",TIMEUPDATE:"timeupdate",PROGRESS:"progress",ERROR:"error"},r.EVENTS.all=function(){var e=[];for(var t in r.EVENTS)r.has(r.EVENTS,t)&&r.isString(r.EVENTS[t])&&e.push(r.EVENTS[t]);return e},r.METHODS={PLAY:"play",PAUSE:"pause",GETPAUSED:"getPaused",MUTE:"mute",UNMUTE:"unmute",GETMUTED:"getMuted",SETVOLUME:"setVolume",GETVOLUME:"getVolume",GETDURATION:"getDuration",SETCURRENTTIME:"setCurrentTime",GETCURRENTTIME:"getCurrentTime",SETLOOP:"setLoop",GETLOOP:"getLoop",REMOVEEVENTLISTENER:"removeEventListener",ADDEVENTLISTENER:"addEventListener"},r.METHODS.all=function(){var e=[];for(var t in r.METHODS)r.has(r.METHODS,t)&&r.isString(r.METHODS[t])&&e.push(r.METHODS[t]);return e},r.READIED=[],r.Player.prototype.init=function(e,t){var n=this;r.isString(e)&&(e=o.getElementById(e)),this.elem=e,r.assert("IFRAME"===e.nodeName,'playerjs.Player constructor requires an Iframe, got "'+e.nodeName+'"'),r.assert(e.src,"playerjs.Player constructor requires a Iframe with a 'src' attribute."),this.origin=r.origin(e.src),this.keeper=new r.Keeper,this.isReady=!1,this.queue=[],this.events=r.EVENTS.all(),this.methods=r.METHODS.all(),r.POST_MESSAGE?r.addEvent(i,"message",(function(e){n.receive(e)})):r.log("Post Message is not Available."),r.indexOf(r.READIED,e.src)>-1?n.loaded=!0:this.elem.onload=function(){n.loaded=!0}},r.Player.prototype.send=function(e,t,n){if(e.context=r.CONTEXT,e.version=r.VERSION,t){var s=this.keeper.getUUID();e.listener=s,this.keeper.one(s,e.method,t,n)}return this.isReady||"ready"===e.value?(r.log("Player.send",e,this.origin),!0===this.loaded&&this.elem.contentWindow.postMessage(JSON.stringify(e),this.origin),!0):(r.log("Player.queue",e),this.queue.push(e),!1)},r.Player.prototype.receive=function(e){if(r.log("Player.receive",e),e.origin!==this.origin)return!1;var t;try{t=JSON.parse(e.data)}catch(e){return!1}if(t.context!==r.CONTEXT)return!1;"ready"===t.event&&t.value&&t.value.src===this.elem.src&&this.ready(t),this.keeper.has(t.event,t.listener)&&this.keeper.execute(t.event,t.listener,t.value,this)},r.Player.prototype.ready=function(e){if(!0===this.isReady)return!1;e.value.events&&(this.events=e.value.events),e.value.methods&&(this.methods=e.value.methods),this.isReady=!0,this.loaded=!0;for(var t=0;t<this.queue.length;t++){var n=this.queue[t];r.log("Player.dequeue",n),"ready"===e.event&&this.keeper.execute(n.event,n.listener,!0,this),this.send(n)}this.queue=[]},r.Player.prototype.on=function(e,t,n){var s=this.keeper.getUUID();return"ready"===e?this.keeper.one(s,e,t,n):this.keeper.on(s,e,t,n),this.send({method:"addEventListener",value:e,listener:s}),!0},r.Player.prototype.off=function(e,t){var n=this.keeper.off(e,t);if(r.log("Player.off",n),n.length>0)for(var s in n)return this.send({method:"removeEventListener",value:e,listener:n[s]}),!0;return!1},r.Player.prototype.supports=function(e,t){r.assert(r.indexOf(["method","event"],e)>-1,'evtOrMethod needs to be either "event" or "method" got '+e),t=r.isArray(t)?t:[t];for(var n="event"===e?this.events:this.methods,s=0;s<t.length;s++)if(-1===r.indexOf(n,t[s]))return!1;return!0};for(var c=0,l=r.METHODS.all().length;c<l;c++){var d=r.METHODS.all()[c];r.Player.prototype.hasOwnProperty(d)||(r.Player.prototype[d]=a(d))}r.addEvent(i,"message",(function(e){var t;try{t=JSON.parse(e.data)}catch(e){return!1}if(t.context!==r.CONTEXT)return!1;"ready"===t.event&&t.value&&t.value.src&&r.READIED.push(t.value.src)})),r.Receiver=function(e,t){this.init(e,t)},r.Receiver.prototype.init=function(e,t){var n=this;this.isReady=!1,this.origin=r.origin(o.referrer),this.methods={},this.supported={events:e||r.EVENTS.all(),methods:t||r.METHODS.all()},this.eventListeners={},this.reject=!(i.self!==i.top&&r.POST_MESSAGE),this.reject||r.addEvent(i,"message",(function(e){n.receive(e)}))},r.Receiver.prototype.receive=function(e){if(e.origin!==this.origin)return!1;var t={};if(r.isObject(e.data))t=e.data;else try{t=i.JSON.parse(e.data)}catch(e){r.log("JSON Parse Error",e)}if(r.log("Receiver.receive",e,t),!t.method)return!1;if(t.context!==r.CONTEXT)return!1;if(-1===r.indexOf(r.METHODS.all(),t.method))return this.emit("error",{code:2,msg:'Invalid Method "'+t.method+'"'}),!1;var n=r.isNone(t.listener)?null:t.listener;if("addEventListener"===t.method)this.eventListeners.hasOwnProperty(t.value)?-1===r.indexOf(this.eventListeners[t.value],n)&&this.eventListeners[t.value].push(n):this.eventListeners[t.value]=[n],"ready"===t.value&&this.isReady&&this.ready();else if("removeEventListener"===t.method){if(this.eventListeners.hasOwnProperty(t.value)){var s=r.indexOf(this.eventListeners[t.value],n);s>-1&&this.eventListeners[t.value].splice(s,1),0===this.eventListeners[t.value].length&&delete this.eventListeners[t.value]}}else this.get(t.method,t.value,n)},r.Receiver.prototype.get=function(e,t,n){var s=this;if(!this.methods.hasOwnProperty(e))return this.emit("error",{code:3,msg:'Method Not Supported"'+e+'"'}),!1;var i=this.methods[e];if("get"===e.substr(0,3)){i.call(this,(function(t){s.send(e,t,n)}))}else i.call(this,t)},r.Receiver.prototype.on=function(e,t){this.methods[e]=t},r.Receiver.prototype.send=function(e,t,n){if(r.log("Receiver.send",e,t,n),this.reject)return r.log("Receiver.send.reject",e,t,n),!1;var s={context:r.CONTEXT,version:r.VERSION,event:e};r.isNone(t)||(s.value=t),r.isNone(n)||(s.listener=n);var o=JSON.stringify(s);i.parent.postMessage(o,""===this.origin?"*":this.origin)},r.Receiver.prototype.emit=function(e,t){if(!this.eventListeners.hasOwnProperty(e))return!1;r.log("Instance.emit",e,t,this.eventListeners[e]);for(var n=0;n<this.eventListeners[e].length;n++){var s=this.eventListeners[e][n];this.send(e,t,s)}return!0},r.Receiver.prototype.ready=function(){r.log("Receiver.ready"),this.isReady=!0;var e={src:i.location.toString(),events:this.supported.events,methods:this.supported.methods};this.emit("ready",e)||this.send("ready",e)},r.HTML5Adapter=function(e){if(!(this instanceof r.HTML5Adapter))return new r.HTML5Adapter(e);this.init(e)},r.HTML5Adapter.prototype.init=function(e){r.assert(e,"playerjs.HTML5Adapter requires a video element");var t=this.receiver=new r.Receiver;e.addEventListener("playing",(function(){t.emit("play")})),e.addEventListener("pause",(function(){t.emit("pause")})),e.addEventListener("ended",(function(){t.emit("ended")})),e.addEventListener("timeupdate",(function(){t.emit("timeupdate",{seconds:e.currentTime,duration:e.duration})})),e.addEventListener("progress",(function(){t.emit("buffered",{percent:e.buffered.length})})),t.on("play",(function(){e.play()})),t.on("pause",(function(){e.pause()})),t.on("getPaused",(function(t){t(e.paused)})),t.on("getCurrentTime",(function(t){t(e.currentTime)})),t.on("setCurrentTime",(function(t){e.currentTime=t})),t.on("getDuration",(function(t){t(e.duration)})),t.on("getVolume",(function(t){t(100*e.volume)})),t.on("setVolume",(function(t){e.volume=t/100})),t.on("mute",(function(){e.muted=!0})),t.on("unmute",(function(){e.muted=!1})),t.on("getMuted",(function(t){t(e.muted)})),t.on("getLoop",(function(t){t(e.loop)})),t.on("setLoop",(function(t){e.loop=t}))},r.HTML5Adapter.prototype.ready=function(){this.receiver.ready()},r.JWPlayerAdapter=function(e){if(!(this instanceof r.JWPlayerAdapter))return new r.JWPlayerAdapter(e);this.init(e)},r.JWPlayerAdapter.prototype.init=function(e){r.assert(e,"playerjs.JWPlayerAdapter requires a player object");var t=this.receiver=new r.Receiver;this.looped=!1,e.on("pause",(function(){t.emit("pause")})),e.on("play",(function(){t.emit("play")})),e.on("time",(function(e){var n=e.position,s=e.duration;if(!n||!s)return!1;var i={seconds:n,duration:s};t.emit("timeupdate",i)}));var n=this;e.on("complete",(function(){!0===n.looped?e.seek(0):t.emit("ended")})),e.on("error",(function(){t.emit("error")})),t.on("play",(function(){e.play(!0)})),t.on("pause",(function(){e.pause(!0)})),t.on("getPaused",(function(t){t(e.getState().toLowerCase()!=="PLAYING".toLowerCase())})),t.on("getCurrentTime",(function(t){t(e.getPosition())})),t.on("setCurrentTime",(function(t){e.seek(t)})),t.on("getDuration",(function(t){t(e.getDuration())})),t.on("getVolume",(function(t){t(e.getVolume())})),t.on("setVolume",(function(t){e.setVolume(t)})),t.on("mute",(function(){e.setMute(!0)})),t.on("unmute",(function(){e.setMute(!1)})),t.on("getMuted",(function(t){t(!0===e.getMute())})),t.on("getLoop",(function(e){e(this.looped)}),this),t.on("setLoop",(function(e){this.looped=e}),this)},r.JWPlayerAdapter.prototype.ready=function(){this.receiver.ready()},r.MockAdapter=function(){if(!(this instanceof r.MockAdapter))return new r.MockAdapter;this.init()},r.MockAdapter.prototype.init=function(){var e={duration:20,currentTime:0,interval:null,timeupdate:function(){},volume:100,mute:!1,playing:!1,loop:!1,play:function(){e.interval=setInterval((function(){e.currentTime+=.25,e.timeupdate({seconds:e.currentTime,duration:e.duration})}),250),e.playing=!0},pause:function(){clearInterval(e.interval),e.playing=!1}},t=this.receiver=new r.Receiver;t.on("play",(function(){var t=this;e.play(),this.emit("play"),e.timeupdate=function(e){t.emit("timeupdate",e)}})),t.on("pause",(function(){e.pause(),this.emit("pause")})),t.on("getPaused",(function(t){t(!e.playing)})),t.on("getCurrentTime",(function(t){t(e.currentTime)})),t.on("setCurrentTime",(function(t){e.currentTime=t})),t.on("getDuration",(function(t){t(e.duration)})),t.on("getVolume",(function(t){t(e.volume)})),t.on("setVolume",(function(t){e.volume=t})),t.on("mute",(function(){e.mute=!0})),t.on("unmute",(function(){e.mute=!1})),t.on("getMuted",(function(t){t(e.mute)})),t.on("getLoop",(function(t){t(e.loop)})),t.on("setLoop",(function(t){e.loop=t}))},r.MockAdapter.prototype.ready=function(){this.receiver.ready()},r.VideoJSAdapter=function(e){if(!(this instanceof r.VideoJSAdapter))return new r.VideoJSAdapter(e);this.init(e)},r.VideoJSAdapter.prototype.init=function(e){r.assert(e,"playerjs.VideoJSReceiver requires a player object");var t=this.receiver=new r.Receiver;e.on("pause",(function(){t.emit("pause")})),e.on("play",(function(){t.emit("play")})),e.on("timeupdate",(function(n){var s=e.currentTime(),i=e.duration();if(!s||!i)return!1;var o={seconds:s,duration:i};t.emit("timeupdate",o)})),e.on("ended",(function(){t.emit("ended")})),e.on("error",(function(){t.emit("error")})),t.on("play",(function(){e.play()})),t.on("pause",(function(){e.pause()})),t.on("getPaused",(function(t){t(e.paused())})),t.on("getCurrentTime",(function(t){t(e.currentTime())})),t.on("setCurrentTime",(function(t){e.currentTime(t)})),t.on("getDuration",(function(t){t(e.duration())})),t.on("getVolume",(function(t){t(100*e.volume())})),t.on("setVolume",(function(t){e.volume(t/100)})),t.on("mute",(function(){e.volume(0)})),t.on("unmute",(function(){e.volume(1)})),t.on("getMuted",(function(t){t(0===e.volume())})),t.on("getLoop",(function(t){t(e.loop())})),t.on("setLoop",(function(t){e.loop(t)}))},r.VideoJSAdapter.prototype.ready=function(){this.receiver.ready()},void 0===(s=function(){return r}.call(t,n,t,e))||(e.exports=s)}(window,document)},84917:(e,t,n)=>{"use strict";var s;function i(e){const t=new Date;t.setHours(0,0,0,0),e.setHours(0,0,0,0);const n=(t.getTime()-e.getTime())/864e5;if(0===n)return s.TODAY;if(1===n)return s.YESTERDAY;if(n<7)return s.THIS_WEEK;const i=Math.floor(n/7);return 1===i?s.ONE_WEEK_AGO:2===i?s.TWO_WEEKS_AGO:3===i?s.THREE_WEEKS_AGO:s.OLDER}n.d(t,{T:()=>s,n:()=>i}),function(e){e.TODAY="TODAY",e.YESTERDAY="YESTERDAY",e.THIS_WEEK="THIS_WEEK",e.ONE_WEEK_AGO="ONE_WEEK_AGO",e.TWO_WEEKS_AGO="TWO_WEEKS_AGO",e.THREE_WEEKS_AGO="THREE_WEEKS_AGO",e.OLDER="OLDER"}(s||(s={}))},51831:(e,t,n)=>{"use strict";var s;n.d(t,{U:()=>s}),function(e){e.NOTE="note",e.TAG="tag",e.OBJECT="object"}(s||(s={}))},12640:(e,t,n)=>{"use strict";n.d(t,{E:()=>u});var s=n(74848),i=n(32485),o=n.n(i),r=n(46587),a=n(51831),c=n(3101),l=n(14649),d=n(14753);function u({inline:e,children:t,parentId:n,canDelete:i,nonViewable:u,attachments:h,annotationType:p,onViewAttachment:m}){const f=(0,r.Rd)(),g=(0,r.hw)(),v=(e,t)=>{m&&m(t)},E=e=>n!==e.parentId?null:(0,s.jsx)(d.P,{id:e.id,fileName:e.file.name,className:"inline",progress:e.progress,error:e.error},e.id),x=p===a.U.NOTE;return(0,s.jsxs)("div",{className:o()("annotation-attachments",{"annotation-attachments-inline":!!e,"annotation-attachments-preview":!u,"annotation-attachments-list":u}),children:[h.map(((t,n)=>{const o=h.length,r=!e&&!u&&(0,c.rV)(t)&&(1===o||0===n&&o>2);let a,d;return x&&(e?(a=60,d=60):r||(a=140,d=140)),(0,s.jsx)(l.o,{attachment:t,inline:!!e,canDelete:!!i,hero:r,onClick:v,thumbnail:!!e||!r,width:a,height:d},t.id)})),f&&f.map(E),g&&g.map(E),t]})}},73911:(e,t,n)=>{"use strict";n.d(t,{G:()=>ge});var s=n(74848),i=n(96540),o=n(32485),r=n.n(o),a=n(51831),c=n(40409),l=n(25727),d=n(74453),u=n(40936);const{UP:h,DOWN:p,LEFT:m,RIGHT:f,UP_LEFT:g,UP_RIGHT:v,DOWN_LEFT:E,DOWN_RIGHT:x}=l.DH,y=(0,i.memo)((({className:e,onClick:t,children:n})=>{const o=(0,d.S)(),[a,c]=(0,i.useState)(null),{width:l,height:y,ref:T}=(0,u.A)(),[{width:b,height:C},A]=(0,i.useState)({width:0,height:0}),{ref:S}=(0,u.A)({onResize:({width:e,height:t})=>{null===a&&A({width:e||0,height:t||0})}});let _;if((0,i.useEffect)((()=>{if(l&&y&&b&&C&&o){let e=a;const t=o.y<C,n=o.y>y-C,s=o.x<b,i=o.x>l-b;t&&n?e=i&&!s?m:f:t?e=s?x:i?E:p:n?e=s?v:i?g:h:s&&i?e=t?p:h:s?e=f:i?e=m:null===e&&(e=f),e!==a&&c(e)}}),[o,l,y,b,C,a]),l&&o){_=a===f&&o.x>l-b?l-o.x:void 0}return(0,s.jsx)("div",{ref:T,className:"annotations-preview-layer",children:o&&n&&(0,s.jsx)("div",{ref:S,className:r()("annotation-preview",`annotation-preview-${a}`,e),style:{top:o.y,left:o.x,visibility:null===a?"hidden":void 0,width:_},onClick:t,children:n})})}));var T=n(46822),b=n(78063),C=n(17904),A=n(94426),S=n(80700),_=n(80411),O=n(56147),N=n(39869),k=n(35137),w=n(54616);const{NOTES:R}=O.A.SHOWCASE;function L({comment:e,noteView:t}){const n=t?t.created:e.created,i=(0,w.P)(),o=(0,N.Y)(),r=t?t.user.email:e.user.email,a=i.getUserDisplay(r),c=a.color,l=t?t.comments.length-1:0,d=o.t(R.REPLIES,l),u=""===e.text&&!(e.attachments.length>0)?o.t(R.CONTENT_DELETED):n.toLocaleString();return(0,s.jsxs)("header",{className:"note-header",children:[(0,s.jsx)(k.E,{label:a.initials,badgeStyle:{color:c,borderColor:c}}),(0,s.jsxs)("div",{className:"note-details",children:[(0,s.jsx)("span",{className:"note-user",children:a.name}),l>0&&(0,s.jsx)("span",{className:"note-summary-info note-replies",children:d}),(0,s.jsx)("div",{className:"note-subheader",children:u})]})]})}var I=n(42242),j=n(68375);function P(e){const{attachments:t}=e,n=(0,j.s)();if(!(t.length>0))return null;return(0,s.jsx)(I.g,{attachments:t,onClick:(t,s)=>{n.trackToolGuiEvent("notes","notes_preview_click_attachment"),t.stopPropagation(),e.onClick(s)}})}var M=n(43457),D=n(29397),H=n(24865);function U({text:e,noteId:t}){const n=(0,D.V)(),i=(0,H.b)();return(0,s.jsx)("div",{className:r()("note-post",{"note-summary-info":!e}),children:e&&n&&(0,s.jsx)(M.$,{text:e,textParser:n,linkHandler:i,maxLength:150,annotationType:a.U.NOTE,annotationId:t})})}var V=n(12640);function G(e){const t=(0,N.Y)(),{moreAttachmentsCount:n}=e;if(0===n)return null;const i=t.t(O.A.SHOWCASE.ATTACHMENTS.MORE_ATTACHMENT,n);return(0,s.jsx)("div",{className:"attachment attachments-truncated",children:(0,s.jsx)("div",{className:"attachment-view attachment-other ",children:(0,s.jsx)("div",{className:"attachment-label",children:(0,s.jsx)("div",{className:"file-label",children:i})})})})}var F=n(3101),B=n(12103),W=n(71687);const{ANNOTATIONS:K}=O.A.SHOWCASE;function Y(e){const{previewId:t}=e,n=(0,i.useRef)(null),o=(0,N.Y)(),c=(0,S.e)(t),l=(0,_.Z)(t),d=(0,C.S)(W.Et);if((0,i.useEffect)((()=>(l&&n.current&&n.current.focus(),()=>{})),[l]),!l)return null;const u=l.comments.get(0),h=u&&u.attachments.length>0,p=u.attachments.values(),m=(0,F.c9)(p),f=(0,F.rg)(p),g=f.slice(0,B.p8),v=Math.max(f.length-B.p8,0),E=l.comments.length>1||v>0,x=o.t(K.READ_MORE_MESSAGE),y=r()("annotation-preview-contents","note-preview-contents",{"viewable-media":h});return(0,s.jsxs)("div",{ref:n,role:"dialog",tabIndex:0,className:y,onClick:t=>{t.stopPropagation(),e.onClick()},onKeyDown:e=>{"Escape"===e.code&&d&&(e.stopPropagation(),d.closeBillboard())},children:[u&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(P,{attachments:m,onClick:e.onClick}),(0,s.jsx)(L,{noteView:l,comment:u}),(0,s.jsx)(U,{text:u.text,noteId:t}),(0,s.jsx)(V.E,{annotationType:a.U.NOTE,attachments:g,children:(0,s.jsx)(G,{moreAttachmentsCount:v})})]}),c&&(0,s.jsxs)("div",{className:"nested-comment-preview",children:[(0,s.jsx)(L,{comment:c}),(0,s.jsx)(U,{text:c.text,noteId:t})]}),E&&(0,s.jsx)("div",{className:"link link-more",children:x})]})}var $=n(3795),z=n(39905),X=n(12460),J=n(83649),q=n(7293),Q=n(8387),Z=n(95136),ee=n(81058),te=n(38731),ne=n(90087),se=n(90683);const{TAGS:ie}=O.A.SHOWCASE;function oe(e){const{tag:t,tagType:n,capabilities:o}=e,c=(0,te.B)(),l=(0,N.Y)(),d=(0,j.s)(),u=(0,ne.L)(),h=c?l.t(ie.EDIT_TAG_LABEL):void 0,p=c?"toggle-pencil":"dock",m=c?void 0:l.t(ie.DOCK_TAG_LABEL),f=t.id,g=(0,se.a)(t.layerId),v=(0,C.S)(W.Et),E=(0,i.useCallback)((e=>{v&&(e.stopPropagation(),c&&n===a.U.OBJECT?(d.trackToolGuiEvent("object_tags","object_tags_billboard_edit_tag"),u.issueCommand(new ee.y_(f))):(d.trackToolGuiEvent("tags",c?"tags_billboard_edit_tag":"tags_billboard_dock_tag"),v.dockAnnotation(f,n)))}),[c,n,d,u,f,v]);return n!==a.U.OBJECT||c?g||!o.share&&!o.dock?(0,s.jsx)("div",{}):(0,s.jsxs)("header",{className:r()("tag-billboard-header",{editable:c}),children:[!c&&o.share&&(0,s.jsx)(Z.k,{prefix:"tag",pin:t,id:t.id,darkTheme:!0,includeCameraView:!0,analyticAction:"tags_copy_share_link",buttonVariant:Q.Ak.TERTIARY}),o.dock&&(0,s.jsx)(Q.$n,{icon:p,label:h,size:Q.Mp.SMALL,variant:Q.Ak.TERTIARY,theme:"dark",onClick:E,reverse:!0,tooltip:m,tooltipOptions:{placement:"bottom"}})]}):null}var re=n(58691),ae=n(98236),ce=n(29479);const le=(0,ae.v)(ce.j);var de=n(40590);const ue=(0,ae.v)(de.$);var he=n(5262),pe=n(13767);const{ANNOTATIONS:me}=O.A.SHOWCASE;function fe({onClick:e,previewId:t,previewType:n}){const o=new z.r({links:!0}),c=(0,j.s)(),l=(0,te.B)(),d=(0,C.S)(W.Et),u=(0,T.d)(),h=(0,X.G)(),p=le(),m=ue(),f=(0,N.Y)(),g=(0,J.J)(),v=(0,i.useRef)(null),[E,x]=(0,i.useState)(!1),[y,b]=(0,i.useState)(null),[A,S]=(0,i.useState)({dock:!0,share:!0}),_=(0,he.i)(pe.GK,!0),O=(0,he.i)(pe.AM,!0),k=(0,se.a)(null==y?void 0:y.layerId),w="true"===(0,he.i)(pe.$Q,!1),R=(0,i.useCallback)((e=>{c.trackToolGuiEvent("tags",e)}),[c]),L=(0,i.useCallback)(((t,n)=>{R("tags_billboard_click_attachment"),e(n)}),[e,R]),I=(0,i.useCallback)((t=>{t.stopPropagation(),k||(R(l?"tags_billboard_click_to_edit":"tags_billboard_click_to_dock"),e())}),[k,e,R,l]),P=(0,i.useCallback)((e=>{x(e)}),[]);(0,i.useEffect)((()=>(y&&v.current&&v.current.focus(),()=>{})),[y]),(0,i.useEffect)((()=>{if(h&&p)switch(n){case a.U.OBJECT:const e=null==m?void 0:m.getObjectTag(t);if(!e)return;const s=e.mattertagId?p.getTag(e.mattertagId):void 0,i=e.toTagView(s);b(Object.assign({},i));break;case a.U.TAG:const o=p.getTag(t),r=h.getTagView(t);if(!o||!r)return void b(null);function c(){const e=null==u?void 0:u.getCapabilities(t);return e&&S(Object.assign({},e)),e}b(Object.assign({},r));const l=c(),d=null==l?void 0:l.onChanged(c),f=o.onChanged((()=>{const e=h.getTagView(t);e&&b(Object.assign({},e))}));return()=>{null==d||d.cancel(),f.cancel()}}}),[u,p,m,t,n,h]);if(!y)return null;const{id:D,label:H,attachments:U,description:K,keywords:Y}=y,Q=(0,F.c9)(U),Z=Q.length>0,ee=(0,F.rg)(U),ne=U.some((e=>e.mediaType===$.zu.VIDEO)),ie=Math.max(ee.length-B.p8,0);ie>0&&(ee.length=B.p8);const ae=f.t(me.READ_MORE_MESSAGE),ce=(0,s.jsx)(q.P,{attachments:Q,onClick:L}),de=H&&(0,s.jsx)("div",{className:"tag-billboard-title",children:H}),fe=r()("annotation-preview-contents","tag-billboard",{"viewable-media":Z,"has-video":ne});return(0,s.jsxs)("div",{ref:v,role:"dialog",tabIndex:0,className:fe,onClick:I,onKeyDown:e=>{"Escape"===e.code&&(e.stopPropagation(),null==d||d.closeBillboard())},children:[(0,s.jsx)(oe,{tag:y,tagType:n,capabilities:{share:_&&A.share,dock:O&&A.dock}}),(0,s.jsxs)("div",{className:"tag-billboard-contents",children:[H?(()=>{const e=w?de:ce,t=w?ce:de;return(0,s.jsxs)(s.Fragment,{children:[e,t]})})():ce,K&&(0,s.jsx)("div",{className:"tag-billboard-description",children:(0,s.jsx)(M.$,{text:K,textParser:o,linkHandler:g,annotationType:a.U.TAG,annotationId:D,maxLength:100,maxLines:4,onTruncationChange:P})}),Y&&(0,s.jsx)(re.B,{keywords:Y,theme:"dark",className:"tag-previewer-keywords"}),ee.length>0&&(0,s.jsx)(V.E,{annotationType:a.U.TAG,attachments:ee,children:(0,s.jsx)(G,{moreAttachmentsCount:ie})}),E&&(0,s.jsx)("div",{className:"annotation-read-more",children:(0,s.jsx)("span",{className:"link link-more",children:ae})})]})]})}const ge=(0,i.memo)((({notesEnabled:e,openModal:t})=>{const n=(0,b.B)(),o=(0,j.s)(),l=(0,C.S)(W.Et),{billboardAnnotation:d,selectedAnnotation:u,dockedAnnotation:h}=(0,A.J)((0,T.d)())||{},p=(null==d?void 0:d.annotationType)===a.U.TAG,m=(null==d?void 0:d.annotationType)===a.U.OBJECT,f=e&&(null==d?void 0:d.annotationType)===a.U.NOTE,g=(0,i.useCallback)((()=>{d&&l&&(o.trackGuiEvent(`annotations_dock_${d.annotationType}`),l.dockAnnotation(d.id,d.annotationType))}),[o,d,l]),v=(0,i.useCallback)((()=>{d&&l&&(o.trackGuiEvent(`annotations_select_${d.annotationType}`),l.selectAnnotation(d.id,d.annotationType))}),[o,d,l]),E=(0,i.useCallback)((e=>{if(d){o.trackGuiEvent(f?"click_note_preview":"tags_click_tag_billboard");const{id:t,annotationType:s}=d;e&&!h||m||g(),e&&n.broadcast(new c.z(s,t,e))}}),[d,o,h,m,f,g,n]),x=(0,i.useCallback)((()=>{if(d)if(u)null==l||l.closeAnnotation(d.id,d.annotationType);else{f||h?g():v()}}),[d,g,h,f,v,u,l]);return t?null:(0,s.jsx)(y,{className:r()({"tag-preview":p||m,"note-preview":f}),onClick:x,children:p||m?(0,s.jsx)(fe,{previewId:d.id,previewType:d.annotationType,onClick:E}):f?(0,s.jsx)(Y,{previewId:d.id,onClick:E}):null},null==d?void 0:d.id)}))},43457:(e,t,n)=>{"use strict";n.d(t,{$:()=>g});var s=n(74848),i=n(96540),o=n(17904),r=n(78063),a=n(50747),c=n(75742),l=n(67430),d=n(71687),u=n(40409),h=n(35404),p=n(80419),m=n(12640),f=n(71344);n(44476);function g(e){const{text:t,textParser:n,linkHandler:g,annotationType:v,annotationId:E,edited:x,maxLength:y,maxLines:T,readMore:b,attachments:C,onViewAttachment:A,onTruncationChange:S}=e,[_,O]=(0,i.useState)(!1),N=(0,o.S)(d.Et),k=(0,r.B)(),w=(0,a.F)().tryGetProperty(h.qu,!1);return(0,s.jsxs)("div",{className:"annotation-box",children:[(0,s.jsx)("div",{className:"annotation-text-box",children:(0,s.jsx)(f.A,{text:t,textParser:n,onClickAnchor:w?void 0:e=>{const t=e.target,n=t.dataset.blocktype;if(e.stopPropagation(),n){const s={blockType:n,text:t.innerText,value:t.dataset.value,id:t.dataset.id};if(n===c.n.LINK&&g&&s.value){e.preventDefault();const t=(0,l.A)(s.value),{url:n,modelId:i,pose:o}=t;i?g.handler.openLink({fullLink:n,modelId:i}):o?(g.handler.openLink({fullLink:n,pose:o}),null==N||N.closeAnnotation(E,v)):(g.handler.openLink(n),k.broadcast(new p.Qn(n)))}k.broadcast(new u.v(v,E,s))}},clickableLinks:!w,onTextReplaced:e=>{const t=_;O(e),S&&t!==e&&S(e)},maxLength:y,maxLines:T,readonly:!0})}),x&&(0,s.jsx)("div",{className:"annotation-edited",children:"(edited)"}),b&&_&&(0,s.jsx)("div",{className:"annotation-read-more",children:(0,s.jsx)("span",{className:"link link-more",children:b})}),C&&!w&&(R=C,0===R.length?null:(0,s.jsx)(m.E,{attachments:R,onViewAttachment:A,annotationType:v}))]});var R}},46822:(e,t,n)=>{"use strict";n.d(t,{d:()=>o});var s=n(98236),i=n(30926);const o=(0,s.v)(i.o)},62834:(e,t,n)=>{"use strict";n.d(t,{X:()=>o});var s=n(96540),i=n(46822);function o(){const e=(0,i.d)(),[t,n]=(0,s.useState)(e?e.dockedAnnotation:null);return(0,s.useEffect)((()=>{if(!e)return()=>{};function t(){n(e?e.dockedAnnotation:null)}const s=e.onChanged(t);return t(),()=>s.cancel()}),[e]),t}(0,n(61260).c)("dockedAnnotation",o)},40409:(e,t,n)=>{"use strict";n.d(t,{v:()=>o,z:()=>i});var s=n(89103);class i extends s.QB{constructor(e,t,n){super(),this.annotationType=e,this.id=t,this.attachmentId=n}}class o extends s.QB{constructor(e,t,n){super(),this.block=n,this.id=t,this.annotationType=e}}},25296:(e,t,n)=>{"use strict";n.d(t,{dT:()=>o,db:()=>a,q2:()=>r});var s=n(51831),i=n(53641);function o(e,t){return!!t&&t.id===e.getCurrentUserId()}function r(e,t,n,r){if(n===s.U.NOTE){return t.hasPolicy(i.O7)&&o(e,r)}return e.isEditor()}function a(e,t,n,r){if(n===s.U.NOTE){return t.hasPolicy(i.xB)&&o(e,r)||e.isOrgAdmin()}return e.isEditor()}},20835:(e,t,n)=>{"use strict";n.d(t,{v:()=>r});var s=n(84710),i=n(56413),o=n(30740);class r extends s.B{constructor(){super(),this.name="attachments-data",this.pendingAttachments=(0,i.y)(),this.removedAttachments=(0,i.y)(),this.currentUploads=(0,i.y)(),this.failedUploads=(0,i.y)()}iteratePending(e){for(const t of this.pendingAttachments)e(t)}iterateRemoved(e){for(const t of this.removedAttachments)e(t)}get pendings(){return this.pendingAttachments}get removals(){return this.removedAttachments}getPendingAttachment(e){return this.pendingAttachments.get(e)}getRemovedAttachment(e){return this.removedAttachments.get(e)}addPending(e){this.pendingAttachments.set(e.id,e)}removePendingAttachment(e){this.pendingAttachments.has(e)&&this.pendingAttachments.delete(e)}clearPending(){this.pendingAttachments.clear()}getPendingAttachmentsForAsset(e,t){const n=[];return this.iteratePending((s=>{s.parentType===t&&s.parentId===e&&n.push(s)})),n}getRemovedAttachmentsForAsset(e,t){const n=[];return this.iterateRemoved((s=>{s.parentType===t&&s.parentId===e&&n.push(s)})),n}markAttachmentForDelete(e){const t=new o.o(e);this.removedAttachments.set(t.id,t)}clearRemovals(){this.removedAttachments.clear()}get uploads(){return this.currentUploads}addUpload(e){this.uploads.set(e.id,e)}updateUpload(e){this.uploads.has(e.id)&&this.uploads.set(e.id,e)}removeUpload(e){this.uploads.has(e)&&this.uploads.delete(e)}clearUploads(){this.uploads.clear()}get failures(){return this.failedUploads}addFailure(e){this.failures.set(e.id,e)}removeFailure(e){this.failures.has(e)&&this.failures.delete(e)}clearFailures(){this.failures.clear()}}},14649:(e,t,n)=>{"use strict";n.d(t,{o:()=>ae});var s=n(74848),i=n(96540),o=n(32485),r=n.n(o),a=n(3795),c=n(68375),l=n(28479),d=n(55285),u=n(56147),h=n(72909),p=n(77570),m=n(42390),f=n(10843),g=n(36220);class v extends i.Component{constructor(e){super(e)}render(){const{className:e,cover:t,data:n,onClick:i,style:o}=this.props,a=r()("oembed","oembed-text",e,{"oembed-text--cover":t}),c=n.provider_name?`${n.provider_name} content`:"Embedded content",l=n.author_name?`from ${n.author_name}`:"";return(0,s.jsxs)("div",{className:a,style:o,onClick:i,children:[n.title&&(0,s.jsx)("h3",{children:n.title}),(0,s.jsx)("p",{children:`${c} ${l}`})]})}}const E=["soundcloud","spotify"];class x extends i.Component{constructor(e){super(e)}getAttributes(){const{data:e}=this.props;let t=e.thumbnail_url,n=e.thumbnail_width,s=e.thumbnail_height;return(!t||!n||!s)&&e.type===m.n.PHOTO&&(t=e.url,n=e.width,s=e.height),{url:t,width:n,height:s}}render(){const{className:e,cover:t,data:n,disabled:i,maxHeight:o,maxWidth:a,onClick:c,style:l}=this.props,{url:d,width:u,height:h}=this.getAttributes();if(!d||!u||!h)return(0,s.jsx)(v,Object.assign({},this.props));const p=function(e,t){return e<128||t<128}(u,h),f=!i&&function(e){const t=(e.provider_name||"").toLowerCase();return e.type===m.n.VIDEO?"giphy"!==t:!(e.type!==m.n.RICH||!E.includes(t))}(n),x=r()("oembed","oembed-thumbnail",e,{"oembed-thumbnail--cover":t,"oembed-thumbnail--cover--icon":t&&p}),y=Object.assign(Object.assign({},l),{backgroundImage:`url('${d}')`});if(!t){const{width:e,height:t}=function(e,t,n,s){let i=e,o=t;if(n&&i>n){const e=n/i;i*=e,o&&(o*=e)}if(o&&s&&o>s){const e=s/o;i*=e,o*=e}return{width:i,height:o}}(u,h,a,o);y.width=`${e}px`,y.height=`${t}px`}return t&&p&&(y.maxWidth=1.5*u+"px"),(0,s.jsx)("div",{className:x,style:y,onClick:i?void 0:c,children:f&&(0,s.jsx)(g.K0,{className:"oembed-thumbnail__cta",iconClass:"icon-play-unicode",buttonStyle:g.zt.OVERLAY,buttonSize:g.Tp.LARGE})})}}var y=n(39869),T=n(8387),b=n(8827);const{ATTACHMENTS:C}=u.A.SHOWCASE,A=({id:e,className:t,onClick:n,url:o,cover:a,style:c,containerWidth:l,downloadUrl:u,onDownload:h})=>{const p=(0,y.Y)(),{height:m}=(0,d.lW)(),f=(0,i.useCallback)((t=>{n&&n(t,e)}),[n,e]),g=p.t(C.DOWNLOAD_TOOLTIP),v=r()({"image-cover":!!a},t),E=4/3,x=.8*m,A=Math.min(Math.round(l/E),x);return(0,s.jsxs)("div",{className:r()("oembed-image fill-cover-image",v),style:Object.assign(Object.assign({},c),{minHeight:A,maxWidth:l}),onClick:n?f:void 0,children:[(0,s.jsx)("div",{className:"fill-blur",style:{backgroundImage:`url('${o}')`}}),(0,s.jsxs)("div",{className:"image-wrapper",children:[(0,s.jsx)("img",{className:r()("image",v),src:o,style:{maxHeight:Math.min(x,Math.round(l*E))},onClick:n?f:void 0}),(0,s.jsx)("div",{className:"image-actions",children:u?(0,s.jsx)(T.$n,{icon:"download",theme:"overlay",tooltip:g,iconSize:b.l.SMALL,variant:T.Ak.TERTIARY,tooltipOptions:{size:"small"},onClick:e=>{window.open(u,"_self"),null==h||h(e)}}):null})]})]})};class S extends i.Component{constructor(e){super(e)}render(){const{className:e,cover:t,data:n,onClick:i,style:o,containerWidth:a}=this.props,c=r()("oembed","oembed-photo",e,{"oembed-photo--cover":t});return(0,s.jsx)(A,{url:n.url,style:o,onClick:i,className:c,containerWidth:a})}}var _=n(64491);function O(e){const{className:t,children:n}=e;if(!n)return null;const i=r()("oembed","oembed-loading",t);return(0,s.jsx)("div",{className:i,children:n})}var N=n(23716);const k={flickr:!0,instagram:!0},w=/^<iframe.*>.*<\/iframe>$/;function R(e){return w.test(e)}function L(e,t){let n;return n=R(e)?function(e){const t=document.createElement("div");t.innerHTML=e;const n=t.firstChild,s=n.style;return s.maxWidth="100%",s.maxHeight="100%",s.minWidth="",s.minHeight="",n}(e):function(e,t){const n=document.createElement("iframe");n.setAttribute("allow","encrypted-media; autoplay; fullscreen");let s="";return s=t&&t===N.K.Instagram?"\n      <style>\n        html, body { padding: 0; margin: 0; border: 0; }\n        img { display: block; max-width: 100%; height: auto; border: 0; }\n        iframe { display: block; max-width: 100%; border: 0; }\n      </style>\n    ":"\n      <style>\n        html, body { padding: 0; margin: 0; border: 0; }\n        img, iframe { display: block; max-width: 100%; height: auto; border: 0; }\n      </style>\n    ",n.srcdoc=`<!doctype html>${s.replace(/\s+/g," ")}${e}`,n}(e,t),n.src||(e=>void 0!==e&&!!k[e.toLowerCase()])(t)?n.setAttribute("sandbox","allow-scripts allow-same-origin allow-popups allow-presentation"):n.setAttribute("sandbox","allow-same-origin"),n}var I=n(12103);function j(e){const{className:t,data:n,loadingComponent:o,onClick:a,style:c,onLoad:l}=e,[d,u]=(0,i.useState)(),[h,p]=(0,i.useState)(),[f,g]=(0,i.useState)(!0),[v,E]=(0,i.useState)(n.height);(0,i.useLayoutEffect)((()=>{const e=d;let t=null;if(e){for(;e.lastChild;)e.removeChild(e.lastChild);const s=L(n.html,n.provider_name);s.onload=()=>{l&&s&&l(s),g(!1)},e.appendChild(s),t=e=>{const t=(e=>{let t;try{t=JSON.parse(e.data)}catch(e){return}if("iframe.resize"!==t.context)return;const n=t.src.replace(/http(s?):\/\//,"//"),s=document.querySelector('iframe[src="'+n+'"]');return s?{iframe:s,height:t.height}:void 0})(e);t&&t.iframe===s&&E(t.height)},window.addEventListener("message",t)}return()=>{t&&window.removeEventListener("message",t)}}),[d,n.html,n.provider_name,l]);const x=(0,i.useCallback)((e=>{e&&(p(e.offsetWidth),u(e))}),[]),y=(0,i.useMemo)((()=>{var e;if(!v||!h)return"30%";let t;if((null===(e=n.provider_name)||void 0===e?void 0:e.toLowerCase())===N.K.Flickr)t=(n.height||n.thumbnail_height||220)/n.width;else{let e=v||n.height||n.thumbnail_height||220;n.type===m.n.VIDEO&&window.innerWidth>=I.K$&&(e*=1.3),t=e/h}return`${Math.max(30,100*t).toPrecision(4)}%`}),[v,h,n.height,n.width,n.thumbnail_height,n.provider_name,n.type]);return(0,s.jsxs)("div",{className:r()("oembed-iframe--wrapper",t),style:c,onClick:a,children:[(0,s.jsx)(O,{className:f?"":"is-loaded",children:o}),(0,s.jsx)("div",{className:r()("oembed-iframe__container",n.provider_name&&`oembed-iframe--src-${n.provider_name.replace(/\s/g,"-")}`,f&&"is-loading"),ref:x,style:{paddingBottom:y}})]})}var P=n(93607);const M=new f.Ay("oembed-video");class D extends i.Component{constructor(){super(...arguments),this.isUnmounting=!1,this.onIFrameLoad=async e=>{if(!this.isUnmounting)try{const t=await function(e){const t=new P.Player(e);return new Promise(((e,n)=>{t.on("ready",(()=>{e(t)}))}))}(e);if(this.isUnmounting)return;(0,_.Fr)()||t.play()}catch(e){M.warn("unable to autoplay video"),M.warn(e)}}}componentWillUnmount(){this.isUnmounting=!0}render(){const{className:e,cover:t}=this.props;if(t)return(0,s.jsx)(x,Object.assign({},this.props));const n=r()("oembed","oembed-video",e);return(0,s.jsx)(j,Object.assign({},this.props,{className:n,onLoad:this.onIFrameLoad}))}}const H=e=>{const{className:t,cover:n}=e;if(n)return(0,s.jsx)(x,Object.assign({},e));const i=r()("oembed","oembed-rich",t);return(0,s.jsx)(j,Object.assign({},e,{className:i}))};function U(e){const{children:t,className:n}=e;if(!t)return null;const i=r()("oembed","oembed-error",n);return(0,s.jsx)("div",{className:i,children:t})}const V=new f.Ay("oembed-errors");class G extends i.Component{constructor(e){super(e),this.state={caughtError:void 0}}static getDerivedStateFromError(e){return{caughtError:e}}componentDidCatch(e){V.warn(e.message)}componentDidUpdate(e){var t,n;e.data!==this.props.data&&this.setState({caughtError:void 0}),e.error!==this.props.error&&(null===(n=(t=this.props).onError)||void 0===n||n.call(t))}render(){const{className:e,cover:t,data:n,disabled:i,renderError:o,loadingComponent:r,maxHeight:a,maxWidth:c,onClick:l,style:d,thumbnail:u,error:h,containerWidth:p}=this.props,{caughtError:f}=this.state;if(o&&(h||f))return(0,s.jsx)(U,{className:e,children:o(h,f)});if(!n)return(0,s.jsx)(O,{className:e,children:r});const g={className:e,cover:t,maxHeight:a,maxWidth:c,onClick:l,style:d,containerWidth:p};return u?(0,s.jsx)(x,Object.assign({data:n,disabled:i},g)):n.type===m.n.PHOTO?(0,s.jsx)(S,Object.assign({data:n},g)):n.type===m.n.VIDEO?(0,s.jsx)(D,Object.assign({data:n,loadingComponent:r},g)):n.type===m.n.RICH?(0,s.jsx)(H,Object.assign({data:n,loadingComponent:r},g)):null}}var F=n(32617);const{ATTACHMENTS:B}=u.A.SHOWCASE,W={200:B.ERROR_200_MESSAGE,401:B.ERROR_401_MESSAGE,403:B.ERROR_403_MESSAGE,404:B.ERROR_404_MESSAGE,429:B.ERROR_429_MESSAGE},K=({error:e,compact:t,scriptError:n})=>{const[o,r]=(0,i.useState)(null),a=(0,y.Y)(),c=(null==e?void 0:e.status)&&(e=>{const t=W[e];if(t)return t;switch(Math.floor(+e/100)){case 2:return B.ERROR_200_MESSAGE;case 4:return B.ERROR_4XX_MESSAGE;case 5:return B.ERROR_5XX_MESSAGE}})(e.status),l=n?n.message:a.t(c||B.FAILED_TO_LOAD_MESSAGE),d=(0,i.useCallback)((e=>{r(e)}),[]);return(0,s.jsx)("div",{className:"embed-error-container",ref:d,children:t?(0,s.jsx)(F.m,{title:l,target:o}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"icon icon-error"}),(0,s.jsx)("div",{className:"embed-error-message",children:l})]})})};var Y=n(71687),$=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},z=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let X=class extends i.Component{constructor(e){super(e),this.isUnmounting=!1,this.handleError=()=>{const{onError:e}=this.props;e&&e(this.props.attachment.parentId)},this.renderError=(e,t)=>{const{compact:n}=this.props;return(0,s.jsx)(K,{error:e,scriptError:t,compact:n})},this.state={embed:null,error:void 0}}componentDidMount(){this.getEmbeddedMedia()}componentWillUnmount(){this.isUnmounting=!0}componentDidUpdate(e){this.props.attachment.id!==e.attachment.id&&this.getEmbeddedMedia()}async getEmbeddedMedia(){const{attachment:e}=this.props;let t,n=null;try{const t=await this.context.engine.getModuleBySymbol(Y.qy);if(n=await t.loadEmbeddedAttachment(e),!n)throw new Error("embed not found")}catch(e){t=e}this.isUnmounting||this.setState({attachmentId:e.id,embed:n,error:t})}render(){const{compact:e,height:t,width:n,onClick:i,style:o,thumbnail:a,containerWidth:c}=this.props,{embed:l,error:d}=this.state,u=l&&this.state.attachmentId===this.props.attachment.id,h=(0,s.jsx)("div",{className:"gui-spinner-icon"}),p=!!n&&!!t,m=r()("embedded-media",{clickable:i&&!d});return(0,s.jsx)(G,{className:m,data:u&&null!=l?l:void 0,style:o,cover:p,loadingComponent:h,renderError:this.renderError,error:d,thumbnail:a,disabled:e,maxWidth:n,maxHeight:t,onClick:d?void 0:i,onError:this.handleError,containerWidth:c})}};X.contextType=p.B,X=$([h.A,z("design:paramtypes",[Object])],X);var J=n(3101),q=n(94426),Q=n(6336),Z=n(587),ee=n(2803);const{ATTACHMENTS:te}=u.A.SHOWCASE,ne=new ee.f(void 0,null),se=(0,i.memo)((({attachment:e,style:t,thumbnail:n,inline:o,onClick:l,containerWidth:d})=>{(0,q.J)(Z.c.isObservable(e)?e:null);const u=(0,y.Y)(),h=(0,c.s)(),[p]=(0,Q.i)((0,J.rV)(e)&&e.url||ne),[m]=(0,Q.i)(n&&e.thumbnailUrl||ne),[f]=(0,Q.i)(e.downloadUrl||ne),g=(0,i.useRef)(null),v=t=>{t.stopPropagation(),h.trackGuiEvent("attachment_media_download_clicked",{data:e.mimeType})};if(e.category!==a._A.UPLOAD)return null;const E=r()("attachment-view",!!l&&"clickable"),x=o&&m||p;if(x)return(0,s.jsx)(A,{id:e.id,url:x,style:t,onClick:l,className:E,downloadUrl:o?void 0:f,containerWidth:d,onDownload:v});{const n=e.bytes?(0,J.X6)(e.bytes):"";return(0,s.jsxs)("div",{className:r()(E,"attachment-other",{inline:o}),onClick:l,style:t,children:[!o&&(0,s.jsx)("div",{className:"icon icon-paper-clip"}),(0,s.jsxs)("div",{className:"attachment-label",children:[(0,s.jsx)("div",{className:"file-label",children:e.filename}),n&&!o&&(0,s.jsx)("div",{className:"size-label",children:n})]}),!o&&f&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("a",{className:"link download-link",ref:g,href:f,download:!0,onClick:v,children:(0,s.jsx)("span",{className:"icon-download"})}),(0,s.jsx)(F.m,{target:g.current,title:u.t(te.DOWNLOAD_TOOLTIP)})]})]})}}));function ie({id:e,width:t,height:n,srcDoc:o,onLoad:r}){const a=new URLSearchParams(new URL(e,window.location.href).search).get("parent"),c=(0,i.useCallback)((function(e){r(e.currentTarget,a||"")}),[r,a]);return(0,s.jsx)("iframe",{style:{width:t?`${t}px`:"100%",height:n?`${n}px`:"100%",border:0},srcDoc:o,onLoad:c,referrerPolicy:"no-referrer",sandbox:"allow-scripts"},e)}var oe=n(94799);const{ATTACHMENTS:re}=u.A.SHOWCASE,ae=({attachment:e,onClick:t,inline:n,canDelete:o,hero:u,containerWidth:h,width:p,height:m,thumbnail:f,onError:g,onDelete:v})=>{const E=(0,y.Y)(),x=(0,c.s)(),[b,C]=(0,i.useState)(null),[A,S]=(0,d.Lh)(),_=(0,i.useMemo)((()=>E.t(re.DELETE_ATTACHMENT_TOOLTIP)),[E]),O=(0,J.rV)(e),N=(0,l.L)(),k=(0,oe.j)(Y.qy),w={attachment:e,thumbnail:f,containerWidth:h||S.width||0,onClick:t?n=>{t&&t(n,e.id)}:void 0};return(0,s.jsxs)("div",{className:r()("attachment",`attachment-${e.category}`,{inline:!!n,hero:!!u,"non-viewable":!O}),ref:A,children:[e.category===a._A.UPLOAD?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"attachment-preview",ref:C,children:(0,s.jsx)(se,Object.assign({},w,{inline:n}))}),o&&(null==e?void 0:e.filename)&&(0,s.jsx)(F.m,{target:b,title:e.filename})]}):e.category===a._A.EXTERNAL?(0,s.jsx)(X,Object.assign({},w,{compact:n,width:p,height:m,onError:g})):ce(e)?(0,s.jsx)(ie,{id:e.src,width:e.width,height:e.height,srcDoc:e.srcDoc,onLoad:e.onLoad}):(0,s.jsx)("div",{children:"Unknown Attachment Category"}),o&&(0,s.jsx)(T.$n,{icon:"close",className:"attachment-delete",size:T.Mp.SMALL,variant:T.Ak.FAB,theme:"dark",tooltip:_,tooltipOptions:{placement:"bottom-start"},onClick:t=>{t.stopPropagation(),t.preventDefault(),o&&(x.trackGuiEvent("attachments_click_remove",{tool:N}),v?v(e):k.removeAttachment(e))}})]})};function ce(e){return e.category===a._A.SANDBOX}},42242:(e,t,n)=>{"use strict";n.d(t,{g:()=>f});var s=n(74848),i=n(96540),o=n(32485),r=n.n(o),a=n(55285),c=n(40936),l=n(8387),d=n(28479),u=n(14649),h=n(36220),p=n(68375),m=n(97768);const f=({attachments:e,onClick:t,onNavigate:n,startIndex:o=0,onError:l})=>{const f=(0,p.s)(),[v,{width:E}]=(0,a.Lh)(),x=(0,m.w)(),{ref:y,height:T}=(0,c.A)({box:"border-box"}),[b,C]=(0,i.useState)(o),[A,S]=(0,i.useState)(),_=e.length,O=(0,d.L)();(0,i.useEffect)((()=>{o!==b&&C(o)}),[o,e]),(0,i.useEffect)((()=>{S(x?0:T)}),[T,x]);const N=(0,i.useCallback)((e=>{e.stopPropagation();const t=b+1<_?b+1:0;f.trackGuiEvent("attachments_viewer_next",{tool:O}),C(t),n&&n(t)}),[b,_,f,O,n]),k=(0,i.useCallback)((e=>{e.stopPropagation();const t=b>0?b-1:_-1;f.trackGuiEvent("attachments_viewer_prev",{tool:O}),C(t),n&&n(t)}),[b,_,f,O,n]),w=(0,i.useCallback)(((e,t)=>{e.stopPropagation();const s=t;f.trackGuiEvent("attachments_viewer_dot_clicked",{tool:O}),C(s),n&&n(s)}),[f,O,n]),R=e[b];if(!R)return null;const L=_>1;return(0,s.jsxs)("div",{className:"attachment-carousel",ref:v,children:[(0,s.jsx)("div",{className:"attachment-carousel-view",style:{height:A},children:(0,s.jsx)("div",{className:"attachment-container",ref:y,children:(0,s.jsx)(u.o,{attachment:R,onClick:t,thumbnail:!1,containerWidth:E||318,onError:l})})}),L&&(0,s.jsx)(h.K0,{className:r()("modal-nav","modal-prev"),iconClass:"icon-dpad-left",onClick:k}),L&&(0,s.jsx)(h.K0,{className:r()("modal-nav","modal-next"),iconClass:"icon-dpad-right",onClick:N}),L&&(0,s.jsx)("div",{className:"carousel-bullets",children:e.map(((e,t)=>(0,s.jsx)(g,{index:t,active:t===b,onSelect:w},t)))})]})};function g({index:e,active:t,onSelect:n}){return(0,s.jsx)(l.$n,{icon:"simple-tag",onClick:t=>n(t,e),className:r()("carousel-bullet",{"carousel-bullet-active":t})})}},96924:(e,t,n)=>{"use strict";n.d(t,{o:()=>T});var s=n(74848),i=n(96540),o=n(72909),r=n(32485),a=n.n(r),c=n(71397),l=n(22213),d=n(81088),u=n(50178),h=n(85453),p=n(42242),m=n(98715),f=n(77570),g=n(56147),v=n(71687),E=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},x=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const{ATTACHMENTS:y}=g.A.SHOWCASE;let T=class extends i.Component{constructor(e){super(e),this.bindings=[],this.onKey=async e=>{const{attachments:t,attachmentIndex:n}=this.state,s=t.length;let i=-1;switch(e.keyCode){case c.D.ESCAPE:e.stopPropagation(),this.closeAttachmentViewer();break;case c.D.LEFTARROW:e.stopPropagation(),i=n-1,i<0&&(i=s-1);break;case c.D.RIGHTARROW:e.stopPropagation(),i=n+1,i>=s&&(i=0)}-1!==i&&this.setState({attachmentIndex:i})},this.closeAttachmentViewer=()=>{this.state.open&&this.attachmentsModule.toggleAttachmentViewer(!1)},this.onModalToggled=e=>{e.modal!==l.a.ATTACHMENT||e.open||this.closeAttachmentViewer()},this.onViewerClosed=()=>{this.state.open&&(this.context.mainDiv.getRootNode().removeEventListener("keydown",this.onKey,{capture:!0}),this.context.commandBinder.issueCommand(new d.X(l.a.ATTACHMENT,!1)),this.setState({open:!1}))},this.onNavigate=e=>{this.setState({attachmentIndex:e})},this.onViewAttachments=e=>{const{attachments:t,attachmentId:n}=e,s=n||this.getCurrentAttachmentId(),i=t.findIndex((e=>e.id===s));0===t.length||-1===i?this.closeAttachmentViewer():(this.state.open||(this.context.mainDiv.getRootNode().addEventListener("keydown",this.onKey,{capture:!0}),this.context.commandBinder.issueCommand(new d.X(l.a.ATTACHMENT,!0)),this.setState({open:!0})),this.setState({attachments:t,attachmentIndex:i}))},this.state={open:!1,attachmentIndex:-1,attachments:[]}}componentDidMount(){const{messageBus:e}=this.context;this.bindings.push(e.subscribe(h.FA,this.onViewAttachments),e.subscribe(h.hd,this.onViewerClosed),e.subscribe(u.rn,this.onModalToggled)),this.context.engine.getModuleBySymbol(v.qy).then((e=>{this.attachmentsModule=e}))}componentWillUnmount(){for(const e of this.bindings)e.cancel();this.context.mainDiv.getRootNode().removeEventListener("keydown",this.onKey,{capture:!0})}getCurrentAttachmentId(){var e;const{attachmentIndex:t,attachments:n}=this.state;return(null===(e=n[t])||void 0===e?void 0:e.id)||void 0}render(){const{open:e,attachments:t,attachmentIndex:n}=this.state,{locale:i}=this.context,o=i.t(y.CLOSE_TOOLTIP),r=i.t(y.VIEWER_INDEX_COUNT,{currentNumber:n+1,totalNumber:t.length});return(0,s.jsx)("div",{className:a()("overlay-layer","attachment-overlay",{open:e}),children:e&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"overlay-top-bar",children:[(0,s.jsx)("div",{className:"overlay-label",children:r}),(0,s.jsx)(m.J,{theme:"overlay",tooltip:o,onClose:this.closeAttachmentViewer})]}),(0,s.jsx)(p.g,{attachments:t,startIndex:n,onNavigate:this.onNavigate})]})})}};T.contextType=f.B,T=E([o.A,x("design:paramtypes",[Object])],T)},14753:(e,t,n)=>{"use strict";n.d(t,{P:()=>T});var s=n(74848),i=n(96540),o=n(32485),r=n.n(o),a=n(72909),c=n(77570),l=n(3795),d=n(56147),u=n(53180),h=n(8827),p=n(39918),m=n(32617),f=n(8387),g=n(94487),v=n(71687),E=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},x=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const{ATTACHMENTS:y}=d.A.SHOWCASE;let T=class extends i.Component{constructor(e){super(e),this.setContainerRef=e=>{this.setState({containerRef:e})},this.handleCancelClick=e=>{e.preventDefault(),this.attachmentsModule.cancelAttachmentUpload(this.props.id)},this.onRemoveFailed=e=>{const{id:t,error:n}=this.props;n&&(e.stopPropagation(),this.attachmentsModule.removeFailure(t))},this.state={containerRef:null}}componentDidMount(){this.context.engine.getModuleBySymbol(v.qy).then((e=>{this.attachmentsModule=e}))}render(){const{className:e,error:t,progress:n,fileName:i}=this.props;let o=y.ERROR_UPLOAD_FAIL;const a=this.context.locale.t(y.REMOVE_TOOLTIP),c=t?this.onRemoveFailed:this.handleCancelClick;switch(t){case l.t2.FILE_TOO_LARGE:o=y.ERROR_FILE_TOO_LARGE;break;case l.t2.EMPTY_FILE:o=y.ERROR_EMPTY_FILE;break;case l.t2.OVER_QUOTA:o=y.ERROR_OVER_QUOTA;break;case l.t2.PERMISSION_DENIED:o=y.ERROR_PERMISSION_DENIED}const d=t?this.context.locale.t(o):i,v={"upload-error":!!t};return(0,s.jsxs)("div",{className:r()("attachment","attachment-upload",v,e),children:[(0,s.jsx)("div",{ref:this.setContainerRef,className:"upload-status",children:t?(0,s.jsx)(u.I,{name:"error",size:h.l.MEDIUM}):"number"==typeof n?(0,s.jsx)(p.A,{progress:n,innerRadius:20,barWidth:4}):(0,s.jsx)(g.t,{className:"loading-blocks"})}),(0,s.jsx)(m.m,{target:this.state.containerRef,title:d}),(0,s.jsx)(f.$n,{icon:"close",className:"attachment-delete",size:f.Mp.SMALL,variant:f.Ak.FAB,theme:"dark",tooltip:a,tooltipOptions:{placement:"bottom-start"},onClick:c})]})}};T.contextType=c.B,T=E([a.A,x("design:paramtypes",[Object])],T)},46587:(e,t,n)=>{"use strict";n.d(t,{M8:()=>r,Rd:()=>a,hw:()=>c,lX:()=>o});var s=n(96540),i=n(3019);function o(){return l("pendings")}function r(){return l("removals")}function a(){return l("uploads")}function c(){return l("failures")}function l(e){const t=(0,i.k)(),[n,o]=(0,s.useState)(d(t,e));return(0,s.useEffect)((()=>{if(!t)return()=>{};function n(){o(d(t,e))}const s=t[e].onChanged(n);return n(),()=>s.cancel()}),[t,e]),n}function d(e,t){return e?e[t].values:[]}},3019:(e,t,n)=>{"use strict";n.d(t,{k:()=>o});var s=n(98236),i=n(20835);const o=(0,s.v)(i.v)},85453:(e,t,n)=>{"use strict";n.d(t,{FA:()=>i,Uf:()=>a,Z4:()=>c,hd:()=>o,hg:()=>r});var s=n(89103);class i extends s.QB{constructor(e,t){super(),this.attachments=e,this.attachmentId=t}}class o extends s.QB{}class r extends s.QB{constructor(e){super(),this.upload=e}}class a extends s.QB{constructor(e){super(),this.upload=e}}class c extends s.QB{constructor(e,t,n,s){super(),this.attachment=e,this.status=t,this.parentId=n,this.parentType=s}}},48198:(e,t,n)=>{"use strict";n.d(t,{y:()=>r});var s=n(96540),i=n(99438);function o(e){return e?e.floors.getOrderedValues():[]}function r(){const e=(0,i._)(),[t,n]=(0,s.useState)(o(e));return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=()=>n(o(e)),s=e.floors.getCollection().onChanged(t);return t(),()=>s.cancel()}),[e]),t}},59150:(e,t,n)=>{"use strict";n.d(t,{w:()=>r});var s=n(74848),i=n(32485),o=n.n(i);function r({current:e,min:t,max:n}){const i=void 0!==t&&e<t||e>n;return(0,s.jsxs)("div",{className:o()("text-counter",{error:i}),children:[e,"/",n]})}},84130:(e,t,n)=>{"use strict";n.d(t,{P:()=>T,F:()=>y});var s=n(74848),i=n(96540),o=n(32485),r=n.n(o),a=n(72909),c=n(77570),l=n(89244),d=n(63220),u=n(8387);const h=/[^]*youtube.com\/shorts\//gi;var p,m=n(30278),f=n(56147),g=n(71687),v=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},E=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const{EMBED:x}=f.A.WORKSHOP;var y;!function(e){e.NONE="none",e.INVALID_URL_SYNTAX="invalid",e.LOADING="loading",e.LOADED="loaded",e.ERROR="error"}(y||(y={}));let T=p=class extends i.Component{constructor(e){super(e),this.inputRef=(0,i.createRef)(),this.isUnmounting=!1,this.onInput=e=>{const t=(0,l.q)(e)?y.NONE:y.INVALID_URL_SYNTAX;this.setState({validationPhase:t,currentUrl:e})},this.onApply=()=>{this.isDisabled()||this.onDoneEditing(this.state.currentUrl)},this.stopPropagation=e=>{e.stopPropagation()},this.onDoneEditing=async e=>{const{onEmbed:t,onEmbedCleared:n,url:s}=this.props;if(""===e)return n&&n(),void this.setState({validationPhase:y.NONE,error:void 0,currentUrl:""});const i=(e=>{if(h.test(e))return`https://youtube.com/watch?v=${e.replace(h,"").replace(/\?(.*)/g,"")}`;return e})(e);if(i&&i!==s)try{const e=await this.loadMedia(i);if(this.isUnmounting)return;e?(this.setState({validationPhase:y.LOADED,error:void 0,currentUrl:i}),t(e)):this.onEmbedError(i)}catch(e){if(this.isUnmounting)return;this.onEmbedError(i,e)}},this.loadMedia=async e=>{const{parentId:t,parentType:n}=this.props;return this.setState({validationPhase:y.LOADING}),this.attachmentsModule.embedMedia(t,n,e)},this.state={currentUrl:e.url||"",validationPhase:y.NONE,error:void 0}}componentDidMount(){this.context.engine.getModuleBySymbol(g.qy).then((e=>{this.attachmentsModule=e}))}componentWillUnmount(){this.isUnmounting=!0,this.setState({currentUrl:"",validationPhase:y.NONE,error:void 0})}componentDidUpdate(e,t){const{url:n,onValidationPhaseChange:s}=this.props;let i=this.state.validationPhase;n!==e.url&&(i=y.NONE,this.setState({currentUrl:n||"",validationPhase:y.NONE,error:void 0})),s&&i!==t.validationPhase&&s(i)}focus(){this.inputRef.current&&this.inputRef.current.focus()}onEmbedError(e,t){this.setState({error:t,validationPhase:y.ERROR,currentUrl:e})}isDisabled(){const{validationPhase:e,currentUrl:t}=this.state;return e===y.ERROR||e===y.LOADING||e===y.INVALID_URL_SYNTAX&&""!==t||""===t}renderError(){const{locale:e}=this.context,{error:t}=this.state;let n=e.t(x.ERROR_MESSAGE);return t instanceof m.aI?n=e.t(x.PROVIDER_NOT_SUPPORTED_MESSAGE):t instanceof m.Dm&&(n=e.t(x.LINK_TYPE_NOT_SUPPORTED_MESSAGE)),(0,s.jsxs)("div",{className:"popover-message popover-message-error",children:[n,"",(0,s.jsx)("a",{className:"link",target:"_blank",rel:"noreferrer",href:p.supportPage,children:e.t(x.HELP_CTA)})]})}renderHelpMessage(){const{locale:e}=this.context,{currentUrl:t,validationPhase:n}=this.state;switch(n){case y.ERROR:return this.renderError();case y.LOADING:return(0,s.jsx)("div",{className:"popover-message",children:e.t(x.LOADING_MESSAGE)});case y.INVALID_URL_SYNTAX:if(""!==t)return(0,s.jsx)("div",{className:"popover-message popover-message-error",children:e.t(x.INVALID_URL_MESSAGE)})}return(0,s.jsx)("div",{className:"popover-message",children:(0,s.jsx)("a",{className:"link",target:"_blank",href:p.supportPage,tabIndex:-1,children:e.t(x.SUPPORTED_FORMATS_MESSAGE)})})}render(){const{locale:e}=this.context,{className:t,tabIndex:n}=this.props,{currentUrl:i}=this.state,o=void 0!==n&&n>=0,a=e.t(x.MEDIA_EMBED_PLACEHOLDER);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"media-embed-editor",onClick:this.stopPropagation,children:[(0,s.jsx)(d.A,{ref:this.inputRef,text:i,type:"url",className:r()(t),placeholder:a,onDone:this.onDoneEditing,onInput:this.onInput,allowTabbing:o,tabIndex:n}),(0,s.jsx)("div",{className:"popover-footer",children:this.renderHelpMessage()})]}),(0,s.jsx)("div",{className:"modal-footer embed-apply",children:(0,s.jsx)(u.$n,{variant:u.Ak.PRIMARY,size:"small",disabled:this.isDisabled(),onClick:this.onApply,label:e.t(x.APPLY_CTA)})})]})}};T.contextType=c.B,T.supportPage="https://support.matterport.com/hc/en-us/articles/115006363868-Add-Multimedia-to-a-Mattertag-Post",T=p=v([a.A,E("design:paramtypes",[Object])],T)},42556:(e,t,n)=>{"use strict";n.d(t,{W:()=>i});var s=n(74848);function i({children:e}){return(0,s.jsx)("div",{className:"overlay-message",children:e})}},96064:(e,t,n)=>{"use strict";n.d(t,{q:()=>d});var s=n(74848),i=n(96540),o=n(32485),r=n.n(o),a=n(73566),c=n(78956),l=n(87976);const d=(0,i.forwardRef)((({children:e,open:t,className:n,onClose:o,scrollingDisabled:d=!1},u)=>{const h=(0,i.useRef)(null),p=(0,i.useRef)(null),m=(0,c.O)();(0,i.useImperativeHandle)(u,(()=>({resetScrollTop:()=>{p.current&&p.current.resetScrollTop()},scrollToSelector:e=>{p.current&&p.current.scrollToSelector(e)}})),[p]);return(0,s.jsx)("div",{className:r()("detail-panel",t&&"open",n),onKeyDown:function(e){o&&"Escape"===e.code&&(e.stopPropagation(),o())},ref:h,tabIndex:t?0:void 0,onTransitionEnd:e=>{h.current&&e.target===h.current&&t&&h.current.focus()},children:(0,s.jsx)(l.H,{ref:p,hideThumb:m===a.L$.BOTTOM_PANEL,disabled:d,children:e})})}))},36981:(e,t,n)=>{"use strict";n.d(t,{b:()=>s});const s=(0,n(96540).createContext)({includeInMemory:!1})},6304:(e,t,n)=>{"use strict";n.d(t,{N:()=>a});var s=n(96540),i=n(98236),o=n(37062);const r=(0,i.v)(o.J);function a(){const e=r(),[t,n]=(0,s.useState)((null==e?void 0:e.getAccordionGroupCollapsedStates())||{});(0,s.useEffect)((()=>{if(!e)return()=>{};function t(){e&&n(e.getAccordionGroupCollapsedStates())}const s=e.onAccordionCollapsedGroupsChanged(t);return t(),()=>s.cancel()}),[e]);return[t,(0,s.useCallback)(((t,n)=>{e&&e.setAccordionGroupCollapsed(t,n)}),[e])]}},56023:(e,t,n)=>{"use strict";n.d(t,{D:()=>o});var s=n(90087),i=n(96540);function o(e,t){const n=(0,s.L)();return(0,i.useCallback)(((...s)=>{const i=t?Array.isArray(t)?t:t(...s):[];n.issueCommand(new e(...i))}),[e,t,n])}},94426:(e,t,n)=>{"use strict";n.d(t,{J:()=>i});var s=n(96540);function i(e){const t=function(){const[,e]=(0,s.useState)(0);return(0,s.useCallback)((()=>{e((e=>e+1))}),[])}();return(0,s.useEffect)((()=>{if(t(),null!=e){const n=e.onChanged(t);return()=>{n.cancel()}}return()=>{}}),[e,t]),e}},70401:(e,t,n)=>{"use strict";n.d(t,{r:()=>d});var s=n(74848),i=n(96540),o=n(72909),r=n(8387),a=n(71397),c=n(77570),l=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r};let d=class extends i.Component{constructor(){super(...arguments),this.onKey=async e=>{if(this.props.disabled)return;switch(e.keyCode){case a.D.COMMA:this.onGotoPrev();break;case a.D.PERIOD:this.onGotoNext()}},this.onGotoNext=()=>{const e=this.getNextIndex();-1!==e&&this.props.onNavigate(e)},this.onGotoPrev=()=>{const e=this.getPrevIndex();-1!==e&&this.props.onNavigate(e)}}componentDidMount(){this.context.mainDiv.getRootNode().addEventListener("keydown",this.onKey,{capture:!0})}componentWillUnmount(){this.context.mainDiv.getRootNode().removeEventListener("keydown",this.onKey,{capture:!0})}getNextIndex(){const{total:e,index:t,wrapAround:n}=this.props;return t+1<e?t+1:n?0:-1}getPrevIndex(){const{total:e,index:t,wrapAround:n}=this.props;return t>0?t-1:n?e-1:-1}render(){const{total:e,index:t,disabled:n,overlay:i}=this.props;if(e<2||-1===t)return null;const o=i?"dark":"light",a=i?void 0:r.Mp.LARGE,c=`${t+1} of ${e}`;return(0,s.jsxs)("div",{className:"list-nav",children:[(0,s.jsx)(r.$n,{icon:"dpad-left",variant:r.Ak.TERTIARY,size:a,disabled:n,theme:o,onClick:this.onGotoPrev}),(0,s.jsx)("span",{className:"list-nav-label",children:c}),(0,s.jsx)(r.$n,{icon:"dpad-right",variant:r.Ak.TERTIARY,size:a,disabled:n,theme:o,onClick:this.onGotoNext})]})}};d.contextType=c.B,d=l([o.A],d)},68490:(e,t,n)=>{"use strict";n.d(t,{Q:()=>Q,r:()=>q});var s=n(74848),i=n(96540);var o=function(){return o=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)};function r(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]])}return n}Object.create;Object.create;var a=function(){return a=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},a.apply(this,arguments)};Object.create;function c(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],s=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function l(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var s,i,o=n.call(e),r=[];try{for(;(void 0===t||t-- >0)&&!(s=o.next()).done;)r.push(s.value)}catch(e){i={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return r}function d(e,t,n){if(n||2===arguments.length)for(var s,i=0,o=t.length;i<o;i++)!s&&i in t||(s||(s=Array.prototype.slice.call(t,0,i)),s[i]=t[i]);return e.concat(s||Array.prototype.slice.call(t))}Object.create;var u=n(32485),h=n.n(u),p=function(e){return(Array.isArray(e)?e:[e]).filter((function(e){return!!e})).map((function(e){return"mdc-theme--"+e.replace(/([A-Z])/g,(function(e){return"-"+e.toLowerCase()}))}))},m=i.forwardRef((function(e,t){var n=e.tag,s=void 0===n?"div":n,o=(e.theme,e.element),r=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]])}return n}(e,["tag","theme","element"]),c=o?o.props(r):r,l=o?f(t,o.setRef):t;return i.createElement(s,a({},c,{ref:l}))})),f=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){var n,s;try{for(var i=c(e),o=i.next();!o.done;o=i.next()){var r=o.value;"function"==typeof r?r(t):r&&"current"in r&&(r.current=t)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(s=i.return)&&s.call(i)}finally{if(n)throw n.error}}}},g=function(e,t){"function"==typeof e?e(t):e&&"current"in e&&(e.current=t)};function v(e){var t=i.forwardRef(e),n=function(e,t){return i.createElement(i.Fragment,null)};return n.displayName=e.constructor.name||"RMWCComponent",t.displayName=n.displayName,t}var E={blur:"onBlur",cancel:"onCancel",click:"onClick",close:"onClose",contextmenu:"onContextMenu",copy:"onCopy",cut:"onCut",auxclick:"onAuxClick",doubleclick:"onDoubleClick",dragend:"onDragEnd",dragstart:"onDragStart",drop:"onDrop",focus:"onFocus",input:"onInput",invalid:"onInvalid",keydown:"onKeyDown",keypress:"onKeyPress",keyup:"onKeyUp",mousedown:"onMouseDown",mouseup:"onMouseUp",paste:"onPaste",pause:"onPause",play:"onPlay",pointercancel:"onPointerCancel",pointerdown:"onPointerDown",pointerup:"onPointerUp",ratechange:"onRateChange",reset:"onReset",seeked:"onSeeked",submit:"onSubmit",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchstart:"onTouchStart",volumechange:"onVolumeChange",abort:"onAbort",animationend:"onAnimationEnd",animationiteration:"onAnimationIteration",animationstart:"onAnimationStart",canplay:"onCanPlay",canplaythrough:"onCanPlayThrough",drag:"onDrag",dragenter:"onDragEnter",dragexit:"onDragExit",dragleave:"onDragLeave",dragover:"onDragOver",durationchange:"onDurationChange",emptied:"onEmptied",encrypted:"onEncrypted",ended:"onEnded",error:"onError",gotpointercapture:"onGotPointerCapture",load:"onLoad",loadeddata:"onLoadedData",loadedmetadata:"onLoadedMetadata",loadstart:"onLoadStart",lostpointercapture:"onLostPointerCapture",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseover:"onMouseOver",playing:"onPlaying",pointermove:"onPointerMove",pointerout:"onPointerOut",pointerover:"onPointerOver",progress:"onProgress",scroll:"onScroll",seeking:"onSeeking",stalled:"onStalled",suspend:"onSuspend",timeupdate:"onTimeUpdate",toggle:"onToggle",touchmove:"onTouchMove",transitionend:"onTransitionEnd",waiting:"onWaiting",wheel:"onWheel",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",pointerenter:"onPointerEnter",pointerleave:"onPointerLeave",change:"onChange",select:"onSelect",beforeinput:"onBeforeInput",compositionend:"onCompositionEnd",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate"},x=function(e){return E[e]||e},y=function(){function e(e){this._classes=new Set,this._events={},this._style={},this._props={},this._ref=null,this._onChange=null,this._onChange=e,this.onChange=this.onChange.bind(this),this.addClass=this.addClass.bind(this),this.removeClass=this.removeClass.bind(this),this.hasClass=this.hasClass.bind(this),this.setProp=this.setProp.bind(this),this.getProp=this.getProp.bind(this),this.removeProp=this.removeProp.bind(this),this.setStyle=this.setStyle.bind(this),this.addEventListener=this.addEventListener.bind(this),this.removeEventListener=this.removeEventListener.bind(this),this.setRef=this.setRef.bind(this)}return e.prototype.onChange=function(){this._onChange&&this._onChange()},e.prototype.destroy=function(){var e=this;this._onChange=null,this._events={},this._style={},this._props={},this._classes=new Set,setTimeout((function(){e._ref=null}))},e.prototype.addClass=function(e){this._classes.has(e)||(this._classes.add(e),this.onChange())},e.prototype.removeClass=function(e){this._classes.has(e)&&(this._classes.delete(e),this.onChange())},e.prototype.hasClass=function(e){return this._classes.has(e)},e.prototype.setProp=function(e,t,n){void 0===n&&(n=!1),this._props[e]!==t&&(this._props[e]=t,!n&&this.onChange())},e.prototype.getProp=function(e){return this._props[e]},e.prototype.removeProp=function(e){void 0!==this._props[e]&&(delete this._props[e],this.onChange())},e.prototype.props=function(e){var t=this,n=e.className,s=void 0===n?"":n,i=e.style,o=void 0===i?{}:i,r=Object.entries(e).reduce((function(e,n){var s=l(n,2),i=s[0],o=s[1],r=t._events[i];if("function"==typeof o&&"function"==typeof r){e[i]=function(e){return r(e),o(e)}}return e}),a({},this._events)),c=h()(s,d([],l(this._classes))),u=a(a({},this._style),o);return a(a(a(a({},e),this._props),r),{style:u,className:c})},e.prototype.setStyle=function(e,t){e=e.startsWith("--")?e:e.replace(/(-[a-z])/g,(function(e){return e.toUpperCase().replace("-","")})),this._style[e]!==t&&(this._style[e]=t,this.onChange())},e.prototype.addEventListener=function(e,t){var n=x(e);this._events[n]!==t&&(this._events[n]=t,this.onChange())},e.prototype.removeEventListener=function(e,t){var n=x(e);this._events[n]&&(delete this._events[n],this.onChange())},e.prototype.setRef=function(e){e&&(this._ref=e)},Object.defineProperty(e.prototype,"ref",{get:function(){return this._ref},enumerable:!1,configurable:!0}),e}(),T=function(e){var t=e.foundation,n=e.props,s=e.elements,o=e.api,r=l((0,i.useState)(0),2)[1],c=(0,i.useRef)(n);c.current=n;var u=(0,i.useMemo)((function(){return Object.keys(s).reduce((function(e,t){return e[t]=new y((function(){r((function(e){return e+1}))})),e}),{})}),[]),h=(0,i.useMemo)((function(){var e=t(a(a({},u),{getProps:function(){return c.current},emit:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(e){return function(t,n,s){var i;void 0===s&&(s=!1),i=new CustomEvent(t,{detail:n,bubbles:s}),Object.defineProperty(i,"target",{value:n,writable:!1}),Object.defineProperty(i,"currentTarget",{value:n,writable:!1});var o=t;return e[o]&&e[o](i),i}}(c.current).apply(void 0,d([],l(e)))}}));return o&&g(c.current.apiRef,o(a({foundation:e},u))),e}),[]);return(0,i.useEffect)((function(){var e=h;return e.init(),o&&g(c.current.apiRef,o(a({foundation:e},u))),g(c.current.foundationRef,e),function(){e.destroy(),g(c.current.apiRef,null),g(c.current.foundationRef,null),Object.values(u).map((function(e){return e.destroy()})),c.current={}}}),[h,u]),a({foundation:h},u)},b={bottom:0,height:0,left:0,right:0,top:0,width:0},C=function(e,t){return C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},C(e,t)};var A=function(){return A=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},A.apply(this,arguments)};var S={animation:{prefixed:"-webkit-animation",standard:"animation"},transform:{prefixed:"-webkit-transform",standard:"transform"},transition:{prefixed:"-webkit-transition",standard:"transition"}},_={animationend:{cssProperty:"animation",prefixed:"webkitAnimationEnd",standard:"animationend"},animationiteration:{cssProperty:"animation",prefixed:"webkitAnimationIteration",standard:"animationiteration"},animationstart:{cssProperty:"animation",prefixed:"webkitAnimationStart",standard:"animationstart"},transitionend:{cssProperty:"transition",prefixed:"webkitTransitionEnd",standard:"transitionend"}};function O(e){return Boolean(e.document)&&"function"==typeof e.document.createElement}var N=function(){function e(e){void 0===e&&(e={}),this.adapter_=e}return Object.defineProperty(e,"cssClasses",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{}},enumerable:!0,configurable:!0}),e.prototype.init=function(){},e.prototype.destroy=function(){},e}();var k={ACTIVE:"mdc-slider--active",DISABLED:"mdc-slider--disabled",DISCRETE:"mdc-slider--discrete",FOCUS:"mdc-slider--focus",HAS_TRACK_MARKER:"mdc-slider--display-markers",IN_TRANSIT:"mdc-slider--in-transit",IS_DISCRETE:"mdc-slider--discrete"},w={ARIA_DISABLED:"aria-disabled",ARIA_VALUEMAX:"aria-valuemax",ARIA_VALUEMIN:"aria-valuemin",ARIA_VALUENOW:"aria-valuenow",CHANGE_EVENT:"MDCSlider:change",INPUT_EVENT:"MDCSlider:input",PIN_VALUE_MARKER_SELECTOR:".mdc-slider__pin-value-marker",STEP_DATA_ATTR:"data-step",THUMB_CONTAINER_SELECTOR:".mdc-slider__thumb-container",TRACK_MARKER_CONTAINER_SELECTOR:".mdc-slider__track-marker-container",TRACK_SELECTOR:".mdc-slider__track"},R={PAGE_FACTOR:4},L=["mousedown","pointerdown","touchstart"],I=["mouseup","pointerup","touchend"],j={mousedown:"mousemove",pointerdown:"pointermove",touchstart:"touchmove"},P="ArrowDown",M="ArrowLeft",D="ArrowRight",H="ArrowUp",U="End",V="Home",G="PageDown",F="PageUp",B=function(e){function t(n){var s=e.call(this,A({},t.defaultAdapter,n))||this;return s.savedTabIndex_=NaN,s.active_=!1,s.inTransit_=!1,s.isDiscrete_=!1,s.hasTrackMarker_=!1,s.handlingThumbTargetEvt_=!1,s.min_=0,s.max_=100,s.step_=0,s.value_=0,s.disabled_=!1,s.preventFocusState_=!1,s.thumbContainerPointerHandler_=function(){return s.handlingThumbTargetEvt_=!0},s.interactionStartHandler_=function(e){return s.handleDown_(e)},s.keydownHandler_=function(e){return s.handleKeydown_(e)},s.focusHandler_=function(){return s.handleFocus_()},s.blurHandler_=function(){return s.handleBlur_()},s.resizeHandler_=function(){return s.layout()},s}return function(e,t){function n(){this.constructor=e}C(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),Object.defineProperty(t,"cssClasses",{get:function(){return k},enumerable:!0,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return w},enumerable:!0,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return R},enumerable:!0,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{hasClass:function(){return!1},addClass:function(){},removeClass:function(){},getAttribute:function(){return null},setAttribute:function(){},removeAttribute:function(){},computeBoundingRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},getTabIndex:function(){return 0},registerInteractionHandler:function(){},deregisterInteractionHandler:function(){},registerThumbContainerInteractionHandler:function(){},deregisterThumbContainerInteractionHandler:function(){},registerBodyInteractionHandler:function(){},deregisterBodyInteractionHandler:function(){},registerResizeHandler:function(){},deregisterResizeHandler:function(){},notifyInput:function(){},notifyChange:function(){},setThumbContainerStyleProperty:function(){},setTrackStyleProperty:function(){},setMarkerValue:function(){},setTrackMarkers:function(){},isRTL:function(){return!1}}},enumerable:!0,configurable:!0}),t.prototype.init=function(){var e=this;this.isDiscrete_=this.adapter_.hasClass(k.IS_DISCRETE),this.hasTrackMarker_=this.adapter_.hasClass(k.HAS_TRACK_MARKER),L.forEach((function(t){e.adapter_.registerInteractionHandler(t,e.interactionStartHandler_),e.adapter_.registerThumbContainerInteractionHandler(t,e.thumbContainerPointerHandler_)})),this.adapter_.registerInteractionHandler("keydown",this.keydownHandler_),this.adapter_.registerInteractionHandler("focus",this.focusHandler_),this.adapter_.registerInteractionHandler("blur",this.blurHandler_),this.adapter_.registerResizeHandler(this.resizeHandler_),this.layout(),this.isDiscrete_&&0===this.getStep()&&(this.step_=1)},t.prototype.destroy=function(){var e=this;L.forEach((function(t){e.adapter_.deregisterInteractionHandler(t,e.interactionStartHandler_),e.adapter_.deregisterThumbContainerInteractionHandler(t,e.thumbContainerPointerHandler_)})),this.adapter_.deregisterInteractionHandler("keydown",this.keydownHandler_),this.adapter_.deregisterInteractionHandler("focus",this.focusHandler_),this.adapter_.deregisterInteractionHandler("blur",this.blurHandler_),this.adapter_.deregisterResizeHandler(this.resizeHandler_)},t.prototype.setupTrackMarker=function(){this.isDiscrete_&&this.hasTrackMarker_&&0!==this.getStep()&&this.adapter_.setTrackMarkers(this.getStep(),this.getMax(),this.getMin())},t.prototype.layout=function(){this.rect_=this.adapter_.computeBoundingRect(),this.updateUIForCurrentValue_()},t.prototype.getValue=function(){return this.value_},t.prototype.setValue=function(e){this.setValue_(e,!1)},t.prototype.getMax=function(){return this.max_},t.prototype.setMax=function(e){if(e<this.min_)throw new Error("Cannot set max to be less than the slider's minimum value");this.max_=e,this.setValue_(this.value_,!1,!0),this.adapter_.setAttribute(w.ARIA_VALUEMAX,String(this.max_)),this.setupTrackMarker()},t.prototype.getMin=function(){return this.min_},t.prototype.setMin=function(e){if(e>this.max_)throw new Error("Cannot set min to be greater than the slider's maximum value");this.min_=e,this.setValue_(this.value_,!1,!0),this.adapter_.setAttribute(w.ARIA_VALUEMIN,String(this.min_)),this.setupTrackMarker()},t.prototype.getStep=function(){return this.step_},t.prototype.setStep=function(e){if(e<0)throw new Error("Step cannot be set to a negative number");this.isDiscrete_&&("number"!=typeof e||e<1)&&(e=1),this.step_=e,this.setValue_(this.value_,!1,!0),this.setupTrackMarker()},t.prototype.isDisabled=function(){return this.disabled_},t.prototype.setDisabled=function(e){this.disabled_=e,this.toggleClass_(k.DISABLED,this.disabled_),this.disabled_?(this.savedTabIndex_=this.adapter_.getTabIndex(),this.adapter_.setAttribute(w.ARIA_DISABLED,"true"),this.adapter_.removeAttribute("tabindex")):(this.adapter_.removeAttribute(w.ARIA_DISABLED),isNaN(this.savedTabIndex_)||this.adapter_.setAttribute("tabindex",String(this.savedTabIndex_)))},t.prototype.handleDown_=function(e){var t=this;if(!this.disabled_){this.preventFocusState_=!0,this.setInTransit_(!this.handlingThumbTargetEvt_),this.handlingThumbTargetEvt_=!1,this.setActive_(!0);var n=function(e){t.handleMove_(e)},s=j[e.type],i=function(){t.handleUp_(),t.adapter_.deregisterBodyInteractionHandler(s,n),I.forEach((function(e){return t.adapter_.deregisterBodyInteractionHandler(e,i)}))};this.adapter_.registerBodyInteractionHandler(s,n),I.forEach((function(e){return t.adapter_.registerBodyInteractionHandler(e,i)})),this.setValueFromEvt_(e)}},t.prototype.handleMove_=function(e){e.preventDefault(),this.setValueFromEvt_(e)},t.prototype.handleUp_=function(){this.setActive_(!1),this.adapter_.notifyChange()},t.prototype.getClientX_=function(e){return e.targetTouches&&e.targetTouches.length>0?e.targetTouches[0].clientX:e.clientX},t.prototype.setValueFromEvt_=function(e){var t=this.getClientX_(e),n=this.computeValueFromClientX_(t);this.setValue_(n,!0)},t.prototype.computeValueFromClientX_=function(e){var t=this.max_,n=this.min_,s=(e-this.rect_.left)/this.rect_.width;return this.adapter_.isRTL()&&(s=1-s),n+s*(t-n)},t.prototype.handleKeydown_=function(e){var t=this.getKeyId_(e),n=this.getValueForKeyId_(t);isNaN(n)||(e.preventDefault(),this.adapter_.addClass(k.FOCUS),this.setValue_(n,!0),this.adapter_.notifyChange())},t.prototype.getKeyId_=function(e){return e.key===M||37===e.keyCode?M:e.key===D||39===e.keyCode?D:e.key===H||38===e.keyCode?H:e.key===P||40===e.keyCode?P:e.key===V||36===e.keyCode?V:e.key===U||35===e.keyCode?U:e.key===F||33===e.keyCode?F:e.key===G||34===e.keyCode?G:""},t.prototype.getValueForKeyId_=function(e){var t=this,n=t.max_,s=t.min_,i=t.step_||(n-s)/100;switch(this.adapter_.isRTL()&&(e===M||e===D)&&(i=-i),e){case M:case P:return this.value_-i;case D:case H:return this.value_+i;case V:return this.min_;case U:return this.max_;case F:return this.value_+i*R.PAGE_FACTOR;case G:return this.value_-i*R.PAGE_FACTOR;default:return NaN}},t.prototype.handleFocus_=function(){this.preventFocusState_||this.adapter_.addClass(k.FOCUS)},t.prototype.handleBlur_=function(){this.preventFocusState_=!1,this.adapter_.removeClass(k.FOCUS)},t.prototype.setValue_=function(e,t,n){if(void 0===n&&(n=!1),e!==this.value_||n){var s=this.min_,i=this.max_,o=e===s||e===i;this.step_&&!o&&(e=this.quantize_(e)),e<s?e=s:e>i&&(e=i),e=e||0,this.value_=e,this.adapter_.setAttribute(w.ARIA_VALUENOW,String(this.value_)),this.updateUIForCurrentValue_(),t&&(this.adapter_.notifyInput(),this.isDiscrete_&&this.adapter_.setMarkerValue(e))}},t.prototype.quantize_=function(e){return Math.round(e/this.step_)*this.step_},t.prototype.updateUIForCurrentValue_=function(){var e=this,t=this,n=t.max_,s=t.min_,i=(t.value_-s)/(n-s),o=i*this.rect_.width;this.adapter_.isRTL()&&(o=this.rect_.width-o);var r=function(e,t){if(O(e)&&t in S){var n=e.document.createElement("div"),s=S[t],i=s.standard,o=s.prefixed;return i in n.style?i:o}return t}(window,"transform"),a=function(e,t){if(O(e)&&t in _){var n=e.document.createElement("div"),s=_[t],i=s.standard,o=s.prefixed;return s.cssProperty in n.style?i:o}return t}(window,"transitionend");if(this.inTransit_){var c=function(){e.setInTransit_(!1),e.adapter_.deregisterThumbContainerInteractionHandler(a,c)};this.adapter_.registerThumbContainerInteractionHandler(a,c)}requestAnimationFrame((function(){e.adapter_.setThumbContainerStyleProperty(r,"translateX("+o+"px) translateX(-50%)"),e.adapter_.setTrackStyleProperty(r,"scaleX("+i+")")}))},t.prototype.setActive_=function(e){this.active_=e,this.toggleClass_(k.ACTIVE,this.active_)},t.prototype.setInTransit_=function(e){this.inTransit_=e,this.toggleClass_(k.IN_TRANSIT,this.inTransit_)},t.prototype.toggleClass_=function(e,t){t?this.adapter_.addClass(e):this.adapter_.removeClass(e)},t}(N);var W=i.memo(i.forwardRef((function(e,t){return i.createElement("div",{ref:t,className:"mdc-slider__track"})}))),K=i.memo(i.forwardRef((function(e,t){return i.createElement("div",{ref:t,className:"mdc-slider__track-marker-container"})}))),Y=i.memo((function(e){var t=e.value;return i.createElement("div",{className:"mdc-slider__pin"},i.createElement("span",{className:"mdc-slider__pin-value-marker"},t))})),$=i.memo((function(){return i.createElement("svg",{className:"mdc-slider__thumb",width:"21",height:"21"},i.createElement("circle",{cx:"10.5",cy:"10.5",r:"7.875"}))})),z=i.memo((function(){return i.createElement("div",{className:"mdc-slider__focus-ring"})})),X=v((function(e,t){var n=function(e){var t=(0,i.useRef)(),n=(0,i.useRef)(),s=T({props:e,elements:{rootEl:!0,thumbContainerEl:!0,sliderPinEl:!0},foundation:function(e){var s,i,o,r=e.rootEl,c=e.thumbContainerEl,l=e.sliderPinEl,d=e.emit;return new B({hasClass:function(e){return r.hasClass(e)},addClass:function(e){return r.addClass(e)},removeClass:function(e){return r.removeClass(e)},getAttribute:function(e){return r.getProp(e)},setAttribute:(s=function(e,t){return r.setProp(e,t)},i=300,function(){var e=this,t=arguments;null!==o&&clearTimeout(o),o=setTimeout((function(){o=null,s.apply(e,t)}),i)}),removeAttribute:function(e){return r.removeProp(e)},computeBoundingRect:function(){return r.ref?r.ref.getBoundingClientRect():b},getTabIndex:function(){return r.ref?r.ref.tabIndex:0},registerInteractionHandler:function(e,t){r.addEventListener(e,t)},deregisterInteractionHandler:function(e,t){r.removeEventListener(e,t)},registerThumbContainerInteractionHandler:function(e,t){c.addEventListener(e,t)},deregisterThumbContainerInteractionHandler:function(e,t){c.removeEventListener(e,t)},registerBodyInteractionHandler:function(e,t){document.body&&document.body.addEventListener(e,t)},deregisterBodyInteractionHandler:function(e,t){document.body&&document.body.removeEventListener(e,t)},registerResizeHandler:function(e){window.addEventListener("resize",e)},deregisterResizeHandler:function(e){window.removeEventListener("resize",e)},notifyInput:function(){d("onInput",{value:a.getValue()})},notifyChange:function(){d("onChange",{value:a.getValue()})},setThumbContainerStyleProperty:function(e,t){c.setStyle(e,t)},setTrackStyleProperty:function(e,n){var s;null===(s=t.current)||void 0===s||s.style.setProperty(e,n)},setMarkerValue:function(e){l.setProp("value",e)},setTrackMarkers:function(e,t,s){var i,o=e.toLocaleString(),r="linear-gradient(to right, currentColor 2px, transparent 0) 0 center / calc((100% - 2px) / (("+t.toLocaleString()+" - "+s.toLocaleString()+") / "+o+")) 100% repeat-x";null===(i=n.current)||void 0===i||i.style.setProperty("background",r)},isRTL:function(){return!!r.ref&&"rtl"===getComputedStyle(r.ref).direction}})}}),a=s.foundation,c=r(s,["foundation"]);return(0,i.useEffect)((function(){void 0!==e.max&&a.setMax(+e.max)}),[e.max,a]),(0,i.useEffect)((function(){void 0!==e.min&&a.setMin(+e.min)}),[e.min,a]),(0,i.useEffect)((function(){var t=void 0!==e.value?Number(e.value):a.getValue(),n=a.getMin(),s=a.getMax();t<n&&(console.warn("Attempted to set slider to "+t+" which is less than min: "+n),t=n),t>s&&(console.warn("Attempted to set slider to "+t+" which is greater than max: "+s),t=s),a.setValue(t)}),[e.value,a]),(0,i.useEffect)((function(){void 0!==e.step&&a.setStep(+e.step)}),[e.step,a]),(0,i.useEffect)((function(){void 0!==e.disabled&&a.setDisabled(e.disabled)}),[e.disabled,a]),(0,i.useEffect)((function(){void 0!==e.discrete&&(a.isDiscrete_=e.discrete),e.discrete&&0===a.getStep()&&a.setStep(1)}),[e.discrete,a]),(0,i.useEffect)((function(){var t=a.hasTrackMarker_;void 0!==e.displayMarkers&&e.displayMarkers!==t&&(a.hasTrackMarker_=e.displayMarkers,window.requestAnimationFrame((function(){return a.setupTrackMarker()})))}),[e.displayMarkers,a]),(0,i.useEffect)((function(){var e=a.handleDown_.bind(a);a.handleDown_=function(t){t.persist(),e(t)}}),[a]),o({setTrackRef:function(e){return t.current=e},setTrackMarkerContainerRef:function(e){return n.current=e}},c)}(e),s=n.rootEl,a=n.thumbContainerEl,c=n.sliderPinEl,u=n.setTrackRef,f=n.setTrackMarkerContainerRef,g=e.value,v=(e.min,e.max),E=e.discrete,x=e.displayMarkers,y=e.step,C=e.disabled,A=(e.onChange,e.onInput,e.children),S=(e.foundationRef,r(e,["value","min","max","discrete","displayMarkers","step","disabled","onChange","onInput","children","foundationRef"])),_=function(e,t){return h().apply(void 0,d(d([e.className],l(e.theme?p(e.theme):[])),l("function"==typeof t?t(e):t)))}(e,["mdc-slider",{"mdc-slider--discrete":E,"mdc-slider--display-markers":x&&E}]),O=y?{"data-step":y}:{};return x&&!E&&console.warn("The 'displayMarkers' prop on rmwc Slider will\n        only work in conjunction with the 'discrete' prop"),i.createElement(m,o({tabIndex:0,role:"slider","aria-valuemax":v,"aria-valuenow":g,"aria-label":"Select Value"},C?{"aria-disabled":C}:{},O,S,{ref:t,element:s,className:_}),i.createElement("div",{className:"mdc-slider__track-container"},i.createElement(W,{ref:u}),x&&i.createElement(K,{ref:f})),i.createElement(m,{element:a,className:"mdc-slider__thumb-container"},E&&i.createElement(Y,{value:c.getProp("value")}),i.createElement($,null),i.createElement(z,null)),A)}));n(44704);let J=0;class q extends i.Component{constructor(e){super(e),this.mdcRef=(0,i.createRef)(),this.setValue=e=>{this.setState({value:e})},this.onSliderInput=e=>{var t;const n=e.detail.value;this.layoutRecalculated||(null===(t=this.mdcRef.current)||void 0===t||t.layout(),this.layoutRecalculated=!0),this.setState({value:n}),this.props.onInput&&this.props.onInput(n)},this.onSliderChange=e=>{const t=e.detail.value;this.setState({value:t}),this.props.onChange&&this.props.onChange(t)},this.getLeftOffset=()=>100*(this.state.value-this.props.min)/(this.props.max-this.props.min)+"%",this.getSliderId=()=>`slider-with-tooltip-${this.id}`,this.getStyleElement=()=>`#${this.getSliderId()} .mdc-slider__thumb-container {\n        left: ${this.getLeftOffset()}\n    }`,this.getDisplayValue=e=>{const{formatNumbers:t,units:n}=this.props;return(t?t(e):e)+(n||"")},this.setActive=e=>()=>this.setState({active:e}),this.hasChanged=()=>{this.setState({hasChanged:!1})},this.onMouseDown=e=>{this.props.onInputStart&&this.props.onInputStart()},this.onEventMouseUp=e=>{this.props.onInputEnd&&this.props.onInputEnd()},this.onMouseUp=e=>{this.props.onInputEnd&&this.props.onInputEnd()},this.id=J++,this.state={value:void 0!==e.initialValue?e.initialValue:(e.max+e.min)/2,active:!1,hasChanged:!1},this.setActiveSlider=this.setActive(!0),this.setInactiveSlider=this.setActive(!1)}componentDidMount(){document.addEventListener("mouseup",this.onEventMouseUp),document.addEventListener("mouseleave",this.onEventMouseUp)}componentWillUnmount(){document.removeEventListener("mouseup",this.onEventMouseUp),document.removeEventListener("mouseleave",this.onEventMouseUp)}componentDidUpdate(e,t){t.value!==this.state.value&&(clearTimeout(this.hasChangedTimeout),this.setState({hasChanged:!0}),this.hasChangedTimeout=window.setTimeout(this.hasChanged,450))}render(){const{width:e,displayBounds:t,min:n,max:i,discrete:o,tooltipPosition:r=Q.DOWN,variant:a="default",disabled:c,tabIndex:l}=this.props,{active:d,hasChanged:u,value:p}=this.state,m={left:this.getLeftOffset()},f="inline-value"===a,g=!f&&t,v=!f,E=void 0!==l?l:0;return(0,s.jsxs)("div",{id:this.getSliderId(),className:h()("slider-with-tooltip",{displayBounds:t,disabled:c}),style:{width:`${e}px`},onMouseEnter:this.setActiveSlider,onMouseLeave:this.setInactiveSlider,children:[v&&r===Q.UP&&(0,s.jsx)("div",{className:h()("slider-tooltip",{active:d||u}),"data-balloon":this.getDisplayValue(p),"data-balloon-pos":Q.UP,style:m}),g&&(0,s.jsx)("div",{className:"min-amount",children:this.getDisplayValue(n)}),f&&(0,s.jsx)("div",{className:"min-amount",children:this.getDisplayValue(p)}),(0,s.jsx)(X,{discrete:o,min:n,max:i,value:p,onInput:this.onSliderInput,onChange:this.onSliderChange,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,foundationRef:this.mdcRef,disabled:c,tabIndex:E}),g&&(0,s.jsx)("div",{className:"max-amount",children:this.getDisplayValue(i)}),(0,s.jsx)("style",{dangerouslySetInnerHTML:{__html:this.getStyleElement()}}),v&&r===Q.DOWN&&(0,s.jsx)("div",{className:h()("slider-tooltip",{active:d||u}),"data-balloon":this.getDisplayValue(p),"data-balloon-pos":Q.DOWN,style:m})]})}}var Q;!function(e){e.UP="up",e.DOWN="down"}(Q||(Q={}))},56500:(e,t,n)=>{"use strict";n.d(t,{n:()=>m});var s=n(74848),i=n(96540),o=n(23339),r=n(87635),a=n(26348);const c=e=>{let t="";t+=Math.floor(e)+"'";const n=Math.floor(e%1*12);return n<10&&(t+="0"),t+=n+"''",t};var l=n(68490),d=n(13584),u=n(56147),h=n(39869),p=u.A.WORKSHOP.MATTERTAGS;function m(e){const{stemEnabled:t,stemLength:n,onLengthUpdate:u,onLengthChanged:m,onStemEnabledChanged:f,variant:g,disabled:v,tabIndex:E}=e,x=(0,i.useRef)(null),y=(0,r.J)(),T=(0,h.Y)();(0,i.useEffect)((()=>{x.current&&x.current.setValue((0,a.ld)(n))}),[n]);const b=T.t(p.SHOW_STEM_LABEL);return(0,s.jsxs)("div",{className:"stem-editor",onClick:e=>e.stopPropagation(),children:[(0,s.jsx)("div",{className:"stem-slider",children:(0,s.jsx)(l.r,{ref:x,discrete:!1,min:.1,max:9,initialValue:(0,a.ld)(n),onChange:(e,t=!0)=>{const n=t?(0,a.hV)(e):e;m(n)},onInput:(e,t=!0)=>{const s=t?(0,a.hV)(e):e;s!==n&&u(s)},displayBounds:!0,width:150,formatNumbers:e=>{if(y===o.t.IMPERIAL)return c(e);return`${Math.round(100*(0,a.hV)(e))/100}m`},tooltipPosition:l.Q.DOWN,variant:g,disabled:v,tabIndex:E})}),(0,s.jsx)(d.S,{enabled:!0,checked:t,label:b,onChange:e=>{const t=e.classList.contains("checked");f(t)}})]})}},63220:(e,t,n)=>{"use strict";n.d(t,{A:()=>m});var s=n(74848),i=n(96540),o=n(72909),r=n(77570),a=n(32485),c=n.n(a),l=n(71397),d=n(50178),u=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},h=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let p=class extends i.Component{constructor(e){super(e),this.focusTimeout=0,this.onInput=e=>{if(this.props.onInput){const t=e.target;this.props.onInput(t.value)}},this.onKeyPress=e=>{e.stopPropagation();const{allowTabbing:t}=this.props,n=e.which||e.keyCode,s=[l.D.TAB,l.D.RETURN,l.D.ESCAPE];if("keydown"===e.type&&!s.includes(n))return!1;const i=e.target;switch(this.props.maxLength&&i.value.length>this.props.maxLength&&e.preventDefault(),n){case l.D.ESCAPE:this.props.onCancel&&this.props.onCancel();break;case l.D.TAB:case l.D.RETURN:this.props.onBlur||e.shiftKey||(n===l.D.TAB&&t||e.preventDefault(),this.blur())}return!1},this.stopPropagation=e=>e.stopPropagation(),this.onFocus=e=>{this.context.messageBus.broadcast(new d.Yl(this.input,!0)),this.props.onFocus&&this.props.onFocus(e)},this.onBlur=e=>{this.context.messageBus.broadcast(new d.Yl(this.input,!1));const t=e.target.value,{onBlur:n,onDone:s}=this.props;n?n(t):s&&s(t)},this.setRef=e=>this.input=e,this.state={currentText:e.text}}componentWillUnmount(){window.clearTimeout(this.focusTimeout),this.input&&this.input.blur()}componentDidMount(){const{focusOnMount:e,readOnly:t}=this.props;t||(0===e?this.focus():void 0!==e&&(this.focusTimeout=window.setTimeout((()=>{this.focus()}),e)))}UNSAFE_componentWillReceiveProps(e){e.text!==this.props.text&&this.setState({currentText:e.text})}getText(){return this.input?this.input.value:""}focus(){this.input.focus()}blur(){this.input.blur()}scrollIntoView(e){this.input.scrollIntoView(e)}render(){const{placeholder:e,tabIndex:t,maxLength:n,type:i,className:o,readOnly:r,disabled:a}=this.props,{currentText:l}=this.state;return(0,s.jsx)("div",{className:c()("text-field",o),children:(0,s.jsx)("input",{ref:this.setRef,className:"text-input-box",type:i||"text",value:l,placeholder:e,"aria-label":e,maxLength:n,onInput:this.onInput,onKeyPress:this.onKeyPress,onKeyDown:this.onKeyPress,onKeyUp:this.stopPropagation,onBlur:this.onBlur,onFocus:this.onFocus,tabIndex:t,readOnly:r,disabled:!!a})})}};p.contextType=r.B,p=u([o.A,h("design:paramtypes",[Object])],p);const m=p},1415:(e,t,n)=>{"use strict";n.d(t,{U:()=>C});var s=n(74848),i=n(56147),o=n(68419),r=n(22213),a=n(96540),c=n(32485),l=n.n(c),d=n(89244),u=n(92537),h=n(8387),p=n(21162),m=n(39869);const{MATTERTAGS:f}=i.A.WORKSHOP;function g(e){const{url:t,text:n,error:i,newLink:o}=e,r=(0,m.Y)(),a=""===n&&""===t&&o?r.t(f.LINK_EDITOR_TIP_TEXT):null,c=i?r.t(f.LINK_EDITOR_INVALID_TIP):null,d=l()("modal-message",{"modal-message-error":!!i}),u=c||a||"";return(0,s.jsx)("div",{className:d,children:u})}const{MATTERTAGS:v,MODAL:E}=i.A.WORKSHOP;function x(e){return(0,d.q)(e)}function y(e){const{linkUrl:t,linkText:n,onSaveLink:i,onRemoveLink:o,onCancelLink:r}=e,c=(0,m.Y)(),[d,f]=(0,a.useState)(!1),[y,T]=(0,a.useState)(n),[b,C]=(0,a.useState)(t),[A,S]=(0,a.useState)(x(t));(0,a.useEffect)((()=>(C(t),T(n),S(x(t)),f(!1),()=>{})),[n,t]);const _=(0,a.useCallback)((()=>{A&&window.open(b,"_blank","noreferrer")}),[b,A]),O=(0,a.useCallback)(((e,t)=>{const n=void 0!==t?t:b;i((void 0!==e?e:y)||n,n)}),[b,y,i]),N=(0,a.useCallback)((()=>{O(y,b)}),[O,y,b]),k=(0,a.useCallback)(((e,t)=>{const n=x(e);S(n),f(!n&&""!==e),t&&n&&O(y,e)}),[y,O]),w=(0,a.useCallback)((e=>{T(e)}),[]),R=(0,a.useCallback)((e=>{C(e);const t=x(e);S(t),d&&t&&f(!1)}),[d]),L=(0,a.useCallback)((()=>{k(b,!1)}),[b,k]),I=(0,a.useCallback)((()=>{k(b,!0)}),[b,k]),j=!t,P=c.t(v.LINK_EDITOR_TEXT_PLACEHOLDER),M=c.t(E.SAVE),D=c.t(E.CANCEL),H=c.t(v.LINK_EDITOR_PREVIEW_TIP),U=c.t(v.LINK_EDITOR_REMOVE_TIP),V=!j&&o;return(0,s.jsxs)("div",{className:"modal-contents",children:[(0,s.jsxs)("div",{className:"modal-body",children:[(0,s.jsx)("div",{className:"link-editor-field link-text-field",children:(0,s.jsx)(u.k,{text:y,placeholder:P,autofocus:!n,onInput:w,onCancel:r})}),(0,s.jsxs)("div",{className:"link-editor-field link-url-field",children:[(0,s.jsx)(u.k,{text:b,type:"url",placeholder:"https://",autofocus:!!n,onBlur:L,onReturn:I,onInput:R,onCancel:r}),A&&b&&(0,s.jsx)(h.$n,{className:"preview-link",icon:"ext-link",variant:h.Ak.TERTIARY,size:h.Mp.SMALL,tooltip:H,onClick:_})]}),(0,s.jsx)(g,{newLink:j,text:n,url:b,error:d})]}),(0,s.jsx)("div",{className:"modal-footer",children:(0,s.jsxs)(p.e,{className:l()("modal-footer",{stretch:V}),children:[V&&(0,s.jsx)(h.$n,{icon:"delete",label:U,className:"remove-link",variant:h.Ak.TERTIARY,size:h.Mp.SMALL,onClick:o}),(0,s.jsxs)(p.e,{spacing:"small",children:[(0,s.jsx)(h.$n,{label:D,variant:h.Ak.SECONDARY,size:h.Mp.SMALL,onClick:r}),(0,s.jsx)(h.$n,{label:M,variant:h.Ak.PRIMARY,disabled:!A,size:h.Mp.SMALL,onClick:N})]})]})})]})}var T=n(37049);const{MATTERTAGS:b}=i.A.WORKSHOP;function C(e){const{linkUrl:t,linkText:n,onSaveLink:i,onRemoveLink:a,onCancelLink:c}=e,l=(0,m.Y)(),d=(0,o.t)(),u=""===t?l.t(b.LINK_EDITOR_LINK_ADD_LABEL):l.t(b.LINK_EDITOR_LINK_EDIT_LABEL),h=d===r.a.LINK_EDITOR;return(0,s.jsx)(T.Q,{open:h,title:u,fullModal:!1,className:"link-editor-modal",children:(0,s.jsx)(y,{linkText:n,linkUrl:t,onCancelLink:c,onSaveLink:i,onRemoveLink:a})})}},37049:(e,t,n)=>{"use strict";n.d(t,{Q:()=>m});var s=n(74848),i=n(96540),o=n(40961),r=n(32485),a=n.n(r),c=n(35950),l=n(59618),d=n(98715),u=n(81088),h=n(90087),p=n(19072);function m(e){const{children:t,className:n,title:r,open:m,onClose:f,fullModal:g}=e,v=(0,p.x)(),E=(0,h.L)(),x=(0,i.useRef)(!1),y=(0,i.useCallback)((()=>{E.issueCommand(new u.r),f&&f()}),[E,f]),T=(0,i.useCallback)((()=>{x.current=!0,window.setTimeout((()=>{x.current=!1}),500)}),[]),b=(0,i.useCallback)((()=>{x.current&&(x.current=!1,y())}),[y]),C=v.querySelector("#react-render-root")||document.body,A=a()(n,{open:m,"full-modal":g});return(0,o.createPortal)((0,s.jsx)(c.w,{open:m,className:a()("modal-background",{open:m}),onPointerUp:b,onPointerDown:T,children:(0,s.jsxs)(l.l,{className:A,onClose:y,children:[(0,s.jsxs)("header",{className:"modal-header",children:[(0,s.jsx)("div",{className:"modal-title",children:r}),(0,s.jsx)(d.J,{onClose:y})]}),t]})}),C)}},67430:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var s=n(74328);function i(e){return e.get("m")||e.get("model")}function o(e){const t=-1!==e.indexOf("matterport.com/show"),n=-1!==e.indexOf(window.location.host+"/show");if(t||n){const t=new URL(e),n=s.s.deserialize(e)||void 0,o=i(t.searchParams),r=i(new URLSearchParams(window.location.search));return{url:e,pose:n,modelId:o&&o!==r?o:void 0}}return{url:e}}},12648:(e,t,n)=>{"use strict";n.d(t,{u:()=>y});var s=n(74848),i=n(96540),o=n(32485),r=n.n(o),a=n(77570),c=n(72909),l=n(79070),d=n(71397),u=n(89244),h=n(42329),p=n(75742),m=n(39905),f=n(71344),g=n(35137),v=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},E=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const x="";let y=class extends i.Component{constructor(e){super(e),this.emailMention=!1,this.wordToken=null,this.endTokens={"@":[","," ","!","?","/",";",":","(",")"],"#":[","," ",".","!","?","/",";",":"]},this.wordElement=null,this.linkElement=null,this.onClickAnchor=e=>{const t=e.target,n=t.dataset.blocktype;this.props.active?(e.preventDefault(),n===p.n.LINK&&this.prepareLinkForEdit(t)):n&&this.props.onClickBlock({blockType:n,text:t.innerText,value:t.dataset.value,id:t.dataset.id},e)},this.onSelectionChange=()=>{const e=this.getCurrentRange();if(e){this.range=e.cloneRange();const t=this.wordElement&&null===this.wordElement.parentElement,n=!!this.wordElement&&this.wordElement!==this.getAnchorFromSelection();(t||n)&&this.wordElement&&(this.wordElement.classList.add("link-annotation-active"),this.endWordMatching()),this.insertFocusNodeIfNeeded()}},this.addFauxHighlight=()=>{this.execCommand("backColor","#ff315840")},this.removeFauxHighlight=()=>{this.execCommand("backColor","transparent")},this.isEmailMention=(e="")=>e.lastIndexOf("@")>0,this.onInput=e=>{var t;const n=e.nativeEvent,s=n.inputType,i=s.startsWith("insert"),o="insertLineBreak"===s,r=n.data,a=this.startTokens;e.stopPropagation();const{isLinkNode:c,isSpecialNode:l,anchorNode:d}=this.tryGetAnchorNode();if(a.length&&!c&&!o){let o=r&&r.length>0?r.charAt(r.length-1):"";const c=this.getTextElement(),u=((null==c?void 0:c.innerText)||"").trim().length;if(c&&s.startsWith("delete")&&0===u&&(c.innerHTML=""),this.updateWordElement(n,l,d),!this.wordToken&&a.includes(o)?(e.preventDefault(),this.wordToken=o,this.emailMention=!1,this.createWordElement(o),this.updateSuggestions()):!this.wordToken&&r&&r.length>1&&a.includes(r[0])&&(e.preventDefault(),this.wordToken=r[0],o=r[r.length-1],this.emailMention=this.isEmailMention(r),this.createWordElement(r),this.updateSuggestions()),this.wordToken&&this.wordElement){const n=this.wordElement.textContent||"",s=this.getMatches(n),r=s.length,a=null===(t=this.endTokens[this.wordToken])||void 0===t?void 0:t.includes(o);1===r&&this.sanitizeForSearch(n)===this.sanitizeForSearch(s[0].text)&&i?(e.preventDefault(),this.chooseMatch(s[0].text,s[0].value,s[0].id)):a&&"#"===this.wordToken?(e.preventDefault(),this.finishWordElement(!0)):a&&"@"===this.wordToken?(e.preventDefault(),this.emailMention?this.finishWordElement(!0):0===r&&this.clearWordElement()):"@"===this.wordToken?(this.updateUserMatches(),this.isEmailMention(n)&&(this.wordElement.classList.add("link-annotation-active"),this.emailMention=!0)):this.filterSuggestions()}}this.props.onInput(this.getMarkdown())},this.updateUserMatches=(0,l.s)((()=>this.fetchUserMatches()),350),this.onClickMatch=e=>{const t=e.currentTarget;if(t){const n=t.dataset.value,s=t.dataset.id,i=t.dataset.text||t.innerText;e.stopPropagation(),e.preventDefault(),this.chooseMatch(i,n,s)}},this.onHoverMatch=e=>{const t=e.currentTarget;if(t){const e=parseInt(t.dataset.index||"0",10);this.setState({activeMatch:e})}},this.onClick=e=>{const{active:t,clickToEdit:n,onStartEditing:s}=this.props;t?(this.removeFauxHighlight(),this.range=null):n&&s&&s(e)},this.handleFocus=()=>{const{onFocusChange:e}=this.props;e&&e(!0)},this.onBlur=()=>{this.endWordMatching(),this.setState({sortedSuggestions:[]});const{onFocusChange:e}=this.props;e&&e(!1)},this.onDone=()=>{const{onDoneEditing:e}=this.props;e?e():this.toggleEditing(!1)},this.onKeyDown=e=>{const{onCancelEditing:t,allowTabbing:n,allowReturnKey:s}=this.props,{matches:i,activeMatch:o}=this.state;e.stopPropagation(),this.range||(this.range=this.getCurrentRange());const r=e.which||e.keyCode;switch(r){case d.D.ESCAPE:return void(t&&t());case d.D.TAB:case d.D.RETURN:if(i.length&&o>-1)e.preventDefault(),this.chooseMatch(i[o].text,i[o].value,i[o].id);else{const{isSpecialNode:t,anchorNode:i}=this.tryGetAnchorNode();if(t&&i&&this.range&&(e.preventDefault(),this.insertAndFocusCharacter(i,!1,`\n${x}`)),this.wordToken&&(e.preventDefault(),this.finishWordElement(!1,!0)),!e.shiftKey){const t=r===d.D.TAB&&n,i=r===d.D.RETURN&&s;t||i||(e.preventDefault(),this.onDone())}}return;case d.D.DOWNARROW:return void(i.length&&(e.preventDefault(),this.setState((e=>{const t=(e.activeMatch+1)%i.length;return this.ensureActiveMatchIsVisible(t),{activeMatch:t}}))));case d.D.UPARROW:return void(i.length&&(e.preventDefault(),this.setState((e=>{const t=0===e.activeMatch?i.length-1:e.activeMatch-1;return this.ensureActiveMatchIsVisible(t),{activeMatch:t}}))));case d.D.B:case d.D.I:case d.D.U:if(e.ctrlKey||e.metaKey)return void e.preventDefault();break;case d.D.BACKSPACE:case d.D.SHIFT:case d.D.CONTROL:case d.D.ALT:case d.D.LEFTARROW:case d.D.RIGHTARROW:case d.D.DELETE:return}},this.saveRef=e=>{this.textBox=e},this.bindSuggestionMenuRef=e=>{this.suggestionMenuRef=e},this.state={activeMatch:-1,matches:[],sortedSuggestions:[]}}componentDidMount(){this.props.active&&this.toggleEditing(!0,this.props.focusOnMount)}componentWillUnmount(){this.toggleEditing(!1),this.wordElement=null}componentDidUpdate(e,t){const{active:n}=this.props;n!==e.active&&this.toggleEditing(n)}toggleEditing(e,t){this.textBox&&this.textBox.toggleEditing(e,t),this.endWordMatching(),this.setState({sortedSuggestions:[]}),e?document.addEventListener("selectionchange",this.onSelectionChange):document.removeEventListener("selectionchange",this.onSelectionChange)}ensureActiveMatchIsVisible(e){if(!this.suggestionMenuRef)return;const{scrollTop:t,offsetHeight:n}=this.suggestionMenuRef,s=this.suggestionMenuRef.querySelector(`[data-index="${e}"]`);if(!s)return;const{offsetTop:i,offsetHeight:o}=s,r=t>i;if(t+n<i+o||r){const e=r;s.scrollIntoView(e)}}getTextElement(){var e;return null===(e=this.textBox)||void 0===e?void 0:e.getTextElement()}focus(){this.textBox&&this.textBox.focus()}getMarkdown(){const e=this.getTextElement();return e?this.props.textParser.serialize(e):""}hasTextSelected(){return!(!this.range||this.range.startOffset===this.range.endOffset)}createAnchor(e,t){const n=document.createElement("a");return n.href=t,n.text=this.props.textParser.sanitizeText(e),n.classList.add(m.H.LINK),n.setAttribute("data-value",t),n}prepareLinkForEdit(e){const t=e||this.getAnchorFromSelection();let n="";const s=window.getSelection();if(s){const e=this.getTextElement();t||this.range||!e?(this.addFauxHighlight(),t||(n=this.range?this.range.toString():s.toString())):(this.focus(),s.selectAllChildren(e),s.collapseToEnd(),this.range=s.getRangeAt(0),n=this.range.toString())}n===x&&(n=""),this.linkElement=t;const i=t?t.innerText:n,o=t?t.dataset.value||t.href:"";this.props.onClickBlock({blockType:p.n.LINK,text:i,value:o})}saveLink(e,t){this.linkElement?""!==t?this.updateLink(this.linkElement,e,t):this.unlink(this.linkElement):this.linkify(e,t)}updateLink(e,t,n){const s=this.createAnchor(t,n);return e.href=s.href,e.text=s.text,e.setAttribute("data-value",n),!0}cancelLink(){this.focus(),this.removeFauxHighlight()}linkify(e,t){this.removeFauxHighlight();const n=this.getCurrentRange();if(n){const s=document.createElement("a");s.href=t,s.text=e,s.className=`link-annotation ${m.H.LINK}`,s.setAttribute("data-blocktype",p.n.LINK),s.setAttribute("data-value",t),s.onclick=this.onClickAnchor,n.deleteContents(),n.insertNode(s),this.insertAndFocusCharacter(s)}}insertAndFocusCharacter(e,t=!1,n=x){if(this.range=this.getCurrentRange(),this.range){const s=document.createTextNode(n),i=t?"setStartBefore":"setStartAfter",o=t?"setEndBefore":"setEndAfter";this.range[i](e),this.range[o](e),this.range.insertNode(s),this.range.selectNodeContents(s),n!==x&&this.range.collapse(!1),this.applyRange()}}unlink(e){const t=e.parentNode,n=e.textContent;t&&(t.removeChild(e),n&&!(0,u.q)(n)&&this.execCommand("insertText",n))}execCommand(e,t){this.range&&(this.applyRange(),document.execCommand(e,!1,t),this.onSelectionChange())}applyRange(){if(this.range){const e=window.getSelection();e&&(e.removeAllRanges(),e.addRange(this.range))}}getAnchorFromSelection(){const e=this.getCurrentRange();if(!e)return null;let t=e.commonAncestorContainer;for(;t&&"A"!==t.nodeName;){if(t===this.getTextElement())return null;t=t.parentNode}return t||null}insertFocusNodeIfNeeded(){var e,t;const n=window.getSelection();if(!n||!this.range)return;const{anchorNode:s,isLinkNode:i}=this.tryGetAnchorNode();if(s){const o=null!==(t=null===(e=s.textContent)||void 0===e?void 0:e.length)&&void 0!==t?t:0,r=0===n.focusOffset&&o>0,a=null===s.nextSibling&&o===n.focusOffset&&i;(r||a)&&this.insertAndFocusCharacter(s,r)}}getCurrentRange(){const e=window.getSelection();if(e&&e.rangeCount>0){const t=e.getRangeAt(0),n=this.getTextElement();if(n&&(n===t.commonAncestorContainer||n.compareDocumentPosition(t.commonAncestorContainer)&Node.DOCUMENT_POSITION_CONTAINED_BY))return t}return null}sortWords(e){return e.sort(((e,t)=>e.text.toLowerCase()<t.text.toLowerCase()?-1:1))}tryGetAnchorNode(){var e;const t=this.getAnchorFromSelection();if(t&&t instanceof HTMLAnchorElement){const n=null===(e=t.dataset)||void 0===e?void 0:e.blocktype,s=n===p.n.USER||n===p.n.HASH,i=n===p.n.LINK;return{isSpecialNode:s,isLinkNode:i,anchorNode:s||i?t:null}}return{isSpecialNode:!1,isLinkNode:!1,anchorNode:null}}updateWordElement(e,t,n){const s=e.inputType.startsWith("delete"),i=window.getSelection(),o=this.startTokens;if(!this.wordElement||this.wordElement.parentElement){if(t&&n&&n.parentElement&&i){const e=n.textContent||"";if(!o.includes(e[0]||""))return void this.clearWordElement();const t=e.substr(0,i.focusOffset),r=i&&i.focusOffset<e.length,a=s||r;if(this.wordElement=n,this.wordToken=t[0],this.emailMention=this.isEmailMention(t),this.updateSuggestions(),this.range=this.getCurrentRange(),a&&this.range){this.range.selectNode(n);const s=this.range.extractContents();if(s&&s.firstElementChild&&s.firstElementChild instanceof HTMLElement){const n=e.substring(t.length),i=document.createTextNode(n);s.firstElementChild.innerText=t,s.firstElementChild.classList.remove("link-annotation-active"),s.firstElementChild.removeAttribute("data-value"),s.firstElementChild.removeAttribute("data-id"),s.appendChild(i),this.range.insertNode(s),this.range.setStartBefore(i),this.range.setEndBefore(i),this.range.collapse(!1),this.range.selectNodeContents(this.wordElement),this.range.collapse(!1),this.applyRange()}}}}else this.endWordMatching()}get startTokens(){const{hashtags:e,userMentions:t}=this.props,n=[];return t&&n.push("@"),e&&n.push("#"),n}fetchUserMatches(){const e=this.wordElement?this.wordElement.textContent:null;if(this.props.active&&this.wordToken&&e){const t=this.sanitizeForSearch(e,!0);this.context.commandBinder.issueCommand(new h.ly(t)).then((()=>{this.updateSuggestions()}))}}filterSuggestions(){const{wordToken:e,wordElement:t}=this;if(e&&t&&t.textContent){const e=this.sanitizeForSearch(t.textContent),n=this.getMatches(e),s=n.length>0?0:-1;this.setState({matches:n,activeMatch:s})}}sanitizeForSearch(e="",t){if(!this.wordToken)return e;let n=(e.startsWith(this.wordToken)?e.substr(1):e).toLowerCase().trim().replace(/\s\s+/g," ");if(t){const e=/([^\s]+)/.exec(n);n=e&&e[0]||""}return n}getMatches(e){const{sortedSuggestions:t=[]}=this.state,n=this.sanitizeForSearch(e)||"";return 0===n.length?t:t.filter((e=>{let t=0===this.sanitizeForSearch(e.text).indexOf(n);return!t&&"@"===this.wordToken&&e.value&&(t=0===this.sanitizeForSearch(e.value).indexOf(n)),t}))}chooseMatch(e,t,n){const s=this.wordElement;if(s){const i=this.wordToken&&!e.startsWith(this.wordToken)?this.wordToken:"";s.innerText=`${i}${e}`,s.classList.add("link-annotation-active"),t&&s.setAttribute("data-value",t),n&&s.setAttribute("data-id",n),this.finishWordElement(!1,!0),this.props.onInput(this.getMarkdown())}}updateSuggestions(){const{wordToken:e}=this,{hashtags:t,userMentions:n}=this.props;let s=[];if("#"===e&&t)s=this.sortWords(t.map((e=>({text:e,blockType:p.n.HASH}))));else if("@"===e&&n){const e=this.context.userData.getKnownUsers();s=this.sortWords(e.map((e=>({text:e.name,id:e.id,value:e.email,blockType:p.n.USER}))))}this.setState({sortedSuggestions:s},this.filterSuggestions)}endWordMatching(){this.setState({matches:[],activeMatch:-1}),this.wordToken=null,this.wordElement=null,this.emailMention=!1}createWordElement(e){const t=window.getSelection(),n=this.range;if(!n||!t||!this.wordToken)return;const s=document.createElement("a");s.removeAttribute("href"),s.innerText=e,"#"===this.wordToken?(s.className=`link-annotation ${m.H.HASH}`,s.setAttribute("data-blocktype",p.n.HASH)):"@"===this.wordToken&&(s.className=`link-annotation ${m.H.USER}`,s.setAttribute("data-blocktype",p.n.USER));const i=n.startContainer,o=n.startOffset,r=n.endOffset+e.length,a=Math.max(0,(i.textContent||"").length);try{n.setStart(i,Math.min(o,a)),n.setEnd(i,Math.min(r,a))}catch(e){n.selectNodeContents(i)}n.deleteContents(),n.insertNode(s),n.selectNodeContents(s),n.collapse(!1),this.applyRange(),this.wordElement=s}clearWordElement(){const e=this.range,t=window.getSelection();e&&t&&this.wordElement&&this.wordToken&&(this.stripAnchorFromNode(this.wordElement),this.endWordMatching())}stripAnchorFromNode(e){const t=this.range;if(!t)return;const n=e.textContent;if(this.focus(),t.selectNode(e),t.deleteContents(),t.collapse(!1),n){const e=document.createTextNode(n);t.insertNode(e),t.selectNodeContents(e),t.collapse(!1)}this.applyRange()}isValidSpecialWord(e,t){return 0!==this.sanitizeForSearch(t).length||(this.clearWordElement(),!1)}finishWordElement(e,t){const{range:n,wordElement:s,wordToken:i}=this,o=window.getSelection();if(!(n&&o&&s&&i))return;s.contentEditable="true",s.classList.add("link-annotation-active");let r="";const a=s.textContent;if(this.isValidSpecialWord(i,a||"")){if(e&&a&&a.length>1?(r=a.charAt(a.length-1),s.textContent=a.slice(0,-1)):t&&(r=" "),this.focus(),n.setStartAfter(s),r){const e=document.createTextNode(r);n.insertNode(e),n.selectNodeContents(e),n.collapse(!1)}this.applyRange(),this.endWordMatching()}else this.clearWordElement()}renderMatch(e,t){const{activeMatch:n}=this.state,i=t===n,o=e.blockType===p.n.USER,a=o&&e.value?this.context.userData.getUserDisplay(e.value):null,c=o?e.value:void 0,l=`${e.text}-${t}`;return(0,s.jsxs)("div",{className:r()("suggestion",{selected:i}),onMouseDown:this.onClickMatch,onMouseEnter:this.onHoverMatch,"data-value":e.value,"data-id":e.id,"data-text":e.text,"data-index":t,children:[o&&a&&(0,s.jsx)(g.E,{badgeStyle:{color:a.color,borderColor:a.color,backgroundColor:"transparent"},label:a.initials}),(0,s.jsx)("span",{className:"suggestion-text",children:e.text}),c&&(0,s.jsxs)("p",{className:"suggestion-hint",children:["(",c,")"]})]},l)}renderMatches(){if(!this.props.active)return null;const{matches:e}=this.state,t=e.length>0;return(0,s.jsx)("div",{className:r()("suggestion-menu",{open:t}),ref:this.bindSuggestionMenuRef,children:t&&e.map(((e,t)=>this.renderMatch(e,t)))})}render(){const{text:e,textParser:t,clickToEdit:n,placeholder:i,tabIndex:o,className:a,active:c}=this.props;return(0,s.jsxs)("div",{className:r()("smart-text-box",a),children:[(0,s.jsx)(f.A,{ref:this.saveRef,text:e,textParser:t,active:c,placeholder:i,tabIndex:o,clickToEdit:n&&!c,onClick:this.onClick,onInput:this.onInput,onKeyDown:this.onKeyDown,onBlur:this.onBlur,onFocus:this.handleFocus,onClickAnchor:this.onClickAnchor}),this.renderMatches()]})}};y.contextType=a.B,y=v([c.F,E("design:paramtypes",[Object])],y)},71344:(e,t,n)=>{"use strict";n.d(t,{A:()=>m});var s=n(74848),i=n(96540),o=n(32485),r=n.n(o),a=n(72909),c=n(77570),l=n(71397),d=n(50178),u=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},h=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let p=class extends i.Component{constructor(e){super(e),this.textElement=(0,i.createRef)(),this.editing=!1,this.isUnmounting=!1,this.stopPropagation=e=>e.stopPropagation(),this.onPaste=e=>{if(!e.clipboardData||!this.textElement.current)return;let t=e.clipboardData.getData("text/plain");t=this.props.textParser.sanitizeText(t),e.preventDefault(),t&&document.execCommand("insertText",!1,t)},this.onKeyDown=e=>{if(!this.textElement.current)return;const{onKeyDown:t}=this.props;(e.which||e.keyCode)===l.D.RETURN&&(e.shiftKey||e.altKey)?document.execCommand("insertText",!1,"\n"):t&&t(e)},this.onMouseDown=e=>{const{onClick:t,clickToEdit:n,readonly:s}=this.props;t&&(e.stopPropagation(),t(e)),s||!this.editing&&n&&this.toggleEditing(!0)},this.onFocus=e=>{this.textElement.current&&(this.context.messageBus.broadcast(new d.Yl(this.textElement.current,!0)),this.props.onFocus&&this.props.onFocus(e))},this.onBlur=e=>{this.textElement.current&&(this.context.messageBus.broadcast(new d.Yl(this.textElement.current,!1)),this.props.onBlur&&this.props.onBlur(e))}}componentDidMount(){this.replaceTextContent(this.props.text)}componentWillUnmount(){this.isUnmounting=!0,this.textElement.current&&this.textElement.current.blur()}componentDidUpdate(e){const{text:t,active:n}=this.props;t===e.text&&n===e.active||this.replaceTextContent(t)}shouldComponentUpdate(){return!1}getTextElement(){return this.textElement.current}getPlainText(){var e;return(null===(e=this.textElement.current)||void 0===e?void 0:e.innerText)||""}focus(){this.editing&&this.textElement.current&&this.textElement.current.focus()}toggleEditing(e,t=!0){clearTimeout(this.toggleEditingTimeout),this.toggleEditingTimeout=window.setTimeout((()=>{this.textElement.current&&!this.isUnmounting&&(this.editing!==e&&(this.editing=e,this.textElement.current.contentEditable=e?"true":"false",e?this.textElement.current.classList.add("editing"):this.textElement.current.classList.remove("editing")),e&&t?this.textElement.current.focus():this.textElement.current.blur())}),0)}replaceTextContent(e){clearTimeout(this.replaceTextContentTimeout),this.replaceTextContentTimeout=window.setTimeout((()=>{if(!this.textElement.current||this.isUnmounting)return;for(;this.textElement.current.firstChild;)this.textElement.current.removeChild(this.textElement.current.firstChild);const t=document.createDocumentFragment(),{textParser:n,markers:s,onClickAnchor:i,active:o,readonly:r,maxLength:a,clickableLinks:c}=this.props,l=void 0!==c?c:!o,d=n.deserialize(e,l,i,s);let u=0,h=!d.every((e=>{var n;const s=(null===(n=e.textContent)||void 0===n?void 0:n.length)||0;if(r&&a&&u+s>a){if("#text"===e.nodeName){const n=e.textContent||"";e.textContent=n.substring(0,a-u),t.appendChild(e)}return!1}return!r&&o&&"A"===e.nodeName&&(e.contentEditable="true"),u+=s,t.appendChild(e),!0}));h&&t.appendChild(document.createTextNode("...")),this.textElement.current.appendChild(t),this.focus(),r&&!h&&this.props.maxLines&&this.textElement.current.scrollHeight>this.textElement.current.offsetHeight&&(h=!0,this.textElement.current.appendChild(document.createTextNode("..."))),this.props.onTextReplaced&&this.props.onTextReplaced(h)}),0)}render(){const{placeholder:e,tabIndex:t,onInput:n,readonly:i,maxLines:o,text:a}=this.props,c=i&&o,l=c?{WebkitLineClamp:o}:{},d=r()("text-box-text",{clamped:c,placeholder:!!e&&!a});return(0,s.jsx)("div",{ref:this.textElement,className:d,style:l,role:"textbox",draggable:!1,spellCheck:!0,contentEditable:!1,placeholder:e,"aria-label":e,onMouseDown:this.onMouseDown,onKeyDown:i?void 0:this.onKeyDown,onKeyUp:i?void 0:this.stopPropagation,onFocus:i?void 0:this.onFocus,onBlur:i?void 0:this.onBlur,onInput:i?void 0:n,onPaste:i?void 0:this.onPaste,tabIndex:t})}};p.contextType=c.B,p=u([a.F,h("design:paramtypes",[Object])],p);const m=p},71188:(e,t,n)=>{"use strict";n.d(t,{w:()=>i});var s=n(12103);function i(e){return e.width<=s._8}},89244:(e,t,n)=>{"use strict";n.d(t,{q:()=>i});var s=new RegExp("^(?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z0-9\\u00a1-\\uffff][a-z0-9\\u00a1-\\uffff_-]{0,62})?[a-z0-9\\u00a1-\\uffff]\\.)+(?:[a-z\\u00a1-\\uffff]{2,}\\.?))(?::\\d{2,5})?(?:[/?#]\\S*)?$","i");const i=e=>(e=>s.test(e))(e)&&/^https?:\/\//.test(e)},18633:(e,t,n)=>{"use strict";n.d(t,{OR:()=>r,Zl:()=>a,v0:()=>o,v3:()=>i,vp:()=>c});var s=n(92475);class i extends s.E{constructor(e,t,n,s){super(),this.position=e,this.clientPosition=t,this.delta=n,this.buttons=s}}class o extends s.E{constructor(e,t,n,s,i){super(),this.position=e,this.clientPosition=t,this.delta=n,this.buttons=s,this.progress=i}}class r extends s.E{constructor(e,t,n){super(),this.position=e,this.clientPosition=t,this.buttons=n}}class a extends s.E{constructor(e,t,n){super(),this.position=e,this.clientPosition=t,this.buttons=n}}class c extends s.E{constructor(e,t,n){super(),this.position=e,this.clientPosition=t,this.cancelled=n}}},40036:(e,t,n)=>{"use strict";if(n.d(t,{U:()=>o,t:()=>r}),5602==n.j)var s=n(96622);if(5602==n.j)var i=n(66726);var o;!function(e){e.DISC_COLOR="disc_color",e.STEM_VISIBLE="stem_visible",e.STEM_LENGTH="stem_length",e.TITLE="title",e.DESCRIPTION="description",e.MEDIA="media",e.LINKS="links",e.ENABLED="enabled",e.KEYWORDS="keywords"}(o||(o={}));class r{constructor(){this.handlers=[{msgType:s.Y_,func:(e,t)=>{const n={mattertag_sid:t.sid,mattertag_position:t.position,mattertag_distance_from_camera:t.distanceFromCamera};e.track("mattertag_add",n)}},{msgType:s.Fj,func:(e,t)=>{const n={mattertag_sid:t.sid,mattertag_remove_method:t.removeMethod};e.track("mattertag_remove",n)}},{msgType:s.On,func:(e,t)=>{const n={mattertag_sid:t.sid,mattertag_character_count:t.characterCount};e.track("mattertag_add_title",n)}},{msgType:s.GN,func:(e,t)=>{const n={mattertag_sid:t.sid,mattertag_character_count:t.characterCount};let s=1;t.tagDescriptionChunks.forEach((e=>{"link"===e.type&&void 0!==e.link&&(n["mattertag_link_domain"+s++]=(0,i.SE)(e.link.url))})),e.track("mattertag_add_description",n)}},{msgType:s.KW,func:(e,t)=>{const n={mattertag_sid:t.sid,mattertag_property:t.property,mattertag_value:t.value};e.track("mattertag_edit",n)}},{msgType:s.oO,func:(e,t)=>{const n={mattertag_sid:t.sid,mattertag_position:t.position,mattertag_distance_from_camera:t.distanceFromCamera,mattertag_distance_moved:t.distanceMoved};e.track("mattertag_moved",n)}},{msgType:s.EX,func:(e,t)=>{const n={mattertag_sid:t.sid,media_type:t.mediaType,media_src:t.mediaSrc};e.track("mattertag_add_media",n)}}]}}},96622:(e,t,n)=>{"use strict";n.d(t,{EX:()=>c,Fj:()=>o,GN:()=>a,KW:()=>l,On:()=>r,Y_:()=>i,oO:()=>d});var s=n(89103);class i extends s.QB{constructor(e,t,n){super(),this.sid=e,this.position=t,this.distanceFromCamera=n}}class o extends s.QB{constructor(e,t){super(),this.sid=e,this.removeMethod=t}}class r extends s.QB{constructor(e,t){super(),this.sid=e,this.characterCount=t}}class a extends s.QB{constructor(e,t,n){super(),this.sid=e,this.characterCount=t,this.tagDescriptionChunks=n}}class c extends s.QB{constructor(e,t,n){super(),this.sid=e,this.mediaType=t,this.mediaSrc=n}}class l extends s.QB{constructor(e,t,n){super(),this.sid=e,this.property=t,this.value=n}}class d extends s.QB{constructor(e,t,n,s){super(),this.sid=e,this.position=t,this.distanceFromCamera=n,this.distanceMoved=s}}},32502:(e,t,n)=>{"use strict";var s;n.d(t,{f:()=>s}),function(e){e[e.Standard=0]="Standard",e[e.Depth=1]="Depth",e[e.Transparent=2]="Transparent",e[e.Wireframe=3]="Wireframe",e[e.UV=4]="UV",e[e.CeilingSample=5]="CeilingSample",e[e.FloorSample=6]="FloorSample"}(s||(s={}))},86406:(e,t,n)=>{"use strict";n.d(t,{b:()=>o});var s=n(84710),i=n(12554);class o extends s.B{constructor(){super(...arguments),this.name="hashtag-data",this.hashtags=(0,i.Z)([])}addHashtags(e){this.atomic((()=>{e.forEach((e=>{this.addHashtag(e)}))}))}addHashtag(e){const t=e.trim().toLowerCase();-1===this.hashtags.map((e=>e.trim().toLowerCase())).indexOf(t)&&this.hashtags.push(e)}getHashtags(){return this.hashtags.values()}}},89416:(e,t,n)=>{"use strict";var s;n.d(t,{f:()=>s}),function(e){e.CLOSED="closed",e.IDLE="idle",e.CREATING="creating",e.OPENING="opening",e.OPEN="open",e.EDITING="editing"}(s||(s={}))},78450:(e,t,n)=>{"use strict";n.d(t,{b:()=>d});var s=n(84710),i=n(95330),o=n(56413),r=n(42743),a=n(89416),c=n(3184),l=n(25727);class d extends s.B{constructor(e,t,n,s){super(),this.data=e,this.textParser=t,this.linkHandler=n,this.backgroundTexture=s,this.name="notes-view-data",this.noteViewsMap=(0,o.y)(),this.isNewNote=!1,this.openNoteViewObservable=(0,i.p)(null),this.focusedCommentObservable=(0,i.p)(null),this.activeNotationObservable=(0,i.p)(null),this.idVisibilityEnabled=!1,this.idVisibility=new Set,this.notesPhaseObservable=(0,i.p)(a.f.CLOSED),this.notesFilterObservable=(0,i.p)(c.S.OPEN),this.updateNoteViews=()=>{const e={};this.data.iterate((t=>{var n;const s=this.createNoteView(t);e[t.id]=s,(null===(n=this.openNoteView)||void 0===n?void 0:n.id)===s.id&&this.setOpenNoteView(s)})),this.noteViewsMap.replace(e)},this.sortByDate=(e,t)=>t.lastCommentMs-e.lastCommentMs,this.filterByResolved=e=>this.notesFilter===c.S.ALL||e.resolved===(this.notesFilter===c.S.RESOLVED),this.noteViews=new r.q(this.noteViewsMap),this.noteViews.priority=r.g.LOW,this.notesFilter!==c.S.ALL&&this.noteViews.setFilter(this.notesFilter,this.filterByResolved),this.noteViews.sort(this.sortByDate),this.updateNoteViews()}getFilteredNotesMap(){return this.noteViews}getNoteViewsMap(){return this.noteViewsMap}getNoteView(e){return this.noteViewsMap.get(e)}getTextParser(){return this.textParser}getLinkHandler(){return this.linkHandler}getComment(e,t){const n=this.getNoteView(e);return(null==n?void 0:n.comments.find((e=>e.id===t)))||null}getReply(e,t){const n=this.getNoteView(e);return(null==n?void 0:n.comments.find(((e,n)=>n>0&&e.id===t)))||null}getAttachment(e,t,n){var s;const i=(null===(s=this.getNoteView(e))||void 0===s?void 0:s.comments.find((e=>e.id===t)))||null;return(null==i?void 0:i.attachments.find((e=>e.id===n)))||null}createNoteView(e){return Object.assign(Object.assign({},e),{backgroundTexture:this.backgroundTexture,icon:l.tf[l.yY.NOTE]})}getCommentUserMentions(e,t){const n=[];return this.textParser.getUserMentions(e).forEach((e=>{const s=t[e];s&&n.push(s)})),n}getNoteAttachments(e){const t=[],n=this.getNoteView(e);return n&&n.comments.forEach((e=>{t.push(...e.attachments)})),t}getPendingNote(){return this.isNewNote&&this.openNoteView?this.openNoteView:null}setNotesPhase(e){this.notesPhaseObservable.value=e}get notesPhase(){return this.notesPhaseObservable.value}onNotesPhaseChanged(e){return this.notesPhaseObservable.onChanged(e)}setNotesFilter(e){const t=this.notesFilterObservable.value;this.notesFilterObservable.value=e,this.noteViews.atomic((()=>{this.noteViews.clearFilter(t),e!==c.S.ALL&&this.noteViews.setFilter(e,this.filterByResolved)}))}get notesFilter(){return this.notesFilterObservable.value}onNotesFilterChanged(e){return this.notesFilterObservable.onChanged(e)}setActiveNotation(e){this.activeNotationObservable.value=e}get activeNotation(){return this.activeNotationObservable.value}onActiveNotationChanged(e){return this.activeNotationObservable.onChanged(e)}setOpenNoteView(e){this.openNoteViewObservable.value=e}get openNoteView(){return this.openNoteViewObservable.value}onOpenNoteViewChanged(e){return this.openNoteViewObservable.onChanged(e)}resetOpenNoteView(){const e=this.openNoteView;if(e){const t=this.data.getNoteProperties(e.id);t&&this.updateOpenNoteView(t)}}updateOpenNoteView(e){const t=this.openNoteView;t&&Object.assign(t,e)}setFocusedComment(e){this.focusedCommentObservable.value=e}get focusedComment(){return this.focusedCommentObservable.value}onFocusedCommentChanged(e){return this.focusedCommentObservable.onChanged(e)}}},3184:(e,t,n)=>{"use strict";var s,i;n.d(t,{D:()=>i,S:()=>s}),function(e){e.OPEN="open",e.RESOLVED="resolved",e.ALL="all"}(s||(s={})),function(e){e.DEFAULT="default",e.HIGHLIGHTED="highlighted",e.DIMMED="dimmed"}(i||(i={}))},4508:(e,t,n)=>{"use strict";n.d(t,{V:()=>d});var s=n(74848),i=n(56147),o=n(39869),r=n(95143),a=n(29397),c=n(55666);const{NOTES:l}=i.A.SHOWCASE;function d({userName:e,description:t,numAttachments:n,numComments:i,searchText:d}){const u=(0,a.V)(),h=(0,o.Y)(),p=i-1,m=(d?(0,r.x8)(e,d):e).trim(),f=h.t(l.REPLIES,p);let g="";return""===t?n>0?g=h.t(l.NUM_ATTACHMENTS,n):0===p&&(g=h.t(l.CONTENT_DELETED)):g=(d?(0,r.x8)(t,d):t).trim(),(0,s.jsxs)("div",{className:"item-details",children:[(0,s.jsxs)("div",{className:"item-header",children:[u&&(0,s.jsx)(c.L,{text:m.trim(),textParser:u,markers:r.S8}),p>0&&!d&&(0,s.jsx)("span",{className:"note-summary-info note-replies",children:f})]}),u&&(0,s.jsx)("div",{className:"item-description",children:(0,s.jsx)(c.L,{text:g,textParser:u,markers:r.S8,linksActive:!1})})]})}},28308:(e,t,n)=>{"use strict";n.d(t,{$:()=>S,B:()=>A});var s=n(74848),i=n(96540),o=n(56147),r=n(39869),a=n(13397),c=n(95541),l=n(48411),d=n(28479),u=n(87306),h=n(20263),p=n(21162),m=n(30129),f=n(8387),g=n(35137),v=n(45269),E=n(4508),x=(n(46313),n(38731)),y=n(90087),T=n(68375),b=n(35517);const{NOTES:C}=o.A.SHOWCASE,A=({item:e})=>e?(0,s.jsx)(S,{item:e},e.id):null,S=({item:e})=>{const t=(0,i.useRef)(null),n=(0,x.B)(),A=(0,T.s)(),S=(0,y.L)(),_=(0,r.Y)(),O=(0,c.H)(),N=(0,l.T)(),k=(0,h.r)(),w=(0,a.e)(),R=(0,d.L)(),L=(0,b.sG)(k),I=(0,b.zJ)(k),{id:j,title:P,description:M,color:D,resolved:H,numAttachments:U,numComments:V}=e,G=j,F=e.parentId;if(!F||!G)return null;const B=F===(null==k?void 0:k.id),W=H||!e.isLayerVisible(),K=_.t(C.EDIT_LIST_ITEM_OPTION_CTA),Y=_.t(C.DELETE_LIST_ITEM_OPTION_CTA),$=L||I?(0,s.jsx)(p.e,{children:(0,s.jsxs)(m.y,{ref:t,icon:"more-vert",ariaLabel:_.t(o.A.MORE_OPTIONS),variant:f.Ak.TERTIARY,menuArrow:!0,menuClassName:"search-result-menu",children:[(0,s.jsx)(f.$n,{label:K,size:f.Mp.SMALL,disabled:!L,variant:f.Ak.TERTIARY,onClick:()=>{A.trackGuiEvent("notes_list_edit_note",{tool:R}),S.issueCommand(new u.FV(F,!0,!0,G))}}),(0,s.jsx)(f.$n,{className:"menu-delete-btn",label:Y,size:f.Mp.SMALL,disabled:!I,variant:f.Ak.TERTIARY,onClick:()=>{A.trackGuiEvent("notes_list_delete_note",{tool:R}),S.issueCommand(new u.T0(F))}})]})}):void 0,z=(0,s.jsx)(E.V,{description:M,userName:P,numAttachments:U,numComments:V,searchText:w}),X=(0,s.jsx)(g.E,{badgeStyle:D?{backgroundColor:D,borderColor:D}:void 0,iconClass:"icon-comment"});return(0,s.jsx)(v.c,{id:G,className:"search-result-item notes-list-item",title:z,badge:X,active:B,disabled:W,onClick:async()=>{A.trackGuiEvent("search_item_note_click",{tool:R}),e.onSelect(n,N,O)},actions:$},G)}},34489:(e,t,n)=>{"use strict";n.d(t,{y:()=>T});var s=n(17084),i=n(73566),o=n(74381),r=n(78849),a=n(81459),c=n(23500),l=n(28475),d=n(57811),u=n(75522),h=n(78450),p=n(87306),m=n(89416),f=n(28308),g=n(56147),v=n(75778),E=n(32408),x=n(95439);const{NOTES:y}=g.A.SHOWCASE;class T{constructor(e,t){this.engine=e,this.settings=t,this.disabledAssets={[d.f]:!1,[l.RP]:!1,[c.s]:!1,[u.qE]:!1},this.settingsToggler=new a.U(this.settings,this.disabledAssets),this.initPromise=this.init()}async init(){const{market:e}=this.engine;[this.notesViewData,this.searchData]=await Promise.all([e.waitForData(h.b),e.waitForData(r.L)]),this.setSearchItemFC(!0)}async activate(){this.settingsToggler.toggle(!0),await this.initPromise,await this.engine.commandBinder.issueCommand(new p.I8(!0))}async deactivate(){await this.engine.commandBinder.issueCommand(new p.I8(!1)),this.settingsToggler.toggle(!1)}async dispose(){await this.initPromise,this.setSearchItemFC(!1)}setSearchItemFC(e){const t=this.searchData.getSearchDataTypeGroup(o.jM.NOTE);t&&(t.itemFC=e?f.$:void 0)}async deepLink(e){const t=(await this.engine.market.waitForData(h.b)).getNoteView(e);if(t)(0,E.zX)(this.settings,t,(t=>{this.engine.commandBinder.issueCommand(new p.FV(e,!0,!1,(0,v.EN)().comment,t))}));else{const e={messagePhraseKey:y.MISSING_MESSAGE,timeout:4e3,dismissesOnAction:!0};this.engine.commandBinder.issueCommand(new x.Q(e)),this.engine.commandBinder.issueCommandWhenBound(new s.yU(i.S0.NOTES,!0))}}async hasPendingEdits(){const{notesPhase:e,activeNotation:t}=this.notesViewData;switch(e){case m.f.IDLE:case m.f.CLOSED:case m.f.OPENING:return!1;case m.f.EDITING:case m.f.CREATING:return!0;default:return!!t}}}},19283:(e,t,n)=>{"use strict";n.d(t,{A:()=>U});var s=n(74848),i=n(73566),o=n(68419),r=n(78956),a=n(90087),c=n(43327),l=n(25727),d=n(89002),u=n(47013),h=n(74453),p=n(89416),m=n(87306),f=n(20263),g=n(98378),v=n(14326),E=n(70466),x=n(35517),y=n(53641),T=n(8387),b=n(4303),C=n(33837),A=n(96540),S=n(56147),_=n(64491),O=n(39869),N=n(40145),k=n(42556);const{NOTES:w}=S.A.SHOWCASE;function R(){const e=(0,A.useMemo)((()=>(0,_.C8)()),[]),t=(0,d.f)(),n=(0,N.w)(),i=(0,O.Y)(),o=t===l.ce.CREATING,r=t===l.ce.PLACING;let a=null;if(o||!n||!e&&r){const t=i.t(e?w.OVERLAY_ADD_TOUCH:w.OVERLAY_ADD_CLICK),s=i.t(e?w.OVERLAY_PLACE_TOUCH:w.OVERLAY_PLACE_CLICK);a=n?t:s}return a?(0,s.jsxs)(k.W,{children:[(0,s.jsx)("div",{className:"icon icon-notes"}),(0,s.jsx)("span",{className:"message",children:a})]}):null}var L=n(94413),I=n(58338),j=n(50989),P=n(15105),M=n(68375);const{NOTES:D}=S.A.SHOWCASE;function H({canEdit:e,canDelete:t}){const n=(0,A.useRef)(null),o=(0,M.s)(),c=(0,a.L)(),u=(0,g.m)(),h=(0,f.r)(),v=(0,E.g)(),x=(0,r.O)(),y=(0,d.f)(),b=(0,L.W)(),C=(0,O.Y)(),S=y!==l.ce.IDLE,_=u===p.f.EDITING,N=C.t(D.COLOR_STEM_TOOLTIP),k=C.t(D.DELETE_TOOLTIP),w=C.t(D.ADD_TOOLTIP),R=C.t(D.CANCEL_TOOLTIP),H=S?R:w,U=x===i.L$.SIDE_PANEL,V=S?I.R.CANCEL:I.R.ADD,G=S,F=U&&e&&!S?(0,s.jsx)(T.$n,{className:"action-button-outer",icon:"stem-height",variant:T.Ak.FAB,theme:"overlay",active:_,tooltip:N,onClick:()=>{c.issueCommand(new m.dz(!_))}}):void 0,B=U&&t&&!S?(0,s.jsx)(T.$n,{className:"action-button-outer",variant:T.Ak.FAB,theme:"overlay",icon:"delete",tooltip:k,onClick:()=>{h&&(o.trackToolGuiEvent("notes","notes_overlay_click_delete"),c.issueCommand(new m.T0(h.id)))}}):void 0;return(0,s.jsx)(P.E,{outerLeft:F,outerRight:B,children:(0,s.jsx)(j.A,{ref:n,addIcon:V,allowLayerChange:G,disabled:!b,onClick:()=>{S?v&&c.issueCommand(new m.eg):(o.trackToolGuiEvent("notes","notes_overlay_click_add"),c.issueCommand(new m.C0))},tooltip:H,nudgeDisabled:!0})})}function U(){const e=(0,a.L)(),t=(0,o.t)(),n=(0,r.O)(),A=(0,f.r)(),S=(0,g.m)(),_=(0,d.f)(),O=(0,u.E)(),N=(0,h.S)(),k=(0,v.O)(),w=(0,E.g)(),L=S===p.f.CLOSED,I=(0,c.f)(),j=(0,x.kc)(),P=(0,x.sG)(A),M=(0,x.zJ)(A);if(t||L)return null;const D=S===p.f.OPENING,U=S===p.f.EDITING,V=j&&!I&&!k,G=n===i.L$.SIDE_PANEL,F=_===l.ce.PRESSING,B=!!A&&!D,W=!G&&!w&&A&&P;return(0,s.jsxs)("div",{className:"overlay grid-overlay notes-overlay",children:[W&&(0,s.jsx)("div",{className:"overlay-top-right",children:(0,s.jsx)(T.$n,{icon:"stem-height",variant:T.Ak.FAB,theme:"overlay",disabled:!B,active:U,onClick:t=>{t.stopPropagation(),e.issueCommand(new m.dz(!U))}})}),(0,s.jsx)(R,{}),V&&(0,s.jsx)(H,{canEdit:P,canDelete:M}),A&&G&&P&&(0,s.jsx)(b.n,{pin:A,id:A.id,pinType:l.yY.NOTE,onSave:t=>{A&&e.issueCommand(new m.Xc(A.id,t))},onClose:()=>{e.issueCommand(new m.dz(!1))},open:U,colors:y.Ay.colors,toolPanelLayout:n}),F&&(0,s.jsx)(C.z,{progress:O,screenPosition:N})]})}},24549:(e,t,n)=>{"use strict";n.d(t,{_:()=>wt});var s=n(74848),i=n(96540),o=n(73566),r=n(68419),a=n(78956),c=n(58062),l=n(22213),d=n(20263),u=n(62834);var h=n(70466),p=n(90087),m=n(53289),f=n(54616),g=n(25727),v=n(51831),E=n(25296),x=n(58972),y=n(87306),T=n(89416),b=n(98378),C=n(53641),A=n(32485),S=n.n(A),_=n(45205),O=n(94799),N=n(68375),k=n(3101),w=n(71687),R=n(14326),L=n(80411);function I(e){const t=[];return e&&e.comments.forEach((e=>{t.push(...e.attachments)})),t}var j=n(35517),P=n(39869),M=n(74381);function D(){const e=(0,f.P)(),[t,n]=(0,i.useState)(e.getUsersWhoMayNeedAccess()||{});return(0,i.useEffect)((()=>{function t(){n(e.getUsersWhoMayNeedAccess()||{})}const s=e.onChanged(t);return t(),()=>s.cancel()}),[e]),t}var H=n(29397),U=n(24865),V=n(93388),G=n(98236),F=n(86406);const B=(0,G.v)(F.b);function W(){const e=B(),[t,n]=(0,i.useState)((null==e?void 0:e.getHashtags())||[]);return(0,i.useEffect)((()=>{if(!e)return()=>{};function t(){n((null==e?void 0:e.getHashtags())||[])}const s=e.onChanged(t);return t(),()=>{s.cancel()}}),[e]),t}var K=n(30129),Y=n(8387),$=n(35137),z=n(72909),X=n(77570),J=n(75742),q=n(67430),Q=n(40409),Z=n(81088),ee=n(20835),te=n(15684),ne=n(12640),se=n(10835),ie=n(21162),oe=n(20144),re=n(12648),ae=n(36220),ce=n(1415),le=n(56147),de=n(37049),ue=n(84130);const{EMBED:he}=le.A.WORKSHOP;function pe(e){const{parentType:t,parentId:n,onEmbed:i,onCancel:o}=e,a=(0,P.Y)(),c=(0,r.t)(),d=a.t(he.MEDIA_LINK_LABEL),u=c===l.a.MEDIA_EMBED_POPUP;return(0,s.jsx)(de.Q,{open:u,title:d,fullModal:!1,className:"media-embed-popup",onClose:o,children:(0,s.jsx)(ue.P,{parentId:n,parentType:t,onEmbed:i})})}var me=n(59150),fe=(n(44476),function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r}),ge=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const{ANNOTATIONS:ve}=le.A.SHOWCASE;let Ee=class extends i.Component{constructor(e){super(e),this.uploadTooltipTimeout=0,this.bindings=[],this.isUnmounting=!1,this.getAttachmentsState=()=>{if(!this.attachmentsData)return;const{active:e,parentId:t,parentType:n}=this.props;if(!e)return;return{pendingAttachments:this.attachmentsData.getPendingAttachmentsForAsset(t,n),removedAttachments:this.attachmentsData.getRemovedAttachmentsForAsset(t,n),failures:this.attachmentsData.failures.values,uploads:this.attachmentsData.uploads.values}},this.updateAttachments=()=>{const e=this.getAttachmentsState();e&&this.setState(e)},this.cancelEdits=()=>{this.props.onCancelEditing&&this.props.onCancelEditing()},this.saveEdits=()=>{this.onDoneEditing()},this.onDoneEditing=()=>{const{onDoneEditing:e}=this.props;if(e){const t=this.getMarkdown();e(t,""===t&&0===this.getAttachmentCount())}},this.onInput=e=>{this.setState({textChanged:e.trim()!==this.props.text,charCount:e.length})},this.openLinkEditor=()=>{!(this.props.openModal===l.a.LINK_EDITOR)&&this.textEditor&&(this.context.analytics.trackGuiEvent("annotation_open_link_editor",{tool:"notes"}),this.textEditor.prepareLinkForEdit())},this.onClickBlock=(e,t)=>{var n;const{active:s,annotationType:i,annotationId:o,linkHandler:r}=this.props,a=e.blockType;if(a===J.n.LINK&&s)this.setState({selectedBlock:e}),this.context.commandBinder.issueCommand(new Z.X(l.a.LINK_EDITOR,!0));else if(!s){if(a===J.n.LINK&&r&&e.value){t&&t.preventDefault();const s=(0,q.A)(e.value),{url:a,modelId:c,pose:l}=s;c?r.handler.openLink({fullLink:a,modelId:c}):l?(r.handler.openLink({fullLink:a,pose:l}),null===(n=this.annotationsModule)||void 0===n||n.closeAnnotation(o,i)):r.handler.openLink(a)}this.context.messageBus.broadcast(new Q.v(i,o,e))}},this.closeLinkEditor=async()=>(this.setState({selectedBlock:null}),this.context.commandBinder.issueCommand(new Z.X(l.a.LINK_EDITOR,!1))),this.onCancelLink=async()=>{await this.closeLinkEditor()},this.openEmbedEditor=()=>{this.context.analytics.trackGuiEvent("annotation_open_embed_editor",{tool:"notes"}),this.context.commandBinder.issueCommand(new Z.X(l.a.MEDIA_EMBED_POPUP,!0))},this.closeEmbedEditor=()=>{this.context.commandBinder.issueCommand(new Z.X(l.a.MEDIA_EMBED_POPUP,!1))},this.onRemoveLink=()=>{this.onSaveLink("","")},this.onSaveLink=(e,t)=>{this.props.openModal===l.a.LINK_EDITOR&&this.textEditor&&(this.setState({textChanged:!0}),this.textEditor.saveLink(e,t),this.closeLinkEditor())},this.onClickFileInput=()=>{const{active:e,onClickToEdit:t}=this.props;this.isAtMaxAttachments()?(window.clearTimeout(this.uploadTooltipTimeout),this.setState({showUploadTooltip:!0}),this.uploadTooltipTimeout=window.setTimeout((()=>{this.setState({showUploadTooltip:!1})}),2500)):!e&&t&&t()},this.onFileUpload=e=>{const{parentId:t,parentType:n}=this.props,s=Array.from(e),i=this.getAttachmentCount();e.length+i>te.iS&&s.splice(te.iS-i),this.attachmentsModule.uploadAttachments(t,n,s),this.edit()},this.onDrop=e=>{this.context.analytics.trackGuiEvent("attachment_drag_and_dropped",{tool:"notes"}),this.onFileUpload(e)},this.onFilesChosen=e=>{this.context.analytics.trackGuiEvent("annotation_files_chosen",{tool:"notes"}),this.onFileUpload(e)},this.dropActivated=()=>{const{active:e,creating:t,onClickToEdit:n}=this.props;t&&!e&&n&&n()},this.setTextEditorRef=e=>this.textEditor=e,this.state={textChanged:!1,charCount:e.text.length,selectedBlock:null,showUploadTooltip:!1,pendingAttachments:[],removedAttachments:[],uploads:[],failures:[]}}componentDidMount(){this.context.market.waitForData(ee.v).then((e=>{this.attachmentsData=e,this.bindings.push(this.attachmentsData.onChanged(this.updateAttachments)),this.isUnmounting||this.updateAttachments()})),this.context.engine.getModuleBySymbol(w.Et).then((e=>{this.annotationsModule=e})),this.context.engine.getModuleBySymbol(w.qy).then((e=>{this.attachmentsModule=e}))}componentWillUnmount(){this.isUnmounting=!0,window.clearTimeout(this.uploadTooltipTimeout);for(const e of this.bindings)e.cancel()}componentDidUpdate(e,t){const{active:n,parentId:s,parentType:i}=this.props;e.active&&!n?this.setState({textChanged:!1,pendingAttachments:[],removedAttachments:[],uploads:[],failures:[]}):s===e.parentId&&i===e.parentType||this.updateAttachments()}edit(){this.textEditor&&this.textEditor.toggleEditing(!0)}focus(){this.textEditor&&this.textEditor.focus()}getMarkdown(){let e;return e=this.textEditor?this.textEditor.getMarkdown():this.props.text,e.trim()}getAttachmentCount(){const{attachments:e}=this.props,{pendingAttachments:t,removedAttachments:n,uploads:s}=this.state;return e.length+t.length+s.length-n.length}isAtMaxAttachments(){return this.getAttachmentCount()>=te.iS}inEmptyState(){const{active:e,text:t}=this.props;return!e&&""===t.trim()&&0===this.getAttachmentCount()}renderButtonBar(){const{active:e,creating:t,parentId:n,maxLength:i}=this.props;if(!e)return null;const{pendingAttachments:o,removedAttachments:r,textChanged:a,charCount:c,uploads:l,showUploadTooltip:d}=this.state,u=this.isAtMaxAttachments(),h=a||r.length>0||o.length>0,p=l.length>0,m=!u&&!p,f=h&&e&&!p&&!(i&&c>i),g=u?ae.Df.DIMMED:p?ae.Df.DISABLED:ae.Df.ENABLED,v=this.context.locale.t(u?ve.MAX_ATTACHMENTS_TOOLTIP:ve.UPLOAD_TOOLTIP,te.iS),E=this.context.locale.t(u?ve.MAX_ATTACHMENTS_TOOLTIP:ve.EMBED_TOOLTIP,te.iS),x=this.context.locale.t(t?ve.ADD_CTA:ve.SAVE_CTA),y=this.context.locale.t(ve.LINK_TOOLTIP),T=this.context.locale.t(ve.CANCEL_CTA);return(0,s.jsxs)("div",{className:"annotation-button-bar",children:[(0,s.jsxs)("div",{className:"annotation-editors",children:[(0,s.jsx)(se.e,{id:`${n}-annotation`,multi:!0,enabled:m,onUpload:this.onFilesChosen,children:(0,s.jsx)(ae.K0,{iconClass:"icon-attach",buttonStyle:ae.zt.PLAIN,buttonState:g,onClick:this.onClickFileInput,tooltipMsg:v,tooltipPersist:d})}),(0,s.jsx)(ae.K0,{iconClass:"icon-media-mix",buttonStyle:ae.zt.PLAIN,buttonState:g,tooltipMsg:E,onClick:this.openEmbedEditor}),(0,s.jsx)(ae.K0,{iconClass:"icon-add-link",buttonStyle:ae.zt.PLAIN,tooltipMsg:y,onClick:this.openLinkEditor})]}),(0,s.jsxs)(ie.e,{className:"annotation-cta-buttons",spacing:"small",children:[(0,s.jsx)(Y.$n,{variant:Y.Ak.TERTIARY,size:"small",onClick:this.cancelEdits,label:T},"cancel"),(0,s.jsx)(Y.$n,{variant:Y.Ak.TERTIARY,size:"small",disabled:!f,onClick:this.saveEdits,label:x},"save")]})]})}renderAttachments(){const{attachments:e,active:t,onViewAttachment:n,annotationType:i,parentId:o}=this.props,{pendingAttachments:r}=this.state,a=this.attachmentsData?e.filter((e=>!this.attachmentsData.removals.get(e.id))):e;if(r.forEach((e=>a.push(e))),t)return(0,s.jsx)(ne.E,{annotationType:i,parentId:o,canDelete:t,inline:t,attachments:a,onViewAttachment:n});const c=(a||[]).reduce(((e,t)=>{const n=(0,k.rV)(t)?"viewable":"nonViewable";return e[n]=[...e[n],t],e}),{viewable:[],nonViewable:[]});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ne.E,{annotationType:i,parentId:o,canDelete:t,inline:t,attachments:c.viewable,onViewAttachment:n}),(0,s.jsx)(ne.E,{annotationType:i,parentId:o,canDelete:t,inline:t,attachments:c.nonViewable,nonViewable:!0,onViewAttachment:n})]})}renderSmartEditor(){const{placeholder:e,hashtags:t,text:n,creating:i,textParser:o,active:r,maxLength:a,tabIndex:c,annotationType:l,onClickToEdit:d}=this.props,u=l===v.U.NOTE,h=this.inEmptyState()&&u&&!i?this.context.locale.t(ve.CONTENT_DELETED):e;return(0,s.jsx)(re.u,{ref:this.setTextEditorRef,textParser:o,text:n,active:!!r,clickToEdit:!!d,placeholder:h,onClickBlock:this.onClickBlock,onStartEditing:r?void 0:d,onDoneEditing:this.onDoneEditing,onCancelEditing:this.cancelEdits,onInput:this.onInput,tabIndex:c,maxLength:a,hashtags:t||[],userMentions:u})}render(){const{className:e,creating:t,active:n,parentId:i,parentType:o,annotationType:r,onClickToEdit:a,edited:c,title:l,maxLength:d}=this.props,{uploads:u,selectedBlock:h,charCount:p}=this.state,m=this.getAttachmentCount()<te.iS,f=!(u.length>0)&&(n||t)&&m,g=r===v.U.NOTE,E=this.inEmptyState()&&!t&&g,x=!n&&c&&!E,y={annotating:n,"editor-box":n||!!a,"annotation-emptied":E,invalid:n&&!!d&&p>d};let T="",b="";return h&&h.blockType===J.n.LINK&&(T=h.text,b=h.value||""),(0,s.jsxs)(oe.y,{className:"annotation-box",onDropped:this.onDrop,disabled:!f,onActivate:this.dropActivated,children:[l,(0,s.jsxs)("div",{className:S()("annotation-text-box",y,e),children:[this.renderSmartEditor(),n&&this.renderAttachments(),n&&this.renderButtonBar(),n&&d&&d-p<50&&(0,s.jsx)(me.w,{current:p,max:d})]}),x&&(0,s.jsx)("div",{className:"annotation-edited",children:"(edited)"}),!n&&!t&&this.renderAttachments(),n&&!!i&&(0,s.jsx)(pe,{parentId:i,parentType:o,onEmbed:this.closeEmbedEditor,onCancel:this.closeEmbedEditor}),n&&!!i&&(0,s.jsx)(ce.U,{linkText:T,linkUrl:b,onCancelLink:this.onCancelLink,onSaveLink:this.onSaveLink,onRemoveLink:this.onRemoveLink})]})}};Ee.contextType=X.B,Ee=fe([z.A,ge("design:paramtypes",[Object])],Ee);var xe=n(43457),ye=n(42329),Te=n(87193),be=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},Ce=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const{INVITE_USER:Ae,INVITE_BUTTON:Se,INVITE_USERS:_e,INVITE_VISIBLE_MSG:Oe}=le.A.USERS;let Ne=class extends i.Component{constructor(e){super(e),this.onInviteUsers=()=>{this.props.onInviteUsers(this.props.invitees)}}render(){const{invitees:e}=this.props;if(0===e.length)return null;const{locale:t}=this.context;let n;const i=t.t(Se,e.length);n=1===e.length?t.t(Ae,{email:e[0]}):t.t(_e,{emails:e.join(", ")});const o=t.t(Oe);return(0,s.jsxs)("div",{className:"user-invite-card",children:[(0,s.jsxs)("div",{className:"user-invite-info",children:[(0,s.jsx)("span",{className:"icon icon-eye-show"}),(0,s.jsx)("span",{className:"",children:o})]}),(0,s.jsx)("p",{className:"user-invite-msg",children:n}),(0,s.jsx)(Y.$n,{onClick:this.onInviteUsers,variant:Y.Ak.TERTIARY,className:S()("button-inline","user-invite-button"),label:i})]})}};Ne.contextType=X.B,Ne=be([z.A,Ce("design:paramtypes",[Object])],Ne);var ke=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},we=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const{INVITE_VISIBLE_MSG:Re,INVITE_USER_FAILED:Le,INVITE_USERS_FAILED:Ie}=le.A.USERS;let je=class extends i.Component{constructor(e){super(e)}render(){const{failedEmails:e}=this.props,{locale:t}=this.context;if(0===e.length)return null;let n;n=1===e.length?t.t(Le,{email:e[0]}):t.t(Ie,{failedEmails:e.join(", ")});const i=t.t(Re);return(0,s.jsxs)("div",{className:"user-invite-card",children:[(0,s.jsxs)("div",{className:"user-invite-info",children:[(0,s.jsx)("span",{className:"icon icon-eye-show"}),(0,s.jsx)("span",{className:"",children:i})]}),(0,s.jsx)("p",{className:"user-invite-msg",children:n})]})}};je.contextType=X.B,je=ke([z.A,we("design:paramtypes",[Object])],je);var Pe=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r};const{UNKNOWN_USER:Me,UNKNOWN_USERS:De,INVITE_VISIBLE_MSG:He}=le.A.USERS;let Ue=class extends i.Component{render(){const{locale:e}=this.context,{emails:t}=this.props;if(0===t.length)return null;let n;n=1===t.length?e.t(Me,{email:t[0]}):e.t(De,{emails:t.join(", ")});const i=e.t(He);return(0,s.jsxs)("div",{className:"user-invite-card",children:[(0,s.jsxs)("div",{className:"user-invite-info",children:[(0,s.jsx)("span",{className:"icon icon-eye-show"}),(0,s.jsx)("span",{className:"",children:i})]}),(0,s.jsx)("p",{className:"user-invite-msg",children:n})]})}};Ue.contextType=X.B,Ue=Pe([z.A],Ue);var Ve=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},Ge=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Fe=class extends i.Component{constructor(e){super(e),this.inviteUsers=async e=>{if(0===e.length)return;const{noteId:t,message:n}=this.props;await this.context.commandBinder.issueCommand(new ye.jl(e,n,C.NB,t))}}getInvitees(){const{userMentions:e}=this.props,t=[];return e.forEach((e=>{(e.userStatus===Te._.MENTIONED||e.userStatus===Te._.KNOWN&&e.modelAccess===M.OQ.PUBLIC)&&t.push(e.email)})),t}getFailedEmails(){const{userMentions:e}=this.props,t=[];return e.forEach((e=>{e.userStatus===Te._.FAILED&&t.push(e.email)})),t}render(){const{expires:e,noteId:t}=this.props;if((new Date).getTime()>e)return null;const{userData:n}=this.context,i=n.isInviter(),o=this.getInvitees(),r=this.getFailedEmails();return(0,s.jsxs)("div",{className:"user-mentions-unknown",children:[i&&o.length>0&&(0,s.jsx)(Ne,{invitees:o,modelAccess:C.NB,noteId:t,onInviteUsers:this.inviteUsers}),!i&&o.length>0&&(0,s.jsx)(Ue,{emails:o}),r.length>0&&(0,s.jsx)(je,{failedEmails:r})]})}};Fe.contextType=X.B,Fe=Ve([z.A,Ge("design:paramtypes",[Object])],Fe);var Be=n(5013);const{NOTES:We}=le.A.SHOWCASE;function Ke(e){const{comment:t,noteId:n,onCancel:o,onViewAttachment:c}=e,{user:l,created:d,edited:u,id:h,text:m}=t,g=(0,N.s)(),x=(0,p.L)(),T=(0,f.P)(),b=(0,Be.M)(),A=(0,P.Y)(),_=(0,r.t)(),O=(0,a.O)(),k=(0,i.useRef)(null),w=(0,H.V)(),L=(0,U.b)(),I=(0,V.Y)(),j=(0,R.O)(),G=W(),F=D();if(!I||!w)return null;function B(e){g.trackToolGuiEvent("notes",e)}const z=j===h,X=t.attachments.values(),J=!!b&&(0,E.q2)(T,b,v.U.NOTE,l),q=!!b&&(0,E.db)(T,b,v.U.NOTE,l),Q=t.modified.getTime()+60*C._d*1e3,Z=T.getUserDisplay(l.email),ee=Z.color,te=w.getPlainText(m),ne=I.getCommentUserMentions(m,F),se=!z&&(J||q)?(0,s.jsxs)(K.y,{icon:"more-vert",variant:Y.Ak.TERTIARY,ariaLabel:A.t(le.A.MORE_OPTIONS),menuArrow:!0,menuClassName:"search-result-menu",menuPlacement:"bottom-end",children:[J&&(0,s.jsx)(Y.$n,{label:A.t(We.EDIT),size:Y.Mp.SMALL,variant:Y.Ak.TERTIARY,onClick:()=>{k.current&&(B("notes_click_edit_comment"),x.issueCommand(new y.lf(t.id)),k.current.edit())}}),q&&(0,s.jsx)(Y.$n,{className:"menu-delete-btn",label:A.t(We.DELETE),size:Y.Mp.SMALL,variant:Y.Ak.TERTIARY,onClick:()=>{B("notes_click_delete_comment"),x.issueCommand(new y.IN(n,t.id))}})]}):null;return(0,s.jsxs)("div",{className:S()("comment",{active:z}),"data-id":h,children:[(0,s.jsxs)("div",{className:"note-header comment-header",children:[(0,s.jsx)($.E,{badgeStyle:{color:ee,borderColor:ee},label:Z.initials}),(0,s.jsxs)("div",{className:"note-details",children:[(0,s.jsx)("span",{className:"note-user",children:Z.name}),(0,s.jsx)("div",{className:"note-subheader",children:d.toLocaleString()})]}),se]}),J?(0,s.jsx)(Ee,{ref:k,textParser:w,linkHandler:L,annotationId:n,annotationType:v.U.NOTE,parentId:h,parentType:M.pi.COMMENT,attachments:X,active:z,edited:u,creating:!1,text:m,hashtags:G,toolPanelLayout:O,openModal:_,onViewAttachment:c,onDoneEditing:(e,s)=>{s?(B("notes_delete_empty_comment"),x.issueCommand(new y.IN(n,t.id)),o()):x.issueCommand(new y.er(n,t.id,e))},onCancelEditing:o,maxLength:C.u4}):(0,s.jsx)(xe.$,{text:m,textParser:w,linkHandler:L,annotationType:v.U.NOTE,annotationId:n,attachments:X,edited:u,onViewAttachment:c}),J&&ne.length>0&&(0,s.jsx)(Fe,{noteId:n,message:te,userMentions:ne,expires:Q})]})}const{NOTES:Ye}=le.A.SHOWCASE;function $e({noteId:e,replyId:t,active:n,onCancel:i,onReply:o}){const c=(0,P.Y)(),l=(0,N.s)(),d=(0,p.L)(),u=(0,r.t)(),h=(0,a.O)(),m=(0,H.V)(),f=(0,U.b)(),g=W();if(!m)return null;return(0,s.jsx)(Ee,{className:"reply-box",textParser:m,linkHandler:f,annotationType:v.U.NOTE,annotationId:e,parentType:M.pi.COMMENT,parentId:t,attachments:[],active:n,edited:!1,creating:!0,text:"",hashtags:g,toolPanelLayout:h,openModal:u,placeholder:c.t(Ye.REPLY_PLACEHOLDER),onClickToEdit:()=>{l.trackToolGuiEvent("notes","notes_click_new_comment"),d.issueCommand(new y.lf(t))},onDoneEditing:(e,n)=>{n?i():o(t,e)},onCancelEditing:i,maxLength:C.u4})}var ze=n(79457),Xe=n(95136);const{NOTES:Je}=le.A.SHOWCASE;function qe({note:e,active:t,onCancelNote:n}){const i=(0,N.s)(),o=(0,p.L)(),r=(0,f.P)(),a=(0,h.g)(),c=(0,P.Y)(),l=e.comments.get(0);function d(e){i.trackToolGuiEvent("notes",e)}const u=(0,j.sG)(e),m=(0,j.zJ)(e),g=r.getUserDisplay(e.user.email),v=g.color,E=!a&&!t,x=E&&m,T=E&&!e.resolved,b=E&&e.resolved,C=!a&&(u||b||x)?(0,s.jsxs)(K.y,{icon:"more-vert",ariaLabel:c.t(le.A.MORE_OPTIONS),variant:Y.Ak.TERTIARY,menuArrow:!0,menuClassName:"search-result-menu",menuPlacement:"bottom-end",children:[u&&(0,s.jsx)(Y.$n,{label:c.t(Je.EDIT),size:Y.Mp.SMALL,variant:Y.Ak.TERTIARY,onClick:()=>{d("notes_click_edit_note"),l&&o.issueCommand(new y.lf(l.id))}}),b&&(0,s.jsx)(Y.$n,{label:c.t(Je.UNRESOLVE),size:Y.Mp.SMALL,variant:Y.Ak.TERTIARY,onClick:()=>{d("notes_click_unresolve_note"),o.issueCommand(new y.kr(e.id,!1))}}),x&&(0,s.jsx)(Y.$n,{className:"menu-delete-btn",label:c.t(Je.DELETE),size:Y.Mp.SMALL,variant:Y.Ak.TERTIARY,onClick:()=>{d("notes_click_delete_note"),o.issueCommand(new y.T0(e.id))}})]}):null,A=c.t(Je.MARK_AS_RESOLVED);return(0,s.jsxs)("header",{className:"note-header",children:[(0,s.jsx)($.E,{badgeStyle:{color:v,borderColor:v},label:g.initials}),(0,s.jsxs)("div",{className:"note-details",children:[(0,s.jsx)("span",{className:"note-user",children:g.name}),(0,s.jsx)("div",{className:"note-subheader",children:e.created.toLocaleString()})]}),(0,s.jsxs)(ie.e,{spacing:"small",children:[a&&(0,s.jsx)(Y.$n,{icon:"close",tooltip:c.t(Je.CANCEL),onClick:n,tooltipOptions:{placement:"bottom-end"}}),T&&(0,s.jsx)(Y.$n,{icon:"checkmark",size:Y.Mp.SMALL,variant:Y.Ak.FAB,theme:"dark",tooltip:A,onClick:()=>{d("notes_click_resolve_note"),o.issueCommand(new y.kr(e.id,!0))}}),E&&(0,s.jsx)(Xe.k,{prefix:"note",pin:e,id:e.id,darkTheme:!0,analyticAction:"copy_note_share_link",includeCameraView:!0}),C]})]})}const{NOTES:Qe}=le.A.SHOWCASE;function Ze({note:e,onViewAttachment:t,onCancel:n}){var o;const c=(0,p.L)(),l=(0,P.Y)(),d=(0,r.t)(),u=(0,a.O)(),g=(0,f.P)(),E=D(),x=(0,i.useRef)(null),T=(0,V.Y)(),b=(0,R.O)(),A=(0,h.g)(),S=W(),_=(0,H.V)(),O=(0,U.b)(),N=(0,j.sG)(e),k=e.comments.get(0),w=null==k?void 0:k.id,L=!!b&&(b===w||A),I=e.id,G=(0,i.useCallback)((()=>{x.current&&b===I&&x.current.edit()}),[b,I]);if((0,m.J)(ze.wk,(()=>{A&&G()})),(0,i.useEffect)((()=>{L&&G()}),[L,G]),!T||!_)return null;const F=(null===(o=null==k?void 0:k.attachments)||void 0===o?void 0:o.values())||[],B=(null==k?void 0:k.text)||"",K=(null==k?void 0:k.edited)||!1,Y=(null==k?void 0:k.modified.getTime())+60*C._d*1e3,$=e.user.id===g.getCurrentUserId(),z=_.getPlainText(B),X=T.getCommentUserMentions(B,E),J=L?l.t(Qe.ADD_NOTE_MESSAGE):void 0;return(0,s.jsxs)("div",{className:"note-post",children:[(0,s.jsx)(qe,{note:e,active:L,onCancelNote:n}),N?(0,s.jsx)(Ee,{ref:x,textParser:_,linkHandler:O,annotationId:I,annotationType:v.U.NOTE,parentId:w||I,parentType:M.pi.COMMENT,attachments:F,active:L,edited:K,creating:A,text:B,hashtags:S,placeholder:J,toolPanelLayout:u,openModal:d,onViewAttachment:t,onDoneEditing:async(e,t)=>{t?n():A?await c.issueCommand(new y.x7(e)):await c.issueCommand(new y.iT(I,e))},onCancelEditing:n,maxLength:C.KZ}):(0,s.jsx)(xe.$,{text:B,textParser:_,linkHandler:O,annotationType:v.U.NOTE,annotationId:I,attachments:F,edited:K,onViewAttachment:t}),!A&&k&&$&&X.length>0&&(0,s.jsx)(Fe,{message:z,noteId:I,expires:Y,userMentions:X})]})}function et({note:e}){const t=(0,N.s)(),n=(0,O.j)(w.qy),o=(0,p.L)(),r=(0,R.O)(),a=(0,h.g)(),c=function(e){const t=(0,L.Z)(e),[n,s]=(0,i.useState)(I(t));return(0,i.useEffect)((()=>{if(!t)return()=>{};function e(){s(I(t))}const n=t.comments.onChanged(e);return e(),()=>{n.cancel()}}),[t]),n}(e.id),[l,d]=(0,i.useState)((0,_.D)(11)),u=()=>{o.issueCommand(new y.up)},m=e=>{if(c.length){t.trackToolGuiEvent("notes","notes_click_view_attachment");const s=c.filter((e=>(0,k.rV)(e)));s.length>0&&n.toggleAttachmentViewer(!0,s,e)}},f={annotating:!!r,creating:a},g=r===l,v=(0,j.Wu)(),E=!a&&v&&(g||!r);return(0,s.jsxs)("div",{className:S()("note-widget",f),children:[e&&(0,s.jsx)(Ze,{note:e,onViewAttachment:m,onCancel:()=>{a?o.issueCommand(new y.eg):r&&u()}}),!a&&(0,s.jsx)("div",{className:"note-comments",children:e.comments.map(((t,n)=>0===n?null:(0,s.jsx)(Ke,{noteId:e.id,comment:t,onCancel:u,onViewAttachment:m},t.id)))}),E&&(0,s.jsx)($e,{replyId:l,noteId:e.id,active:g,onCancel:()=>{u(),d((0,_.D)(11))},onReply:(t,n)=>{o.issueCommand(new y.YC(e.id,n,t)),d((0,_.D)(11))}})]})}var tt=n(96064),nt=n(4303),st=n(17084),it=n(75200),ot=n(95330),rt=n(22044);const at=(0,ot.p)(!1);function ct(e){at.value=e}function lt(){return[(0,rt.A)(at),ct]}var dt=n(13893),ut=n(64695),ht=n(80700),pt=n(70401);function mt(e){const{analyticAction:t}=e,n=(0,N.s)(),i=(0,p.L)(),o=(0,ut.W)(),r=(0,d.r)(),a=(0,ht.e)(null==r?void 0:r.id),[c,l]=lt();if(!(r&&o.length>1))return null;const u=o.findIndex((e=>{const t=e.id,n=e.parentId;return n&&n===(null==r?void 0:r.id)&&(!a||t===(null==a?void 0:a.id))}));return(0,s.jsx)(pt.r,{index:u,total:o.length,disabled:c,wrapAround:!0,onNavigate:e=>{const s=o[e];if(!s)return;const a=s.id,c=s.parentId;if(!a||!c)return;l(!0);const d=r?null:dt.fl.Interpolate;n.trackToolGuiEvent("notes",t),i.issueCommand(new y.FV(c,!0,!1,a,d)).then((()=>{l(!1)}))}})}var ft=n(98715);const{NOTES:gt}=le.A.SHOWCASE;function vt(){const e=(0,R.O)(),t=(0,p.L)(),n=(0,P.Y)(),i=(0,c.k)(),r=(0,it.c)(),[a]=lt(),l=i&&r&&(r===o.S0.SEARCH||r===o.S0.LAYERS),d=l||!i,u=!e&&!l,h=d?n.t(gt.NAV_BACK):n.t(gt.NAV_CLOSE),m=d?"back":"close";return(0,s.jsxs)("div",{className:"detail-panel-header",children:[(0,s.jsx)(ft.J,{icon:m,label:h,onClose:()=>{a||(l?t.issueCommand(new st.kC).then((()=>{t.issueCommand(new st.oe(!1))})):i?t.issueCommand(new st.u3(o.S0.NOTES)):t.issueCommand(new y.sL))}}),u&&(0,s.jsx)(mt,{analyticAction:"notes_navigate_in_panel"})]})}function Et({panelOpen:e,note:t}){const n=(0,p.L)(),r=(0,f.P)(),c=(0,Be.M)(),l=(0,a.O)(),d=(0,i.useRef)(null),u=(0,b.m)(),A=(0,h.g)(),S=null==t?void 0:t.id;(0,m.J)(x.F,(e=>{d.current&&d.current.scrollToSelector(`[data-id='${e.commentId}']`)})),(0,i.useEffect)((()=>{d.current&&S&&d.current.resetScrollTop()}),[S]);const _=!!(t&&r&&c)&&(0,E.q2)(r,c,v.U.NOTE,t.user),O=u===T.f.EDITING,N=l===o.L$.BOTTOM_PANEL,k=O&&N;return(0,s.jsxs)(tt.q,{ref:d,open:e,className:"note-panel",scrollingDisabled:k,onClose:()=>{n.issueCommand(new y.sL)},children:[t&&!A&&(0,s.jsx)(vt,{}),t&&(0,s.jsx)(et,{note:t}),t&&S&&N&&_&&(0,s.jsx)(nt.n,{id:S,pin:t,pinType:g.yY.NOTE,onSave:e=>{S&&n.issueCommand(new y.Xc(S,e))},onClose:()=>{n.issueCommand(new y.dz(!1))},colors:C.Ay.colors,open:O,toolPanelLayout:l},S)]})}var xt=n(13397),yt=n(39301),Tt=n(70967),bt=n(3184),Ct=n(15900);n(10202);const{NOTES:At}=le.A.SHOWCASE;function St(){const e=(0,P.Y)(),t=(0,Tt.X)(),n=(0,i.useRef)(null);return(0,s.jsx)("div",{className:"search-filter",children:(0,s.jsxs)(K.y,{ref:n,icon:"filter",ariaLabel:e.t(At.FILTER),variant:Y.Ak.TERTIARY,size:Y.Mp.SMALL,menuClassName:"search-filter-menu",children:[(0,s.jsxs)("div",{className:"search-filter-menu-header",children:[(0,s.jsx)("div",{children:e.t(At.FILTER_BY)}),(0,s.jsx)(ft.J,{onClose:()=>{n.current&&n.current.closeMenu()}})]}),(0,s.jsx)(_t,{id:bt.S.ALL,label:e.t(At.FILTER_ALL),selected:t===bt.S.ALL},bt.S.ALL),(0,s.jsx)(_t,{id:bt.S.OPEN,label:e.t(At.FILTER_UNRESOLVED),selected:t===bt.S.OPEN},bt.S.OPEN),(0,s.jsx)(_t,{id:bt.S.RESOLVED,label:e.t(At.FILTER_RESOLVED),selected:t===bt.S.RESOLVED},bt.S.RESOLVED)]})})}function _t({id:e,label:t,selected:n}){const i=(0,N.s)(),o=(0,p.L)();return(0,s.jsx)(Ct.M,{id:e,label:t,selected:n,onToggled:()=>{n||(i.trackToolGuiEvent("notes","notes_list_change_filter"),o.issueCommand(new y.$l(e,!0)))}})}var Ot=n(61771);const{NOTES:Nt}=le.A.SHOWCASE;function kt({children:e,title:t,hideBadge:n}){const i=(0,P.Y)(),r=(0,xt.e)(),a=(0,ut.W)().length,c=(0,s.jsx)(Ot.M,{filter:(0,s.jsx)(St,{})}),l=t||i.t(r?Nt.COMMENTS:Nt.NOTES,a);return(0,s.jsx)(yt.h,{toolId:o.S0.NOTES,className:"notes-list-panel",title:l,subheader:c,hideBadge:n,children:e})}function wt({children:e,title:t,hideBadge:n}){const p=(0,r.t)(),m=(0,a.O)(),f=(0,c.k)(),g=(0,d.r)(),v=function(){const e=(0,d.r)(),t=(0,u.X)();return(null==e?void 0:e.id)===(null==t?void 0:t.id)?e:null}(),E=(0,h.g)(),[x,y]=(0,i.useState)(v),T=f;(0,i.useEffect)((()=>{g&&(null==g?void 0:g.id)!==(null==x?void 0:x.id)&&y(g)}),[null==x?void 0:x.id,g,null==g?void 0:g.id]);const b=E?v:g,C=m===o.L$.BOTTOM_PANEL,A=p&&p!==l.a.CONFIRM,S=!(!b||C&&A);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Et,{panelOpen:S,note:b||x}),!T&&(0,s.jsx)(kt,{title:t,hideBadge:n,children:e})]})}},80700:(e,t,n)=>{"use strict";n.d(t,{e:()=>r});var s=n(96540),i=n(93388);function o(e,t){return t&&e&&e.focusedComment?e.getReply(t,e.focusedComment.id):null}function r(e){const t=(0,i.Y)(),[n,r]=(0,s.useState)(o(t,e));return(0,s.useEffect)((()=>{if(!t)return()=>{};const n=t.onFocusedCommentChanged((function(){r(o(t,e))}));return()=>n.cancel()}),[t,e]),n}},70466:(e,t,n)=>{"use strict";n.d(t,{g:()=>o});var s=n(87805),i=n(78450);const o=(0,s.u)(i.b,"isNewNote",!1)},14326:(e,t,n)=>{"use strict";n.d(t,{O:()=>o});var s=n(96540),i=n(93388);function o(){const e=(0,i.Y)(),[t,n]=(0,s.useState)((null==e?void 0:e.activeNotation)||null);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onActiveNotationChanged(n);return()=>t.cancel()}),[e]),t}},80411:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var s=n(96540),i=n(93388);function o(e){const t=(0,i.Y)(),[n,o]=(0,s.useState)((null==t?void 0:t.getNoteView(e))||null);return(0,s.useEffect)((()=>{if(!t)return()=>{};const n=t.getNoteViewsMap().onChanged((function(){t&&o(t.getNoteView(e))}));return()=>n.cancel()}),[t,e]),n}},70967:(e,t,n)=>{"use strict";n.d(t,{X:()=>r});var s=n(96540),i=n(93388),o=n(3184);function r(){const e=(0,i.Y)(),[t,n]=(0,s.useState)((null==e?void 0:e.notesFilter)||o.S.OPEN);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onNotesFilterChanged(n);return()=>t.cancel()}),[e]),t}},24865:(e,t,n)=>{"use strict";n.d(t,{b:()=>o});var s=n(96540),i=n(93388);function o(){const e=(0,i.Y)();return(0,s.useMemo)((()=>function(e){return e?e.getLinkHandler():null}(e)),[e])}},98378:(e,t,n)=>{"use strict";n.d(t,{m:()=>r});var s=n(96540),i=n(93388),o=n(89416);function r(){const e=(0,i.Y)(),[t,n]=(0,s.useState)((null==e?void 0:e.notesPhase)||o.f.CLOSED);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onNotesPhaseChanged(n);return n(e.notesPhase),()=>t.cancel()}),[e]),t}},35517:(e,t,n)=>{"use strict";n.d(t,{Wu:()=>l,kc:()=>c,sG:()=>d,zJ:()=>u});var s=n(5013),i=n(53641),o=n(25296),r=n(54616),a=n(51831);function c(){const e=(0,s.M)();return!!e&&e.hasPolicy(i.tG)}function l(){const e=(0,s.M)();return!!e&&e.hasPolicy(i.O7)}function d(e){const t=(0,s.M)(),n=(0,r.P)();return!!t&&!!e&&(0,o.q2)(n,t,a.U.NOTE,null==e?void 0:e.user)}function u(e){const t=(0,s.M)(),n=(0,r.P)();return!!t&&!!e&&(0,o.db)(n,t,a.U.NOTE,null==e?void 0:e.user)}},29397:(e,t,n)=>{"use strict";n.d(t,{V:()=>o});var s=n(96540),i=n(93388);function o(){const e=(0,i.Y)();return(0,s.useMemo)((()=>function(e){return e?e.getTextParser():null}(e)),[e])}},93388:(e,t,n)=>{"use strict";n.d(t,{Y:()=>o});var s=n(98236),i=n(78450);const o=(0,s.v)(i.b)},20263:(e,t,n)=>{"use strict";n.d(t,{r:()=>o});var s=n(96540),i=n(93388);function o(){const e=(0,i.Y)(),[t,n]=(0,s.useState)(e?e.openNoteView:null);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onOpenNoteViewChanged(n);return n(e.openNoteView),()=>t.cancel()}),[e]),t}(0,n(61260).c)("openNoteView",o)},58972:(e,t,n)=>{"use strict";n.d(t,{F:()=>o,a:()=>i});var s=n(89103);class i extends s.QB{constructor(e,t){super(),this.id=e,this.resolved=t}}class o extends s.QB{constructor(e){super(),this.commentId=e}}},40590:(e,t,n)=>{"use strict";n.d(t,{$:()=>o});var s=n(84710),i=n(56413);class o extends s.B{constructor(){super(),this.name="object-tags",this.suggestions=(0,i.y)()}get collection(){return this.suggestions}iterate(e){for(const t of this.suggestions)e(t)}getObjectTag(e){return this.suggestions.get(e)}getObjectTagIds(){return this.suggestions.keys}updateObjectTag(e){this.suggestions.set(e.id,e)}removeObjectTag(e){return this.suggestions.delete(e)}}},81058:(e,t,n)=>{"use strict";n.d(t,{HZ:()=>o,R5:()=>d,_8:()=>a,lA:()=>r,lg:()=>l,vX:()=>i,y_:()=>u,ye:()=>c});var s=n(55141);class i extends s.u{constructor(e){super(),this.payload={enabled:e}}}i.id="OBJECTS_ANNOTATIONS_ENABLED";class o extends s.u{constructor(e){super(),this.payload={ids:e}}}o.id="FILTER_TAG_SUGGESTION";class r extends s.u{constructor(e){super(),this.payload={id:e}}}r.id="NAVIGATE_TO_TAG_SUGGESTION";class a extends s.u{constructor(e,t){super(),this.payload={id:e,enabled:t}}}a.id="TOGGLE_OBJECT_ENABLED";class c extends s.u{constructor(e,...t){super(),this.payload={ids:t,enabled:e}}}c.id="TOGGLE_OBJECT_TAG_ENABLED";class l extends s.u{constructor(...e){super(),this.payload={ids:e}}}l.id="DISMISS_OBJECT_TAG";class d extends s.u{constructor(e,t,n,s){super(),this.payload={id:e,options:t,pendingAttachments:n,embed:s}}}d.id="CREATE_OBJECT_TAG";class u extends s.u{constructor(e){super(),this.payload={id:e}}}u.id="DOCK_OBJECT_TAG"},92116:(e,t,n)=>{"use strict";n.d(t,{B:()=>s});const s=Object.freeze({pink:"#f78da7",plum:"#9c4b92",purple:"#673ab7",teal:"#03687d",cerulean:"#03a9f4",ocean:"#00bcd4",fog:"#abb8c3",iron:"#607d8b",forest:"#417505",emerald:"#51a868",mint:"#37d67a",lime:"#cddc39",canary:"#fbcd00",sunflower:"#ffac17",tangerine:"#ff6900",sunset:"#f44336",sierra:"#d44441",magenta:"#e91e63"})},4303:(e,t,n)=>{"use strict";n.d(t,{n:()=>E});var s=n(74848),i=n(96540),o=n(72909),r=n(32485),a=n.n(r),c=n(77570),l=n(33699),d=n(73566),u=n(98715),h=n(63895),p=n(56500),m=n(56147),f=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},g=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const{PINS:v}=m.A.WORKSHOP;let E=class extends i.Component{constructor(e){super(e),this.closePinAssetEditor=()=>{this.props.onClose()},this.handleColorPicked=e=>{this.context.analytics.trackGuiEvent("pin_change_color"),this.props.onSave({color:e})},this.saveStemEnabled=e=>{this.context.analytics.trackGuiEvent(e?"pin_show_stem":"pin_hide_stem"),this.props.onSave({stemEnabled:e})},this.saveStemLength=e=>{this.context.analytics.trackGuiEvent("pin_change_stem_height"),this.props.onSave({stemLength:e})},this.previewStemLength=e=>{const{id:t,pinType:n}=this.props;this.context.commandBinder.issueCommand(new l.gx(t,n,{stemLength:e}))},this.stopPropagation=e=>{e.stopPropagation()}}renderStemEditor(){const{pin:e}=this.props;return(0,s.jsx)(p.n,{stemLength:e.stemLength,stemEnabled:e.stemEnabled,onLengthUpdate:this.previewStemLength,onLengthChanged:this.saveStemLength,onStemEnabledChanged:this.saveStemEnabled})}render(){const{toolPanelLayout:e,open:t,pin:n,colors:i}=this.props,o=e===d.L$.BOTTOM_PANEL;if(!t&&!o)return null;const r=this.context.locale.t(v.COLOR_STEM_EDITOR_TITLE);return(0,s.jsxs)("div",{className:a()("pin-tool-editor",{"tool-popup":!o,open:o&&t}),onClick:this.stopPropagation,children:[(0,s.jsxs)("div",{className:"tool-editor-title",children:[(0,s.jsx)("span",{children:r}),(0,s.jsx)(u.J,{theme:"dark",tooltip:"",onClose:this.closePinAssetEditor})]}),(0,s.jsx)(h.s,{colors:i,defaultColor:n.color,onColorPicked:this.handleColorPicked}),this.renderStemEditor()]})}};E.contextType=c.B,E=f([o.A,g("design:paramtypes",[Object])],E)},95136:(e,t,n)=>{"use strict";n.d(t,{k:()=>b});var s=n(74848),i=n(74328),o=n(68909),r=n(96540),a=n(32485),c=n.n(a),l=n(81609),d=n(56147),u=n(35404),h=n(28479),p=n(8387),m=n(94165),f=n(68375),g=n(38731),v=n(93702),E=n(39869),x=n(50747);function y(e){const{label:t,className:n,darkTheme:i,analyticAction:o,urlParams:a,buttonVariant:y}=e,T=(0,g.B)(),b=(0,E.Y)(),C=(0,x.F)(),A=(0,f.s)(),S=(0,v.K)(),[_,O]=(0,r.useState)(!1),N=T||C.tryGetProperty(u.wD,!1),k=(0,h.L)(),w=(0,r.useCallback)((e=>{e.stopPropagation()}),[]),R=(0,r.useCallback)((e=>{e.stopPropagation(),_||(!async function(e,t){const n=(await t.getModuleBySymbol(m.r)).creator.createDeepLink({additionalParams:e,paramFilter:e=>!["q","qK","qF","tag","note","comment","pin-pos","cloudEdit"].includes(e)});n.hash="",(0,l.l)(n.href)}(a,S),O(!0),A.trackGuiEvent(o,{tool:k}))}),[_,a,S,A,o,k]);(0,r.useEffect)((()=>{if(!_)return()=>{};const e=window.setTimeout((()=>O(!1)),2500);return()=>window.clearTimeout(e)}),[_]);let L=y||(!t?p.Ak.FAB:p.Ak.TERTIARY),I="share",j=t,P=t?void 0:b.t(d.A.COPY_LINK),M=!1;return _&&(L=p.Ak.TERTIARY,I=void 0,j=b.t(d.A.SHARE_COPIED),P=void 0,M=!0),N?(0,s.jsx)("div",{className:c()("url-link-copy",n,{"link-copied":_}),onClick:w,children:(0,s.jsx)(p.$n,{icon:I,label:j,size:p.Mp.SMALL,variant:L,theme:i?"dark":"light",disabled:M,tooltip:P,tooltipOptions:{placement:"bottom"},onClick:R})}):null}var T=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]])}return n};function b(e){const{prefix:t,pin:n,id:r}=e,a=T(e,["prefix","pin","id"]),{stemNormal:c,stemLength:l,anchorPosition:d}=n,u=i.s.encodeVector3((new o.Vector3).copy(c).setLength(l).add(d)),h={[`${t}`]:r,"pin-pos":u};return(0,s.jsx)(y,Object.assign({urlParams:h},a))}},94413:(e,t,n)=>{"use strict";n.d(t,{W:()=>o});var s=n(96540),i=n(93216);function o(){const e=(0,i.d)(),[t,n]=(0,s.useState)(!!e&&e.canAdd);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onCanAddChanged(n);return n(e.canAdd),()=>t.cancel()}),[e]),t}},40145:(e,t,n)=>{"use strict";n.d(t,{w:()=>o});var s=n(96540),i=n(93216);function o(){const e=(0,i.d)(),[t,n]=(0,s.useState)(!!e&&e.canPlace);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onCanPlaceChanged(n);return n(e.canPlace),()=>t.cancel()}),[e]),t}},89002:(e,t,n)=>{"use strict";n.d(t,{f:()=>r});var s=n(96540),i=n(93216),o=n(25727);function r(){const e=(0,i.d)(),[t,n]=(0,s.useState)(e?e.pinEditorState:o.ce.IDLE);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onPinEditorStateChanged(n);return()=>t.cancel()}),[e]),t}},47013:(e,t,n)=>{"use strict";n.d(t,{E:()=>o});var s=n(96540),i=n(93216);function o(){const e=(0,i.d)(),[t,n]=(0,s.useState)((null==e?void 0:e.progress)||0);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onProgressChanged(n);return n(e.progress),()=>t.cancel()}),[e]),t}},74453:(e,t,n)=>{"use strict";n.d(t,{S:()=>o});var s=n(96540),i=n(93216);function o(){const e=(0,i.d)(),[t,n]=(0,s.useState)((null==e?void 0:e.screenPosition)||null);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onScreenPositionChanged(n);return n(e.screenPosition),()=>t.cancel()}),[e]),t}},93216:(e,t,n)=>{"use strict";n.d(t,{d:()=>o});var s=n(98236),i=n(11416);const o=(0,s.v)(i.U)},32408:(e,t,n)=>{"use strict";n.d(t,{RN:()=>d,hs:()=>h,m1:()=>u,nK:()=>l,zX:()=>p});var s=n(68909),i=n(28511),o=n(25727),r=n(13893),a=n(74328),c=n(86224);function l(e,t){switch(t){case o.ob.DEFAULT:return e.baseColor;case o.ob.DIMMED:return e.dimmedColor;case o.ob.HIGHLIGHTED:return e.hoverColor}}function d(e,t,n){const s=n?t:void 0;return s&&i.J[s]?s:o.tf[e]}function u(e){return e===o.yY.OBJECT?0:c.A.pinHeadMesh.strokeWidth}function h(e){if("comment-large"===e)return{x:0,y:5}}const p=async(e,t,n)=>{const i=(new s.Vector3).copy(t.stemNormal).setLength(t.stemLength).add(t.anchorPosition),o=a.s.decodeVector3(e.getOverrideParam("pin-pos",a.s.encodeVector3(i)));n(o&&o.distanceTo(i)>.1||null===a.s.deserialize()?r.fl.FadeToBlack:null)}},72667:(e,t,n)=>{"use strict";n.d(t,{z:()=>a});var s=n(96540),i=n(39869),o=n(51469),r=n(30169);function a(e){const t=(0,o.N)(),n=(0,i.Y)(),[a,c]=(0,s.useState)((0,r.Ay)(e,n,t));return(0,s.useEffect)((()=>{if(!t)return()=>{};function s(){c((0,r.Ay)(e,n,t))}const i=t.onRoomsChanged({onUpdated:s});return s(),()=>i.cancel()}),[n,t,e]),a}},94547:(e,t,n)=>{"use strict";n.d(t,{$M:()=>r,Oc:()=>u,Pb:()=>o,Xx:()=>d,_d:()=>c,_w:()=>l,tA:()=>i,tf:()=>h,xg:()=>a});var s=n(55141);class i extends s.u{constructor(e){super(),this.payload={query:e}}}i.id="UPDATE_SEARCH_QUERY";class o extends s.u{constructor(e){super(),this.payload={keywords:e}}}o.id="UPDATE_SEARCH_QUERY_KEYWORDS";class r extends s.u{constructor(e){super(),this.payload={keywordId:e}}}r.id="TOGGLE_SEARCH_QUERY_KEYWORD";class a extends s.u{constructor(e){super(),this.payload={grouping:e}}}a.id="CHANGE_SEARCH_GROUPING";class c extends s.u{constructor(){super()}}c.id="SEARCH_FILTER_CLEAR";class l extends s.u{constructor(e,t){super(),this.payload={groupId:e,enabled:t}}}l.id="SEARCH_FILTER_TOGGLE";class d extends s.u{constructor(e,t){super(),this.payload={id:e,typeId:t}}}d.id="SELECT_SEARCH_RESULT";class u extends s.u{constructor(e){super(),this.payload=e}}u.id="SEARCH_GROUP_REGISTER";class h extends s.u{constructor(e){super(),this.payload={id:e}}}h.id="SEARCH_GROUP_DEREGISTER"},67679:(e,t,n)=>{"use strict";n.d(t,{N:()=>l});var s=n(74848),i=n(16112),o=n(13397),r=n(39869);function a({dataTypeGroup:e}){return e.groupActionsFC?(0,s.jsx)(e.groupActionsFC,{group:e}):null}var c=n(93824);function l(e){const{id:t,numItems:n,numSelected:l,selected:d,selectDisabled:u,selectMode:h,onSelect:p}=e,m=(0,i.f)(),f=(0,o.e)(),g=(0,r.Y)(),v=m[t];if(!v)return null;const E=f&&v.groupMatchingPhraseKey||v.groupPhraseKey,x=E?g.t(E):t,y=h?`(${l}/${n})`:`(${n})`;return(0,s.jsx)(c.u,{id:t,title:x,decals:(0,s.jsx)("span",{className:"mp-list-item-text",children:y}),actions:(0,s.jsx)(a,{dataTypeGroup:v}),selectMode:h,selectDisabled:u,selected:d,onSelect:p})}},54011:(e,t,n)=>{"use strict";n.d(t,{v:()=>r});var s=n(74848),i=n(39869),o=n(93824);function r(e){const{id:t,numItems:n,numSelected:r,selected:a,selectMode:c,onSelect:l}=e,d=(0,i.Y)().t(`SHOWCASE.NOTES.${t}`),u=c?`(${r}/${n})`:`(${n})`;return(0,s.jsx)(o.u,{id:t,title:d,decals:(0,s.jsx)("span",{className:"mp-list-item-text",children:u}),selectMode:c,selected:a,onSelect:l})}},53963:(e,t,n)=>{"use strict";n.d(t,{og:()=>w,ic:()=>I,r2:()=>R,ex:()=>P,mk:()=>L,dS:()=>j});var s=n(74848),i=n(96540),o=n(36981),r=n(56147),a=n(39869),c=n(38731),l=n(53289),d=n(6304),u=n(64695),h=n(84917);var p=n(27817),m=n(93877),f=n(48198),g=n(50659),v=n(2716),E=n(93369);function x(e=!0){return y((0,u.W)(),function(){const e=[];for(const t in h.T)e.push({id:t});const[t]=(0,i.useState)(e);return t}(),m.Hj.DATE,e)}function y(e,t,n,s){const o=(0,p.w)(),[r,a]=(0,i.useState)([]);return(0,i.useEffect)((()=>{if(!o)return()=>{};const i=t.reduce(((e,t,s)=>Object.assign(Object.assign({},e),{[t.id]:{id:t.id,grouping:n,groupOrder:s,items:[],batchSupported:!0}})),{}),r={};e.forEach((e=>{const t=e.getGroupingId(n);if(t&&i[t])t&&i[t].items.push(e);else{const t=e.getGroupingId(m.Hj.TYPE);if(t){const n=o.getSearchDataTypeGroup(t);r[t]||(r[t]={id:t,grouping:m.Hj.TYPE,groupOrder:(0,E.E)(o,t,m.Hj.TYPE),items:[],batchSupported:n.batchSupported}),r[t].items.push(e)}}}));let c=Object.values(i);return s&&(c=c.filter((e=>e.items.length>0))),a(c.concat(Object.values(r))),()=>{}}),[o,e,t,n,s]),r}var T=n(16112),b=n(95072);var C=n(74481),A=n(78115),S=n(58024),_=n(98476),O=n(49197);const{SEARCH:N}=r.A.SHOWCASE,k=({group:e})=>{const t=(0,a.Y)().t(N.EMPTY_LIST_MESSAGE);return(0,s.jsx)(O.t,{message:t})},w=60;function R(e){const{excludeEmptyGroups:t}=e,n=function(e=!0){const t=(0,f.y)();return y((0,u.W)(),t,m.Hj.FLOOR,e)}(t);return(0,s.jsx)(M,Object.assign({},e,{dataGroups:n}))}function L(e){const{excludeEmptyGroups:t}=e,n=function(e=!0){const t=(0,g.N)();return y((0,u.W)(),t,m.Hj.ROOM,e)}(t);return(0,s.jsx)(M,Object.assign({},e,{dataGroups:n}))}function I(e){const{excludeEmptyGroups:t}=e,n=x(t);return(0,s.jsx)(M,Object.assign({},e,{dataGroups:n}))}function j(e){const{excludeEmptyGroups:t}=e,n=function(e=!0){const t=(0,T.f)(),n=Object.values(t).sort(((e,t)=>(e.groupOrder||b.X$)-(t.groupOrder||b.X$))).map((e=>({id:e.id,grouping:m.Hj.TYPE,groupOrder:e.groupOrder||b.X$,items:e.matches,batchSupported:e.batchSupported})));return e?n.filter((e=>e.items.length>0)):n}(t);return(0,s.jsx)(M,Object.assign({},e,{dataGroups:n}))}function P(e){const{excludeEmptyGroups:t}=e,n=(0,c.B)(),{includeInMemory:r}=(0,i.useContext)(o.b),a=function(e=!0,t=!1){const n=(0,v.z)(t);return y((0,u.W)(),n,m.Hj.LAYER,e)}(t,!r),d=(0,S.z0)(),h=n&&(null==d?void 0:d.id)||void 0,[p,f]=(0,i.useState)(void 0),g=(0,i.useCallback)((()=>{f(void 0)}),[]);return(0,l.J)(A.V7,(({layerId:e})=>{f(e)})),(0,s.jsx)(M,Object.assign({},e,{dataGroups:a,activeGroupId:h,scrollToGroupId:p,onScrolled:g}))}function M(e){const{renderGroup:t,renderItem:n,dataGroups:o,activeItemId:c,activeGroupId:l,scrollToGroupId:u,onScrolled:h}=e,[p,m]=(0,d.N)(),f=(0,i.useRef)(null),g=(0,C.M)(),v=(0,i.useRef)(),E=(0,a.Y)();return(0,i.useEffect)((()=>(window.clearTimeout(v.current),g&&(v.current=window.setTimeout((()=>{o.forEach((e=>{e.items.length>0&&m(e.id,!1)}))}),500)),()=>{window.clearTimeout(v.current)})),[g,o,m]),(0,i.useEffect)((()=>{var e;if(!u)return;(null===(e=f.current)||void 0===e?void 0:e.scrollIntoView(`[data-id='${u}']`))&&(null==h||h())}),[u,h]),(0,i.useEffect)((()=>{var e;if(c){let t=-1;const n=null===(e=o.find((e=>{const n=e.items.findIndex((e=>e.id===c));return-1!==n&&(t=n,!0)})))||void 0===e?void 0:e.id;f.current&&n&&f.current.focusGroupItem(n,t)}return()=>{}}),[o,c,f]),(0,s.jsx)(_.n,{ref:f,ariaExpandLabel:E.t(r.A.ACCORDIONS.EXPAND),ariaCollapseLabel:E.t(r.A.ACCORDIONS.COLLAPSE),data:o,itemHeight:60,renderItem:n,renderGroup:t,renderEmpty:k,onToggleCollapse:m,collapsedIds:p,activeGroupId:l,collapseEmptyGroups:o.length>1})}},37924:(e,t,n)=>{"use strict";n.d(t,{$:()=>y});var s=n(74848),i=n(96540),o=n(56147),r=n(39869),a=n(16112),c=n(75410),l=n(95072),d=n(30129),u=n(8387),h=n(98715),p=n(28479),m=n(94547),f=n(15900),g=n(90087),v=n(68375);function E({id:e,icon:t,label:n,selected:i}){const o=(0,v.s)(),r=(0,g.L)(),a=(0,p.L)();return(0,s.jsx)(f.M,{id:e,icon:t,label:n,selected:i,onToggled:t=>{t.stopPropagation(),"ALL"===e?i||r.issueCommand(new m._d):r.issueCommand(new m._w(e,!i)),i||o.trackGuiEvent(`items_filter_by_${e.toLowerCase()}`,{tool:a})}})}n(10202);const{SEARCH:x}=o.A.SHOWCASE;function y(){const e=(0,r.Y)(),t=Object.values((0,a.f)()),n=(0,c.h)(),o=0===n.length,p=(0,i.useRef)(null),m=t.sort(((e,t)=>(e.groupOrder||l.X$)-(t.groupOrder||l.X$))).map((t=>{const{id:i,groupIcon:r,groupPhraseKey:a}=t,c=e.t(a),l=!o&&n.includes(i);return(0,s.jsx)(E,{id:i,icon:r,label:c,selected:l},i)})),f=e.t(x.FILTER_SEARCH),g=e.t(x.FILTER_SEARCH_ALL);return(0,s.jsx)("div",{className:"search-filter",onClick:e=>e.stopPropagation(),children:(0,s.jsxs)(d.y,{ariaLabel:e.t(x.FILTER_SEARCH_LABEL),ref:p,icon:"filter",variant:u.Ak.TERTIARY,size:u.Mp.SMALL,menuClassName:"search-filter-menu",children:[(0,s.jsxs)("div",{className:"search-filter-menu-header",children:[(0,s.jsx)("div",{children:f}),(0,s.jsx)(h.J,{onClose:()=>{p.current&&p.current.closeMenu()}})]}),(0,s.jsx)(E,{id:"ALL",icon:"fullscreen",label:g,selected:o}),m]})})}},15900:(e,t,n)=>{"use strict";n.d(t,{M:()=>c});var s=n(74848),i=n(39869),o=n(56147),r=n(8387),a=n(53180);function c({id:e,icon:t,label:n,selected:c,onToggled:l}){const d=(0,i.Y)();return(0,s.jsx)(r.$n,{icon:t,label:n,ariaLabel:c?d.t(o.A.SHOWCASE.SEARCH.FILTER_SEARCH_SELECTED):n,size:r.Mp.SMALL,variant:r.Ak.TERTIARY,onClick:l,appendChildren:!1,children:(0,s.jsx)("div",{className:"search-filter-selected",children:c&&(0,s.jsx)(a.I,{name:"checkmark"})})},e)}},99663:(e,t,n)=>{"use strict";n.d(t,{$:()=>g});var s=n(74848),i=n(56147),o=n(39869),r=n(87805),a=n(78849);const c=(0,r.u)(a.L,"searchMode",!1);var l=n(28479),d=n(78379),u=n(93877),h=n(30129),p=n(8387),m=n(68375);const{SEARCH:f}=i.A.SHOWCASE;function g({phraseKeys:e={},grouping:t,onGroupBy:n}){const i=(0,o.Y)(),r=(0,d.S)(),a=c(),l=[u.Hj.DATE,u.Hj.FLOOR];"boolean"==typeof a&&l.unshift(u.Hj.TYPE),r&&l.push(u.Hj.LAYER);const m=i.t(E(t,!0,e));return(0,s.jsx)(h.y,{className:"grouping-sort-menu-button",ariaLabel:m,variant:p.Ak.TERTIARY,label:m,caret:!0,children:l.map((t=>(0,s.jsx)(v,{onGroupBy:n,grouping:t,phraseKeys:e},t)))})}function v({grouping:e,onGroupBy:t,phraseKeys:n={}}){const i=(0,m.s)(),r=(0,o.Y)().t(E(e,!1,n)),a=(0,l.L)();return(0,s.jsx)(p.$n,{label:r,size:p.Mp.SMALL,variant:p.Ak.TERTIARY,onClick:()=>{t(e),i.trackGuiEvent(`items_group_by_${e}`,{tool:a})}},e)}function E(e,t,n){var s,i,o,r,a,c,l,d,h,p;switch(e){case u.Hj.TYPE:return t?(null===(s=n[u.Hj.TYPE])||void 0===s?void 0:s.selectedTextKey)||f.GROUP_TYPE_SELECTED:(null===(i=n[u.Hj.TYPE])||void 0===i?void 0:i.textKey)||f.GROUP_TYPE;case u.Hj.FLOOR:return t?(null===(o=n[u.Hj.FLOOR])||void 0===o?void 0:o.selectedTextKey)||f.GROUP_FLOOR_SELECTED:(null===(r=n[u.Hj.FLOOR])||void 0===r?void 0:r.textKey)||f.GROUP_FLOOR;case u.Hj.ROOM:return t?(null===(a=n[u.Hj.ROOM])||void 0===a?void 0:a.selectedTextKey)||f.GROUP_ROOM_SELECTED:(null===(c=n[u.Hj.ROOM])||void 0===c?void 0:c.textKey)||f.GROUP_ROOM;case u.Hj.LAYER:return t?(null===(l=n[u.Hj.LAYER])||void 0===l?void 0:l.selectedTextKey)||f.GROUP_LAYER_SELECTED:(null===(d=n[u.Hj.LAYER])||void 0===d?void 0:d.textKey)||f.GROUP_LAYER;case u.Hj.DATE:default:return t?(null===(h=n[u.Hj.DATE])||void 0===h?void 0:h.selectedTextKey)||f.GROUP_DATE_SELECTED:(null===(p=n[u.Hj.DATE])||void 0===p?void 0:p.textKey)||f.GROUP_DATE}}},62182:(e,t,n)=>{"use strict";n.d(t,{e:()=>p});var s=n(74848),i=n(56147),o=n(39869),r=n(1494),a=n(94547),c=n(8387),l=n(90087);const{WORKSHOP:d,HIDE:u,SHOW:h}=i.A;function p({item:e,onToggle:t}){const n=(0,l.L)(),i=(0,o.Y)(),{enabled:p,id:m,typeId:f}=e,g=!e.isLayerVisible(),v=!p||g?"eye-hide":"eye-show",E=(0,r.H)(),x=g?i.t(d.LAYERS.HIDDEN_LAYER_ITEM_TOOLTIP):p?i.t(u):i.t(h);return(0,s.jsx)(c.$n,{icon:v,dimmed:!p,variant:c.Ak.TERTIARY,onClick:e=>{e.stopPropagation(),g||(p&&E===m&&n.issueCommand(new a.Xx(null,f)),t(!p))},tooltip:x})}},82198:(e,t,n)=>{"use strict";n.d(t,{x:()=>v});var s=n(74848),i=n(96540),o=n(32485),r=n.n(o),a=n(56147),c=n(39869),l=n(93877),d=n(74481),u=n(64695),h=n(53963),p=n(53289),m=n(78115);var f=n(49197);const{SEARCH:g}=a.A.SHOWCASE;function v(e){const{excludeEmptyGroups:t,activeItemId:n,grouping:o,emptyPhrase:a}=e,v=(0,i.useRef)(null),E=(0,c.Y)(),x=(0,d.M)(),y=(0,u.W)(),T=function(){const[e,t]=(0,i.useState)(!1),n=(0,i.useCallback)((e=>()=>t(e)),[]);return(0,p.J)(m.MT,n(!0)),(0,p.J)(m.tj,n(!1)),e}(),b=0===y.length,C=o===l.Hj.FLOOR,A=o===l.Hj.ROOM,S=o===l.Hj.LAYER,_=o===l.Hj.DATE,O=void 0!==t?t:x,N=E.t(a||g.EMPTY_LIST_MESSAGE),k=!!O&&b,w=Object.assign(Object.assign({},e),{scrollRef:null==v?void 0:v.current,excludeEmptyGroups:O,activeItemId:n});return k?(0,s.jsx)(f.t,{message:N}):(0,s.jsxs)("div",{className:r()("list-contents","searchable-list",{pending:T}),ref:v,children:[C?(0,s.jsx)(h.r2,Object.assign({},w)):A?(0,s.jsx)(h.mk,Object.assign({},w)):S?(0,s.jsx)(h.ex,Object.assign({},w)):_?(0,s.jsx)(h.ic,Object.assign({},w)):(0,s.jsx)(h.dS,Object.assign({},w)),e.children]})}},17337:(e,t,n)=>{"use strict";n.d(t,{f:()=>r});var s=n(74848),i=n(87912),o=n(35137);function r({item:e}){const{imgUrl:t,color:n,icon:r}=e;return t?(0,s.jsx)(i.q,{className:"thumbnail-image",resource:t}):r?(0,s.jsx)(o.E,{badgeStyle:void 0!==n?{background:n,borderColor:n}:{},iconClass:r}):null}},53223:(e,t,n)=>{"use strict";n.d(t,{$:()=>a});var s=n(74848),i=n(13397),o=n(95143),r=n(55666);function a({item:e}){const{textParser:t,title:n,description:a}=e,c=(0,i.e)();let l=n;l&&(l=(0,o.x8)(l,c));let d=a;return d&&(d=(0,o.A_)(d,c)),(0,s.jsxs)("div",{className:"item-details",children:[(0,s.jsx)("div",{className:"item-header",children:(0,s.jsx)(r.L,{text:l||"",textParser:t,markers:o.S8})}),t&&(0,s.jsx)("div",{className:"item-description",children:(0,s.jsx)(r.L,{text:d||"",textParser:t,markers:o.S8})})]})}},73810:(e,t,n)=>{"use strict";n.d(t,{P:()=>y});var s=n(74848),i=n(60728),o=n(56023),r=n(96540),a=n(39869),c=n(27817);const l=(e,t)=>Number(t.isSelected)-Number(e.isSelected)||e.text.localeCompare(t.text),d={fixtures:"KEYWORDS_FIXTURES"};function u(){const e=(0,a.Y)(),t=function(){const e=(0,c.w)(),[t,n]=(0,r.useState)((null==e?void 0:e.getKeywordSummaries())||[]);return(0,r.useEffect)((()=>{if(!e)return()=>{};function t(){e&&n(e.getKeywordSummaries())}const s=e.keywordCounts.onChanged(t),i=e.keywordFilters.onChanged(t);return t(),()=>{s.cancel(),i.cancel()}}),[e]),t}();return(0,r.useMemo)((()=>t.map((t=>Object.assign(Object.assign({},t),{text:d[t.id]?e.t(d[t.id]):t.text}))).sort(l)),[t,e])}var h=n(94547);const p=()=>{const e=u(),t=(0,o.D)(h.$M,(e=>[e.id]));return(0,s.jsx)(i.c,{className:"search-keyword-summary",tokens:e,onTokenClick:t,maxVisibleTruncated:5,allowSelect:!0})};var m=n(87137),f=n(77897),g=n(73566),v=n(64057),E=n(78956),x=n(68419);function y(){const e=(0,v.J)(),t=(0,E.O)(),n=t===g.L$.NARROW||t===g.L$.BOTTOM_PANEL,i=!e&&t===g.L$.BOTTOM_PANEL;return(0,x.t)()&&i?null:(0,s.jsx)("div",{className:"search-tool-overlay",children:n?(0,s.jsx)(m.A,{direction:f.OP.horizontal,children:(0,s.jsx)(p,{})}):(0,s.jsx)(p,{})})}},61771:(e,t,n)=>{"use strict";n.d(t,{M:()=>D});var s=n(74848),i=n(96540),o=n(32485),r=n.n(o),a=n(56147),c=n(73566),l=n(17084),d=n(78956),u=n(64057),h=n(39869),p=n(64491),m=n(12103),f=n(13397),g=n(59475),v=n(75410),E=n(94547),x=n(81609),y=n(66726),T=n(8387),b=n(35404),C=n(68375),A=n(38731),S=n(50747);function _(e){const{query:t,keywordFilters:n,typeFilters:o}=e,r=(0,A.B)(),c=(0,h.Y)(),l=(0,S.F)(),d=(0,C.s)(),[u,p]=(0,i.useState)(!1),m=r||l.tryGetProperty(b.wD,!1),f=(0,i.useCallback)((()=>{const e=(0,y.Cz)(t,n,o);(0,x.l)(e),p(!0);const s=r?"workshop_gui":"showcase_gui";d.track(s,{gui_action:"space_search_share_link_clicked"})}),[t,n,o,r,d]);return(0,i.useEffect)((()=>{if(!u)return()=>{};const e=window.setTimeout((()=>p(!1)),2500);return()=>window.clearTimeout(e)}),[u]),m?u?(0,s.jsx)("span",{className:"link-copied",children:c.t(a.A.SHARE_COPIED)}):(0,s.jsx)(T.$n,{onClick:f,icon:"share",variant:T.Ak.TERTIARY,tooltip:c.t(a.A.COPY_URL)}):null}var O=n(63220),N=n(71188),k=n(78197),w=n(90087);const{SEARCH:R}=a.A.SHOWCASE;function L({filter:e,readOnly:t,shareEnabled:n}){const o=(0,w.L)(),a=(0,i.useRef)(null),x=(0,i.useRef)(null),y=(0,h.Y)(),b=(0,d.O)(),C=(0,u.J)(),A=(0,f.e)(),S=(0,g.e)(),L=(0,v.h)(),I=(0,i.useMemo)((()=>(0,p.C8)()),[]),j=b===c.L$.BOTTOM_PANEL&&C,P=(0,N.w)((0,k.A)()),M=(0,i.useCallback)((e=>{o.issueCommand(new E.tA(e))}),[o]),D=y.t(R.SEARCH_IN_TOOL_PLACEHOLDER),H=y.t(R.CLEAR_SEARCH).toLocaleUpperCase(),U=S.length>0||L.length>0||""!==A,V=n&&U,G=I?void 0:m.JO;return(0,s.jsxs)("div",{ref:x,className:r()("list-search","search-panel-header"),children:[(0,s.jsxs)("div",{className:"search-bar",children:[(0,s.jsx)("span",{className:r()("search-header-icon","icon","icon-magnifying-glass",{"search-header-icon-active":U})}),(0,s.jsx)(O.A,{text:A,onInput:M,onDone:e=>{j&&e&&o.issueCommand(new l.li(!1))},onCancel:()=>{o.issueCommand(new l.Te)},placeholder:D,onFocus:()=>{P&&j&&I&&(o.issueCommand(new l.li(!1)),window.setTimeout((()=>{x.current&&x.current.scrollIntoView({behavior:"smooth",block:"start"})}),m.JO))},ref:a,focusOnMount:G,readOnly:t}),(0,s.jsxs)("div",{className:"search-header-button-container",children:[""!==A&&(0,s.jsx)(T.$n,{onClick:()=>{M(""),a.current&&!I&&a.current.focus()},label:H,size:T.Mp.SMALL,variant:T.Ak.TERTIARY}),V&&(0,s.jsx)(_,{query:A,keywordFilters:S,typeFilters:L})]})]}),e]})}var I=n(16112);const{SEARCH:j}=a.A.SHOWCASE;function P({id:e,label:t}){const n=(0,w.L)(),i=(0,h.Y)().t(j.FILTER_SEARCH_REMOVE);return(0,s.jsx)(T.$n,{icon:"close",label:t,tooltip:i,tooltipOptions:{placement:"bottom"},size:T.Mp.SMALL,variant:T.Ak.FAB,theme:"dark",onClick:()=>{n.issueCommand(new E._w(e,!1))},reverse:!0})}function M(){const e=(0,h.Y)(),t=(0,I.f)(),n=(0,v.h)();if(0===n.length)return null;const i=[];return n.forEach((n=>{const o=t[n];if(o){const t=e.t(o.groupPhraseKey);i.push((0,s.jsx)(P,{id:n,label:t},n))}})),(0,s.jsx)("div",{className:"search-filter-pills",children:i})}function D(e){const{shareEnabled:t=!1,filterPills:n=!1,filter:i}=e;return(0,s.jsxs)("div",{className:"list-subheaders",children:[(0,s.jsx)(L,{filter:i,shareEnabled:t}),n&&(0,s.jsx)(M,{})]})}},74481:(e,t,n)=>{"use strict";n.d(t,{M:()=>c});var s=n(13397),i=n(75410),o=n(59475),r=n(73566),a=n(48411);function c(){const e=(0,s.e)(),t=(0,i.h)(),n=(0,o.e)(),c=(0,a.T)(),l=c===r.S0.SEARCH||c===r.S0.LAYERS;return!!e||l&&t.length>0||n.length>0}},27817:(e,t,n)=>{"use strict";n.d(t,{w:()=>o});var s=n(98236),i=n(78849);const o=(0,s.v)(i.L)},16112:(e,t,n)=>{"use strict";n.d(t,{f:()=>o});var s=n(96540),i=n(27817);function o(){const e=(0,i.w)(),[t,n]=(0,s.useState)((null==e?void 0:e.dataTypeGroups)||{});return(0,s.useEffect)((()=>{if(!e)return()=>{};function t(){e&&n(e.dataTypeGroups)}const s=e.onChanged(t);return t(),()=>s.cancel()}),[e]),t}},59475:(e,t,n)=>{"use strict";n.d(t,{e:()=>o});var s=n(96540),i=n(27817);function o(){const e=(0,i.w)(),[t,n]=(0,s.useState)((null==e?void 0:e.getKeywordFilters())||[]);return(0,s.useEffect)((()=>{if(!e)return()=>{};function t(){e&&n(e.getKeywordFilters())}const s=e.keywordFilters.onChanged(t);return t(),()=>s.cancel()}),[e]),t}},13397:(e,t,n)=>{"use strict";n.d(t,{e:()=>o});var s=n(87805),i=n(78849);const o=(0,s.u)(i.L,"query","")},64695:(e,t,n)=>{"use strict";n.d(t,{W:()=>a});var s=n(96540),i=n(27817),o=n(53289),r=n(78115);function a(){const e=(0,i.w)(),[t,n]=(0,s.useState)((null==e?void 0:e.getResults())||[]);return(0,s.useEffect)((()=>{if(!e)return()=>{};function t(){e&&n(e.getResults())}const s=e.onSearchResultsChanged(t);return t(),()=>s.cancel()}),[e]),(0,o.J)(r.MT,(()=>{null==e||e.setResults([])})),t}},75410:(e,t,n)=>{"use strict";n.d(t,{h:()=>o});var s=n(96540),i=n(27817);function o(){const e=(0,i.w)(),[t,n]=(0,s.useState)((null==e?void 0:e.getTypeFilters())||[]);return(0,s.useEffect)((()=>{if(!e)return()=>{};function t(){e&&n(e.getTypeFilters())}const s=e.typeFilters.onChanged(t);return t(),()=>s.cancel()}),[e]),t}},1494:(e,t,n)=>{"use strict";n.d(t,{H:()=>o});var s=n(87805),i=n(78849);const o=(0,s.u)(i.L,"activeItemId",null)},36060:(e,t,n)=>{"use strict";n.d(t,{E:()=>c,Y:()=>a});var s=n(66416),i=n(55141),o=n(76318),r=n(95300);class a extends i.u{constructor(e){super(),this.payload={maxSize:e.maxSize||o.MF.ULTRAHIGH,aspect:e.aspect||r.BE,category:e.category||s.X.USER,onProgress:e.onProgress,waitForUpload:void 0===e.waitForUpload||e.waitForUpload}}}a.id="CAPTURE_SNAPSHOT";class c extends i.u{constructor(e){super(),this.payload={onProgress:e.onProgress,waitForUpload:void 0===e.waitForUpload||e.waitForUpload}}}c.id="EQUIRECTANGULAR_SNAPSHOT"},72790:(e,t,n)=>{"use strict";n.d(t,{G:()=>i});var s=n(89103);class i extends s.QB{constructor(e){super(),this.error=e}}},86426:(e,t,n)=>{"use strict";n.d(t,{Ns:()=>r,gp:()=>i,t6:()=>a,tZ:()=>o});var s=n(55141);class i extends s.u{constructor(e,t){super(),this.payload={id:e,name:t}}}i.id="RENAME_SNAPSHOT";class o extends s.u{constructor(e){super(),this.payload={id:e}}}o.id="DELETE_SNAPSHOT";class r extends s.u{constructor(e){super(),this.payload={snapshot:e}}}r.id="UPLOAD_SNAPSHOT";class a extends s.u{constructor(e){super(),this.payload={id:e}}}a.id="SET_CURRENT_SNAPSHOT_PHOTO"},2812:(e,t,n)=>{"use strict";n.d(t,{O:()=>a});var s=n(84710),i=n(45205),o=n(2803),r=n(97696);class a extends s.B{constructor(e){super(),this.name="snapshots",this.snapshots={};for(const t in e)this.snapshots[t]=e[t].clone()}get(e){return this.snapshots[e]}async getImageUrl(e){const t=this.get(e),n=new URL(await t.imageUrl.get());return"panorama"===t.category&&(n.searchParams.delete("height"),n.searchParams.delete("fit")),n.toString()}get collection(){return this.snapshots}get snapshotsCount(){return this.snapshots?Object.keys(this.snapshots).length:0}getSortedCollection(e){if(!this.snapshotsCount)return[];let t=Object.values(this.snapshots);return(null==e?void 0:e.filterFn)&&(t=t.filter(e.filterFn)),t.sort((null==e?void 0:e.compareFn)||r.PN)}setSelectedPhoto(e){this.selectedPhotoId=e,this.commit()}add(e){e.sid=this.validateSid(e.sid),this.snapshots[e.sid]=e,this.updateOnStaleCallbacks(),this.commit()}remove(e){delete this.snapshots[e]}validateSid(e){for(;!e||this.snapshots[e];)e=(0,i.D)(11);return e}set onStale(e){this.hydrate=e,this.updateOnStaleCallbacks()}updateOnStaleCallbacks(){this.hydrate&&(0,o._)(this.snapshots,(async()=>{const e=await this.hydrate();for(const t in this.snapshots)e&&e[t]&&this.snapshots[t].refresh(e[t])}))}}},20172:(e,t,n)=>{"use strict";n.d(t,{Bb:()=>o,LW:()=>i,iM:()=>r});var s=n(89103);class i extends s.QB{constructor(e){super(),this.sweepId=e}}class o extends s.QB{constructor(e,t,n){super(),this.sweepId=e,this.orientation=t,this.deltaAngle=n}}class r extends s.QB{constructor(e){super(),this.sweepId=e}}},8175:(e,t,n)=>{"use strict";n.d(t,{im:()=>f,jd:()=>E});var s=n(68909),i=n(85641),o=n.n(i),r=n(81019),a=n.n(r);class c extends s.ShaderMaterial{constructor(e,t){const n={tMask:{value:e},tPinHole:{value:t},pinColor:{value:new s.Color},opacity:{value:1}};super({vertexShader:o(),fragmentShader:a(),uniforms:n,name:"PinMaterial",transparent:!0})}}var l=n(32024),d=n(3249),u=n(37458),h=n(38069),p=n(95102);const m=n.p+"images/360_placement_pin_mask.png";class f extends s.Mesh{}let g;const v=()=>g||(g=(0,l.y)(m),g);class E extends p.m{constructor(e,t,n,s){const i=new c(v(),t);super(E.geometry,i),this.layers.mask=s.mask,this.name="PinMesh",this.cameraData=n,this._collider=new f(E.colliderGeometry,E.colliderMaterial),this._collider.name="PinMeshCollider",this._collider.material.visible=!1,this.add(this._collider),this.opacityProgress=0,this.shouldHide=!0,this.uniforms=i.uniforms,this.unhover(),this.selected=0,this.visible=!1,this.position.copy(e),this.renderOrder=u.X.pins360}updatePosition(e){this.position.copy(e)}get collider(){return this._collider}render(e){this.quaternion.copy(this.cameraData.pose.rotation),null===this.uniforms.tPinHole.value?this.opacityProgress=0:!this.shouldHide&&this.opacityProgress<1?this.opacityProgress+=e/E.FADE_DURATION:this.shouldHide&&this.opacityProgress>0&&(this.opacityProgress-=e/E.FADE_DURATION),this.opacityProgress=(0,d.qE)(this.opacityProgress,0,1),this.uniforms.opacity.value=this.opacityProgress,this.visible=0!==this.opacityProgress}activate(){this.shouldHide=!1}deactivate(){this.shouldHide=!0}isActive(){return!this.shouldHide}dispose(){this.collider.geometry.dispose(),this.collider.material.dispose()}setPinHover(e,t=!0,n=!0){const s=Math.min(Math.max(e,0),1);this.selected!==s&&(n&&this.uniforms.pinColor.value.copy(h.V.WHITE).lerp(h.V.MP_BRAND,s),t&&s>0&&s<=1&&(this.material.depthTest=!1),0===s&&(this.material.depthTest=!0),this.selected=s)}unhover(){this.uniforms.pinColor.value.copy(h.V.WHITE)}}E.FADE_DURATION=500,E.geometry=new s.PlaneGeometry(1.5,1.5),E.colliderGeometry=new s.SphereGeometry(1.5*.65),E.colliderMaterial=new s.MeshBasicMaterial({transparent:!0,opacity:.5,depthWrite:!1,color:16724312})},85357:(e,t,n)=>{"use strict";var s;n.d(t,{j:()=>s}),function(e){e.CLOSED="closed",e.IDLE="idle",e.PRESSING="pressing",e.PLACING="placing",e.MOVING="moving",e.ROTATING="rotating",e.ROTATED="rotated"}(s||(s={}))},11525:(e,t,n)=>{"use strict";n.d(t,{N:()=>i,k:()=>o});var s=n(89103);class i extends s.QB{constructor(e,t){super(),this.sweepId=e,this.selected=t}}class o extends s.QB{constructor(e,t,n){super(),this.sweepId=e,this.pinIndex=t,this.placed=n}}},16716:(e,t,n)=>{"use strict";n.d(t,{l:()=>l});var s=n(32024);const i=n.p+"images/exterior.png",o=n.p+"images/exterior_hover.png",r=n.p+"images/interior.png",a=n.p+"images/interior_hover.png";let c;const l={get:()=>c||(c={toExteriorTexture:(0,s.y)(i),toExteriorHoverTexture:(0,s.y)(o),toInteriorTexture:(0,s.y)(r),toInteriorHoverTexture:(0,s.y)(a)},c)}},70836:(e,t,n)=>{"use strict";n.d(t,{y:()=>i});var s=n(38069);const i=[{outerRadius:1,innerRadius:.97,color:s.V.BLACK.clone(),opacity:.1},{outerRadius:.97,innerRadius:.65,color:s.V.WHITE.clone(),opacity:.64},{outerRadius:.65,innerRadius:.62,color:s.V.BLACK.clone(),opacity:.13}]},58691:(e,t,n)=>{"use strict";n.d(t,{B:()=>p});var s=n(74848),i=n(96540),o=n(32485),r=n.n(o),a=n(60728),c=n(94547),l=n(73566),d=n(17084),u=n(90087),h=n(38731);const p=({keywords:e,className:t,maxVisible:n=2,theme:o})=>{const p=(0,u.L)(),m=(0,h.B)(),f=(0,i.useCallback)((({text:e},t)=>{t.stopPropagation();const n=m?l.S0.LAYERS:l.S0.SEARCH;p.issueCommand(new d.yU(n,!0)),p.issueCommand(new c.Pb([e]))}),[p,m]);return(0,s.jsx)(a.c,{className:r()("tag-keywords",t),tokens:e.map((e=>({id:e,text:e}))),onTokenClick:f,maxVisibleTruncated:n,tokenSize:"small",tokenTheme:o})}},7293:(e,t,n)=>{"use strict";n.d(t,{P:()=>p});var s=n(74848),i=n(96540),o=n(32485),r=n.n(o),a=n(35404),c=n(42242),l=n(99104),d=n(97768),u=n(90087),h=n(5262);const p=({attachments:e,onClick:t})=>{const n=(0,u.L)(),o=(0,d.w)(),p=(0,h.i)(a.qu,!1);(0,i.useEffect)((()=>{var t;(null===(t=e[0])||void 0===t?void 0:t.parentId)!==o&&n.issueCommand(new l.kd)}),[e,o,n]);const m=(0,i.useCallback)(((n,s)=>{0!==e.length&&(n.stopPropagation(),t(n,s))}),[e,t]),f=(0,i.useCallback)((t=>{1===e.length&&n.issueCommand(new l.kd(t))}),[e.length,n]);return p||0===e.length?null:(0,s.jsx)("div",{className:r()("tag-media",{"embed-error":!!o}),children:(0,s.jsx)(c.g,{attachments:e,onClick:m,onError:f})})}},73554:(e,t,n)=>{"use strict";n.d(t,{l:()=>l});var s=n(99104),i=n(55494),o=n(56147),r=n(32408),a=n(95439);const{TAGS:c}=o.A.SHOWCASE;class l{constructor(e,t){this.engine=e,this.settings=t}async activate(){await this.engine.commandBinder.issueCommand(new s.NR(!0))}async deactivate(){await this.engine.commandBinder.issueCommand(new s.NR(!1))}async deepLink(e){const t=(await this.engine.market.waitForData(i.r)).getTagView(e);if(t)(0,r.zX)(this.settings,t,(t=>{this.engine.commandBinder.issueCommand(new s.Ki(e,{transition:t,dock:!0}))}));else{const e={messagePhraseKey:c.MISSING_MESSAGE,timeout:4e3,dismissesOnAction:!0};this.engine.commandBinder.issueCommand(new a.Q(e))}}}},84752:(e,t,n)=>{"use strict";n.d(t,{T:()=>v});var s=n(74848),i=n(96540),o=n(13893),r=n(95541),a=n(47613),c=n(99104),l=n(50897),d=n(47271),u=n(12460),h=n(70401),p=n(8517),m=n(38731),f=n(90087),g=n(68375);function v(e){const{overlay:t,analyticAction:n}=e,v=(0,m.B)(),E=(0,g.s)(),x=(0,f.L)(),y=(0,r.H)(),T=(0,l.f)(!0),b=(0,d.D)(),C=(0,a._)(),A=(0,u.G)(),[S,_]=(0,i.useState)(!1),O=v||!C?T:T.filter((e=>C.layerToggled(e.layerId)&&(!A||A.getCapabilities(e.id).focus)));if(!(b&&O.length>1))return null;const N=O.findIndex((e=>e.id===(null==b?void 0:b.id)));if(-1===N)return null;const k=(0,s.jsx)(h.r,{index:N,total:O.length,disabled:S,overlay:t,wrapAround:!0,onNavigate:e=>{const t=O[e];if(!t)return;_(!0);const s=b?y?o.fl.Instant:o.fl.FadeToBlack:o.fl.Interpolate;E.trackToolGuiEvent("tags",n),x.issueCommand(new c.Ki(t.id,{transition:s})).then((()=>{_(!1)}))}});return t?(0,s.jsx)(p.L,{className:"tags-navigation-overlay",children:k}):k}},21317:(e,t,n)=>{"use strict";n.d(t,{W:()=>l});var s=n(74848),i=n(68419),o=n(48411),r=n(84752),a=(n(99370),n(13767)),c=n(5262);function l(){const e=(0,i.t)(),t=(0,o.T)(),n=(0,c.i)(a.rp,"1");return e||t||!n?null:(0,s.jsx)("div",{className:"overlay grid-overlay tags-overlay",children:(0,s.jsx)(r.T,{overlay:!0,analyticAction:"tags_navigate_in_canvas"})})}},97768:(e,t,n)=>{"use strict";n.d(t,{w:()=>o});var s=n(87805),i=n(55494);const o=(0,s.u)(i.r,"embedErrorTagId",void 0)},47271:(e,t,n)=>{"use strict";n.d(t,{D:()=>o});var s=n(96540),i=n(12460);function o(){const e=(0,i.G)(),[t,n]=(0,s.useState)(e?e.openTagView:null);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onOpenTagViewChanged(n);return n(e.openTagView),()=>t.cancel()}),[e]),t}},50897:(e,t,n)=>{"use strict";n.d(t,{f:()=>o});var s=n(96540),i=n(12460);function o(e){const t=(0,i.G)(),[n,o]=(0,s.useState)((null==t?void 0:t.getOrderedTags(e))||[]);return(0,s.useEffect)((()=>{if(!t)return()=>{};function n(){t&&o(t.getOrderedTags(e))}const s=t.getOrderedTagViewMapFilter().onChanged(n);return n(),()=>s.cancel()}),[t,e]),n}},83649:(e,t,n)=>{"use strict";n.d(t,{J:()=>r});var s=n(96540),i=n(12460);function o(e){return e?e.getLinkHandler():null}function r(){const e=(0,i.G)(),[t,n]=(0,s.useState)(o(e));return(0,s.useEffect)((()=>(t||n(o(e)),()=>{})),[t,e]),t}},12460:(e,t,n)=>{"use strict";n.d(t,{G:()=>o});var s=n(98236),i=n(55494);const o=(0,s.v)(i.r)},75200:(e,t,n)=>{"use strict";n.d(t,{c:()=>o});var s=n(87805),i=n(96319);const o=(0,s.u)(i.M,"previousToolName",null)},58062:(e,t,n)=>{"use strict";n.d(t,{k:()=>o});var s=n(87805),i=n(96319);const o=(0,s.u)(i.M,"softOpening",!1)},42329:(e,t,n)=>{"use strict";n.d(t,{jl:()=>r,ly:()=>i,qO:()=>o});var s=n(55141);class i extends s.u{constructor(e){super(),this.payload={search:e}}}i.id="USERS_SEARCH";class o extends s.u{constructor(e){super(),this.payload={userMentions:e}}}o.id="USERS_MENTIONS_FETCH";class r extends s.u{constructor(e,t,n,s){super(),this.payload={emails:e,message:t,modelAccess:n,noteId:s}}}r.id="USERS_INVITE"},54616:(e,t,n)=>{"use strict";n.d(t,{P:()=>o});var s=n(77570),i=n(96540);const o=()=>(0,i.useContext)(s.B).userData},304:(e,t,n)=>{"use strict";n.d(t,{_:()=>o,x:()=>i});var s=n(55141);class i extends s.u{constructor(){super()}}i.id="LOCK_VIEWMODE";class o extends s.u{constructor(){super()}}o.id="UNLOCK_VIEWMODE"},73586:(e,t,n)=>{"use strict";n.d(t,{i:()=>o});var s=n(76185),i=n(31093);class o{constructor(e){this.waitingGets=new Map,this.comparer=e||this.defaultComparer,this.poolArray=[]}add(e,t=!0){const n=this.createObjectDescriptor(e);return n.object=e,n.inUse=t,this.addObjectDescriptorToPool(n),n}get(e){for(const t of this.poolArray)if(!t.inUse&&this.comparer(t,e))return t.inUse=!0,t;return null}async tryGetAndWait(e){const t=this.get(e);if(t)return Promise.resolve(t);{const t=e||"no-criteria";this.waitingGets.has(t)||this.waitingGets.set(t,[]);const n=this.waitingGets.get(t);(0,s.$)(n);const o=new i.i;return n.push(o),o.nativePromise()}}free(e){for(const t of this.poolArray)if(t.object===e){const e=this.isWaitingForObject(t);return e?e.resolve(t):t.inUse=!1,!0}return!1}isWaitingForObject(e){if(this.waitingGets.size>0)for(const[t,n]of this.waitingGets.entries())if(n.length>0){if("no-criteria"===t||this.comparer(e,t)){const e=n.shift();if(e)return e}}return null}all(){return this.poolArray}defaultComparer(e,t){return!0}createObjectDescriptor(e){return{object:e,inUse:!1}}addObjectDescriptorToPool(e){this.poolArray.push(e)}}},81019:e=>{e.exports="precision highp float;precision highp int;varying vec2 vUv;uniform sampler2D tMask;uniform sampler2D tPinHole;uniform vec3 pinColor;uniform float opacity;void main(){vec4 maskColor=texture2D(tMask,vUv);vec4 pinHoleColor=vec4(texture2D(tPinHole,vec2(vUv.x,vUv.y-0.11)).xyz,1.);float redness=maskColor.r-maskColor.b;vec4 mixedPinColor=mix(vec4(pinColor,1.),pinHoleColor,redness);mixedPinColor.a=min(mixedPinColor.a,maskColor.a)*opacity;if(mixedPinColor.a==0.)discard;gl_FragColor=linearToOutputTexel(mixedPinColor);}"},85641:e=>{e.exports="precision highp float;precision highp int;varying vec2 vUv;void main(){vUv=uv;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);}"}}]);